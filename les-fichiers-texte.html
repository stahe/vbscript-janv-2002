
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Introduction au langage VBScript">
      
      
        <meta name="author" content="Serge Tahé">
      
      
        <link rel="canonical" href="https://stahe.github.io/vbscript-janv-2002/les-fichiers-texte.html">
      
      
        <link rel="prev" href="les-fonctions-et-procedures.html">
      
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>6. Les fichiers texte - Introduction au langage VBScript</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/focus.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#6-les-fichiers-texte" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Introduction au langage VBScript" class="md-header__button md-logo" aria-label="Introduction au langage VBScript" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction au langage VBScript
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              6. Les fichiers texte
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/stahe/vbscript-janv-2002" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Introduction au langage VBScript" class="md-nav__button md-logo" aria-label="Introduction au langage VBScript" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Introduction au langage VBScript
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stahe/vbscript-janv-2002" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-contextes-dexecution-de-vbscript.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Les contextes d'exécution de VBSCRIPT
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-bases-de-la-programmation-vbscript.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Les bases de la programmation VBSCRIPT
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="la-gestion-des-erreurs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. La gestion des erreurs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fonctions-et-procedures.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Les fonctions et procédures
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    6. Les fichiers texte
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="les-fichiers-texte.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Les fichiers texte
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#61-creation-et-utilisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1. Création et utilisation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-les-cas-derreur" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2. Les cas d'erreur
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-lapplication-impots-avec-un-fichier-texte" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.3. L'application IMPOTS avec un fichier texte
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="6-les-fichiers-texte">6. Les fichiers texte</h1>
<p>Un fichier texte est un fichier contenant des lignes de texte. Examinons la création et l'utilisation de tels fichiers sur des exemples.</p>
<h2 id="61-creation-et-utilisation">6.1. Création et utilisation</h2>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000002060000017953659E14.png" style="display:inline-block; margin:4px;width:13.705cm;height:9.975cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>C:\&gt;cscript fic1.vbs
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>C:\&gt;dir
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a> FIC1     VBS           352  07/01/02   7:07 fic1.vbs
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>TESTFILE TXT            25  07/01/02   7:07 testfile.txt
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>C:\&gt;more testfile.txt
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>Ceci est un autre test.
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Commentaires</p>
<ul>
<li>la ligne 7 crée un objet fichier de type "Scripting.FileSystemObject" par la fonction CreateObject("Scripting.FileSystemObject"). Un tel objet permet l'accès à tout fichier du système pas simplement à des fichiers texte.</li>
<li>la ligne 9 crée un objet "TextStream". La création de cet objet est associée à la création du fichier testfile.txt. Ce fichier n'est pas désigné par un nom absolu du genre c:\dir1\dir2\....\testfile.txt mais par un nom relatif testfile.txt. Il sera alors créé dans le répertoire d'où sera lancée la commande d'exécution du fichier.</li>
<li>le système de fichiers du système windows n'a pas connaissance de concepts tels que fichier texte ou fichier non texte. Il ne connaît que des fichiers. C'est donc au programme qui exploite ce fichier de savoir s'il va le traiter comme un fichier texte ou non.</li>
<li>La ligne 9 crée un objet d'où la commande set utilisée pour l'affectation. La création d'un objet fichier texte passe par la création de 2 objets :</li>
<li>la création d'un objet Scripting.FileSystemObject (ligne 7)</li>
<li>puis par la création d'un objet "TextStream" (fichier texte) par la méthode OpenTextFile de l'objet Scripting.FileSystemObject qui admet plusieurs paramètres :</li>
<li>le nom du fichier à gérer (obligatoire)</li>
<li>le mode d'utilisation du fichier. C'est un entier avec 3 valeurs possibles :</li>
<li>1 : utilisation du fichier en lecture</li>
<li>2 : utilisation du fichier en écriture. S'il n'existe pas déjà et si le 3ième paramètre est présent et a la valeur true, il est créé sinon il n'est pas. S'il existe déjà, il est écrasé.</li>
<li>8 : utilisation du fichier en ajout, c.a.d. écriture en fin de fichier. Si le fichier n'existe pas déjà et si le 3ième paramètre est présent et a la valeur true, il est créé sinon il n'est pas.</li>
<li>la ligne 11 écrit une ligne de texte avec la méthode WriteLine de l'objet TextStream créé.</li>
<li>la ligne 13 "ferme" le fichier. On ne peut alors plus écrire ou lire dedans.</li>
<li>la ligne 16 crée un nouvel objet "TextStream" pour exploiter le même fichier que précédemment mais cette fois-ci en mode "ajout". Les lignes qui seront écrites le seront derrière les lignes existantes.</li>
<li>la ligne 18 écrit deux nouvelles lignes sachant que la constante vbCRLF est la marque de fin de ligne des fichiers texte.</li>
<li>la ligne 20 ferme de nouveau le fichier</li>
<li>la ligne 23 le rouvre en mode "lecture" : on va lire le contenu du fichier. </li>
<li>La ligne 27 lit une ligne de texte avec la méthode ReadLine de l'objet TextStream. Lorsque le fichier vient d'être "ouvert", on est positionné sur la 1ère ligne de texte de celui-ci. Lorsque celle-ci a été lue par la méthode ReadLine, on est positionné sur la seconde ligne. Ainsi la méthode Readline non seulement lit la ligne courante mais "avance" ensuite automatiquement à la ligne suivante.</li>
<li>Pour ligne toutes les lignes de texte, la méthode ReadLine doit être appliquée de façon répétée dans une boucle. Celle-ci (ligne 26) se termine lorsque l'attribut AtEndOfStream de l'objet TextStream a la valeur true. Cela signifie alors qu'il n'y a plus de lignes à lire dans le fichier.</li>
</ul>
<h2 id="62-les-cas-derreur">6.2. Les cas d'erreur</h2>
<p>On rencontre deux cas d'erreur fréquents :</p>
<ul>
<li>ouverture en lecture d'un fichier qui n'existe pas</li>
<li>ouverture en écriture ou ajout d'un fichier qui n'existe pas avec comme le troisième paramètre à false dans l'appel à la méthode OpenTextFile.</li>
</ul>
<p>Le programme suivant montre comment détecter ces erreurs :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span>
<span class="normal"><a href="#__codelineno-1-44">44</a></span>
<span class="normal"><a href="#__codelineno-1-45">45</a></span>
<span class="normal"><a href="#__codelineno-1-46">46</a></span>
<span class="normal"><a href="#__codelineno-1-47">47</a></span>
<span class="normal"><a href="#__codelineno-1-48">48</a></span>
<span class="normal"><a href="#__codelineno-1-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">&#39; création &amp; remplissage d&#39;un fichier texte</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="k">Option</span><span class="w"> </span><span class="k">Explicit</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">objFichier</span><span class="p">,</span><span class="nv">MyFile</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="kd">Const</span><span class="w"> </span><span class="no">ForReading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ForWriting</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ForAppending</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">codeErreur</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="c1">&#39; on crée un objet fichier</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="k">Set</span><span class="w"> </span><span class="n">objFichier</span><span class="o">=</span><span class="nb">CreateObject</span><span class="p">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="c1">&#39; on ouvre un fichier texte devant exister en lecture</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">Resume</span><span class="w"> </span><span class="k">Next</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="k">Set</span><span class="w"> </span><span class="n">MyFile</span><span class="o">=</span><span class="w"> </span><span class="n">objFichier</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ForReading</span><span class="p">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="n">codeErreur</span><span class="o">=</span><span class="nb">err</span><span class="p">.</span><span class="n">number</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">GoTo</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="k">If</span><span class="w"> </span><span class="n">codeErreur</span><span class="o">&lt;&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span><span class="w">  </span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="w">  </span><span class="c1">&#39; le fichier n&#39;existe pas</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="w">  </span><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;Le fichier [abcd] n&#39;existe pas&quot;</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><span class="k">Else</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="w">  </span><span class="c1">&#39; on ferme le fichier texte  </span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="w">  </span><span class="n">MyFile</span><span class="p">.</span><span class="n">Close</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="c1">&#39; on ouvre un fichier texte devant exister en écriture</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">Resume</span><span class="w"> </span><span class="k">Next</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><span class="k">Set</span><span class="w"> </span><span class="n">MyFile</span><span class="o">=</span><span class="w"> </span><span class="n">objFichier</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ForWriting</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">)</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a><span class="n">codeErreur</span><span class="o">=</span><span class="nb">err</span><span class="p">.</span><span class="n">number</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">GoTo</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a><span class="k">If</span><span class="w"> </span><span class="n">codeErreur</span><span class="o">&lt;&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span><span class="w">  </span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="w">  </span><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;Le fichier [abcd] n&#39;existe pas&quot;</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><span class="k">Else</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a><span class="w">  </span><span class="c1">&#39; on ferme le fichier texte</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="w">  </span><span class="n">MyFile</span><span class="p">.</span><span class="n">Close</span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a><span class="c1">&#39; on ouvre un fichier texte devant exister en ajout</span>
<a id="__codelineno-1-37" name="__codelineno-1-37"></a><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">Resume</span><span class="w"> </span><span class="k">Next</span>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a><span class="k">Set</span><span class="w"> </span><span class="n">MyFile</span><span class="o">=</span><span class="w"> </span><span class="n">objFichier</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ForAppending</span><span class="p">,</span><span class="w"> </span><span class="no">False</span><span class="p">)</span>
<a id="__codelineno-1-39" name="__codelineno-1-39"></a><span class="n">codeErreur</span><span class="o">=</span><span class="nb">err</span><span class="p">.</span><span class="n">number</span>
<a id="__codelineno-1-40" name="__codelineno-1-40"></a><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">GoTo</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-1-41" name="__codelineno-1-41"></a><span class="k">If</span><span class="w"> </span><span class="n">codeErreur</span><span class="o">&lt;&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span><span class="w">  </span>
<a id="__codelineno-1-42" name="__codelineno-1-42"></a><span class="w">  </span><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;Le fichier [abcd] n&#39;existe pas&quot;</span>
<a id="__codelineno-1-43" name="__codelineno-1-43"></a><span class="k">Else</span>
<a id="__codelineno-1-44" name="__codelineno-1-44"></a><span class="w">  </span><span class="c1">&#39; on ferme le fichier texte</span>
<a id="__codelineno-1-45" name="__codelineno-1-45"></a><span class="w">  </span><span class="n">MyFile</span><span class="p">.</span><span class="n">Close</span>
<a id="__codelineno-1-46" name="__codelineno-1-46"></a><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-1-47" name="__codelineno-1-47"></a>
<a id="__codelineno-1-48" name="__codelineno-1-48"></a><span class="c1">&#39; fin</span>
<a id="__codelineno-1-49" name="__codelineno-1-49"></a><span class="n">wscript</span><span class="p">.</span><span class="n">quit</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div></td></tr></table></div>
</div></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>C:\&gt;dir
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>FIC1     VBS           964  07/01/02   7:54 fic1.vbs
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>TESTFILE TXT             0  07/01/02   8:18 testfile.txt
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>FIC2     VBS         1 252  07/01/02   8:23 fic2.vbs
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>         3 fichier(s)              2 216 octets
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>         2 répertoire(s)        4 007.11 Mo libre
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>C:\&gt;cscript fic2.vbs
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>Le fichier [abcd] n&#39;existe pas
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>Le fichier [abcd] n&#39;existe pas
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>Le fichier [abcd] n&#39;existe pas
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="63-lapplication-impots-avec-un-fichier-texte">6.3. L'application IMPOTS avec un fichier texte</h2>
<p>Nous reprenons l'application de calcul de l'impôt en supposant que les données nécessaires au calcul de l'impôt sont dans un fichier texte appelé data.txt :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>12620 13190 15640 24740 31810 39970 48360 55790 92970 127860 151250 172040 195000 0
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>0 0,05 0,1 0,15 0,2 0,25 0,3 0,35 0,4 0,45 0,5 0,55 0,6 0,65
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>0 631 1290,5 2072,5 3309,5 4900 6898,5 9316,5 12106 16754,5 23147,5 30710 39312 49062
</code></pre></div></td></tr></table></div>
<p>Les trois lignes contiennent respectivement les données des tableaux limites, coeffR et coeffN de l'application. Grâce à la modularisation de notre application, les modifications interviennent essentiellement dans la procédure <strong>getData</strong> chargée de construire les trois tableaux. Le nouveau programme est le suivant :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">  1</a></span>
<span class="normal"><a href="#__codelineno-4-2">  2</a></span>
<span class="normal"><a href="#__codelineno-4-3">  3</a></span>
<span class="normal"><a href="#__codelineno-4-4">  4</a></span>
<span class="normal"><a href="#__codelineno-4-5">  5</a></span>
<span class="normal"><a href="#__codelineno-4-6">  6</a></span>
<span class="normal"><a href="#__codelineno-4-7">  7</a></span>
<span class="normal"><a href="#__codelineno-4-8">  8</a></span>
<span class="normal"><a href="#__codelineno-4-9">  9</a></span>
<span class="normal"><a href="#__codelineno-4-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-4-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-4-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-4-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-4-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-4-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-4-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-4-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-4-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-4-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-4-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-4-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-4-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-4-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-4-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-4-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-4-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-4-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-4-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-4-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-4-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-4-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-4-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-4-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-4-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-4-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-4-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-4-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-4-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-4-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-4-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-4-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-4-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-4-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-4-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-4-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-4-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-4-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-4-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-4-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-4-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-4-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-4-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-4-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-4-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-4-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-4-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-4-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-4-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-4-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-4-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-4-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-4-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-4-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-4-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-4-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-4-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-4-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-4-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-4-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-4-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-4-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-4-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-4-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-4-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-4-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-4-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-4-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-4-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-4-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-4-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-4-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-4-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-4-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-4-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-4-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-4-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-4-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-4-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-4-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-4-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-4-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-4-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-4-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-4-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-4-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-4-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-4-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-4-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-4-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-4-100">100</a></span>
<span class="normal"><a href="#__codelineno-4-101">101</a></span>
<span class="normal"><a href="#__codelineno-4-102">102</a></span>
<span class="normal"><a href="#__codelineno-4-103">103</a></span>
<span class="normal"><a href="#__codelineno-4-104">104</a></span>
<span class="normal"><a href="#__codelineno-4-105">105</a></span>
<span class="normal"><a href="#__codelineno-4-106">106</a></span>
<span class="normal"><a href="#__codelineno-4-107">107</a></span>
<span class="normal"><a href="#__codelineno-4-108">108</a></span>
<span class="normal"><a href="#__codelineno-4-109">109</a></span>
<span class="normal"><a href="#__codelineno-4-110">110</a></span>
<span class="normal"><a href="#__codelineno-4-111">111</a></span>
<span class="normal"><a href="#__codelineno-4-112">112</a></span>
<span class="normal"><a href="#__codelineno-4-113">113</a></span>
<span class="normal"><a href="#__codelineno-4-114">114</a></span>
<span class="normal"><a href="#__codelineno-4-115">115</a></span>
<span class="normal"><a href="#__codelineno-4-116">116</a></span>
<span class="normal"><a href="#__codelineno-4-117">117</a></span>
<span class="normal"><a href="#__codelineno-4-118">118</a></span>
<span class="normal"><a href="#__codelineno-4-119">119</a></span>
<span class="normal"><a href="#__codelineno-4-120">120</a></span>
<span class="normal"><a href="#__codelineno-4-121">121</a></span>
<span class="normal"><a href="#__codelineno-4-122">122</a></span>
<span class="normal"><a href="#__codelineno-4-123">123</a></span>
<span class="normal"><a href="#__codelineno-4-124">124</a></span>
<span class="normal"><a href="#__codelineno-4-125">125</a></span>
<span class="normal"><a href="#__codelineno-4-126">126</a></span>
<span class="normal"><a href="#__codelineno-4-127">127</a></span>
<span class="normal"><a href="#__codelineno-4-128">128</a></span>
<span class="normal"><a href="#__codelineno-4-129">129</a></span>
<span class="normal"><a href="#__codelineno-4-130">130</a></span>
<span class="normal"><a href="#__codelineno-4-131">131</a></span>
<span class="normal"><a href="#__codelineno-4-132">132</a></span>
<span class="normal"><a href="#__codelineno-4-133">133</a></span>
<span class="normal"><a href="#__codelineno-4-134">134</a></span>
<span class="normal"><a href="#__codelineno-4-135">135</a></span>
<span class="normal"><a href="#__codelineno-4-136">136</a></span>
<span class="normal"><a href="#__codelineno-4-137">137</a></span>
<span class="normal"><a href="#__codelineno-4-138">138</a></span>
<span class="normal"><a href="#__codelineno-4-139">139</a></span>
<span class="normal"><a href="#__codelineno-4-140">140</a></span>
<span class="normal"><a href="#__codelineno-4-141">141</a></span>
<span class="normal"><a href="#__codelineno-4-142">142</a></span>
<span class="normal"><a href="#__codelineno-4-143">143</a></span>
<span class="normal"><a href="#__codelineno-4-144">144</a></span>
<span class="normal"><a href="#__codelineno-4-145">145</a></span>
<span class="normal"><a href="#__codelineno-4-146">146</a></span>
<span class="normal"><a href="#__codelineno-4-147">147</a></span>
<span class="normal"><a href="#__codelineno-4-148">148</a></span>
<span class="normal"><a href="#__codelineno-4-149">149</a></span>
<span class="normal"><a href="#__codelineno-4-150">150</a></span>
<span class="normal"><a href="#__codelineno-4-151">151</a></span>
<span class="normal"><a href="#__codelineno-4-152">152</a></span>
<span class="normal"><a href="#__codelineno-4-153">153</a></span>
<span class="normal"><a href="#__codelineno-4-154">154</a></span>
<span class="normal"><a href="#__codelineno-4-155">155</a></span>
<span class="normal"><a href="#__codelineno-4-156">156</a></span>
<span class="normal"><a href="#__codelineno-4-157">157</a></span>
<span class="normal"><a href="#__codelineno-4-158">158</a></span>
<span class="normal"><a href="#__codelineno-4-159">159</a></span>
<span class="normal"><a href="#__codelineno-4-160">160</a></span>
<span class="normal"><a href="#__codelineno-4-161">161</a></span>
<span class="normal"><a href="#__codelineno-4-162">162</a></span>
<span class="normal"><a href="#__codelineno-4-163">163</a></span>
<span class="normal"><a href="#__codelineno-4-164">164</a></span>
<span class="normal"><a href="#__codelineno-4-165">165</a></span>
<span class="normal"><a href="#__codelineno-4-166">166</a></span>
<span class="normal"><a href="#__codelineno-4-167">167</a></span>
<span class="normal"><a href="#__codelineno-4-168">168</a></span>
<span class="normal"><a href="#__codelineno-4-169">169</a></span>
<span class="normal"><a href="#__codelineno-4-170">170</a></span>
<span class="normal"><a href="#__codelineno-4-171">171</a></span>
<span class="normal"><a href="#__codelineno-4-172">172</a></span>
<span class="normal"><a href="#__codelineno-4-173">173</a></span>
<span class="normal"><a href="#__codelineno-4-174">174</a></span>
<span class="normal"><a href="#__codelineno-4-175">175</a></span>
<span class="normal"><a href="#__codelineno-4-176">176</a></span>
<span class="normal"><a href="#__codelineno-4-177">177</a></span>
<span class="normal"><a href="#__codelineno-4-178">178</a></span>
<span class="normal"><a href="#__codelineno-4-179">179</a></span>
<span class="normal"><a href="#__codelineno-4-180">180</a></span>
<span class="normal"><a href="#__codelineno-4-181">181</a></span>
<span class="normal"><a href="#__codelineno-4-182">182</a></span>
<span class="normal"><a href="#__codelineno-4-183">183</a></span>
<span class="normal"><a href="#__codelineno-4-184">184</a></span>
<span class="normal"><a href="#__codelineno-4-185">185</a></span>
<span class="normal"><a href="#__codelineno-4-186">186</a></span>
<span class="normal"><a href="#__codelineno-4-187">187</a></span>
<span class="normal"><a href="#__codelineno-4-188">188</a></span>
<span class="normal"><a href="#__codelineno-4-189">189</a></span>
<span class="normal"><a href="#__codelineno-4-190">190</a></span>
<span class="normal"><a href="#__codelineno-4-191">191</a></span>
<span class="normal"><a href="#__codelineno-4-192">192</a></span>
<span class="normal"><a href="#__codelineno-4-193">193</a></span>
<span class="normal"><a href="#__codelineno-4-194">194</a></span>
<span class="normal"><a href="#__codelineno-4-195">195</a></span>
<span class="normal"><a href="#__codelineno-4-196">196</a></span>
<span class="normal"><a href="#__codelineno-4-197">197</a></span>
<span class="normal"><a href="#__codelineno-4-198">198</a></span>
<span class="normal"><a href="#__codelineno-4-199">199</a></span>
<span class="normal"><a href="#__codelineno-4-200">200</a></span>
<span class="normal"><a href="#__codelineno-4-201">201</a></span>
<span class="normal"><a href="#__codelineno-4-202">202</a></span>
<span class="normal"><a href="#__codelineno-4-203">203</a></span>
<span class="normal"><a href="#__codelineno-4-204">204</a></span>
<span class="normal"><a href="#__codelineno-4-205">205</a></span>
<span class="normal"><a href="#__codelineno-4-206">206</a></span>
<span class="normal"><a href="#__codelineno-4-207">207</a></span>
<span class="normal"><a href="#__codelineno-4-208">208</a></span>
<span class="normal"><a href="#__codelineno-4-209">209</a></span>
<span class="normal"><a href="#__codelineno-4-210">210</a></span>
<span class="normal"><a href="#__codelineno-4-211">211</a></span>
<span class="normal"><a href="#__codelineno-4-212">212</a></span>
<span class="normal"><a href="#__codelineno-4-213">213</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1">&#39; calcul de l&#39;impôt d&#39;un contribuable</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="c1">&#39; le programme doit être appelé avec trois paramètres : marié enfants salaire</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="c1">&#39; marié : caractère O si marié, N si non marié</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c1">&#39; enfants : nombre d&#39;enfants</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="c1">&#39; salaire : salaire annuel sans les centimes</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1">&#39; déclaration obligatoire des variables</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">  </span><span class="k">Option</span><span class="w"> </span><span class="k">Explicit</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">erreur</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="c1">&#39; on récupère les arguments en vérifiant leur validité</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">marie</span><span class="p">,</span><span class="w"> </span><span class="nv">enfants</span><span class="p">,</span><span class="w"> </span><span class="nv">salaire</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">  </span><span class="n">erreur</span><span class="o">=</span><span class="n">getArguments</span><span class="p">(</span><span class="n">marie</span><span class="p">,</span><span class="n">enfants</span><span class="p">,</span><span class="n">salaire</span><span class="p">)</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">  </span><span class="c1">&#39; erreur ?</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">erreur</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">&lt;&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="n">erreur</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">wscript</span><span class="p">.</span><span class="n">quit</span><span class="w"> </span><span class="n">erreur</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="c1">&#39; on récupère les données nécessaires au calcul de l&#39;impôt</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">limites</span><span class="p">,</span><span class="w"> </span><span class="nv">coeffR</span><span class="p">,</span><span class="w"> </span><span class="nv">coeffN</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">  </span><span class="n">erreur</span><span class="o">=</span><span class="n">getData</span><span class="p">(</span><span class="n">limites</span><span class="p">,</span><span class="n">coeffR</span><span class="p">,</span><span class="n">coeffN</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">  </span><span class="c1">&#39; erreur ?</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">erreur</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">&lt;&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="n">erreur</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">wscript</span><span class="p">.</span><span class="n">quit</span><span class="w"> </span><span class="mi">5</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">  </span><span class="c1">&#39; on affiche le résultat</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">  </span><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;impôt=&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">calculerImpot</span><span class="p">(</span><span class="n">marie</span><span class="p">,</span><span class="n">enfants</span><span class="p">,</span><span class="n">salaire</span><span class="p">,</span><span class="n">limites</span><span class="p">,</span><span class="n">coeffR</span><span class="p">,</span><span class="n">coeffN</span><span class="p">)</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="w">  </span><span class="c1">&#39; on quitte sans erreur</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="w">  </span><span class="n">wscript</span><span class="p">.</span><span class="n">quit</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="c1">&#39; ------------ fonctions et procédures</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="c1">&#39; ----------- getArguments</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a><span class="kd">Function</span><span class="w"> </span><span class="nf">getArguments</span><span class="p">(</span><span class="k">byref</span><span class="w"> </span><span class="n">marie</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">enfants</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">salaire</span><span class="p">)</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="w">  </span><span class="c1">&#39; doit récupérer trois valeurs passées comme argument au programme principal</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="w">  </span><span class="c1">&#39; un argument est transmis au programme sans espaces devant et derrière</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="w">  </span><span class="c1">&#39; on utilisera des expression régulières pour vérifier la validité des données</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a><span class="w">  </span><span class="c1">&#39; rend un variant tableau erreur à 2 valeurs</span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a><span class="w">  </span><span class="c1">&#39; erreur(0) : code d&#39;erreur, 0 si pas d&#39;erreur</span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a><span class="w">  </span><span class="c1">&#39; erreur(1) : message d&#39;erreur si erreur sinon la chaîne vide</span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">syntaxe</span>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a><span class="w">  </span><span class="n">syntaxe</span><span class="o">=</span><span class="w"> </span><span class="n">_</span>
<a id="__codelineno-4-43" name="__codelineno-4-43"></a><span class="w">    </span><span class="s2">&quot;Syntaxe : pg marié enfants salaire&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_</span>
<a id="__codelineno-4-44" name="__codelineno-4-44"></a><span class="w">    </span><span class="s2">&quot;marié : caractère O si marié, N si non marié&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_</span>
<a id="__codelineno-4-45" name="__codelineno-4-45"></a><span class="w">    </span><span class="s2">&quot;enfants : nombre d&#39;enfants (entier &gt;=0)&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_</span>
<a id="__codelineno-4-46" name="__codelineno-4-46"></a><span class="w">    </span><span class="s2">&quot;salaire : salaire annuel sans les centimes (entier &gt;=0)&quot;</span>
<a id="__codelineno-4-47" name="__codelineno-4-47"></a>
<a id="__codelineno-4-48" name="__codelineno-4-48"></a><span class="c1">&#39; on vérifie qu&#39;il y a 3 arguments</span>
<a id="__codelineno-4-49" name="__codelineno-4-49"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">nbArguments</span>
<a id="__codelineno-4-50" name="__codelineno-4-50"></a><span class="w">  </span><span class="n">nbArguments</span><span class="o">=</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">.</span><span class="n">count</span>
<a id="__codelineno-4-51" name="__codelineno-4-51"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">nbArguments</span><span class="o">&lt;&gt;</span><span class="mi">3</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-4-52" name="__codelineno-4-52"></a><span class="w">    </span><span class="c1">&#39; msg d&#39;erreur</span>
<a id="__codelineno-4-53" name="__codelineno-4-53"></a><span class="w">    </span><span class="n">getArguments</span><span class="o">=</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">syntaxe</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot;erreur : nombre d&#39;arguments incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-4-54" name="__codelineno-4-54"></a><span class="w">    </span><span class="c1">&#39; fin</span>
<a id="__codelineno-4-55" name="__codelineno-4-55"></a><span class="w">    </span><span class="k">Exit</span><span class="w"> </span><span class="kd">Function</span>
<a id="__codelineno-4-56" name="__codelineno-4-56"></a><span class="w">  </span><span class="nf">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-57" name="__codelineno-4-57"></a>
<a id="__codelineno-4-58" name="__codelineno-4-58"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">modele</span><span class="p">,</span><span class="w"> </span><span class="nv">correspondances</span>
<a id="__codelineno-4-59" name="__codelineno-4-59"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">modele</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="nb">regexp</span>
<a id="__codelineno-4-60" name="__codelineno-4-60"></a>
<a id="__codelineno-4-61" name="__codelineno-4-61"></a><span class="w">  </span><span class="c1">&#39; le statut marital doit être parmi les caractères oOnN</span>
<a id="__codelineno-4-62" name="__codelineno-4-62"></a><span class="w">  </span><span class="n">modele</span><span class="p">.</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;^[oOnN]$&quot;</span>
<a id="__codelineno-4-63" name="__codelineno-4-63"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">correspondances</span><span class="o">=</span><span class="n">modele</span><span class="p">.</span><span class="k">execute</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-4-64" name="__codelineno-4-64"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">correspondances</span><span class="p">.</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-4-65" name="__codelineno-4-65"></a><span class="w">    </span><span class="c1">&#39; msg d&#39;erreur</span>
<a id="__codelineno-4-66" name="__codelineno-4-66"></a><span class="w">    </span><span class="n">getArguments</span><span class="o">=</span><span class="nb">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">syntaxe</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot;erreur : argument marie incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-4-67" name="__codelineno-4-67"></a><span class="w">    </span><span class="c1">&#39; on quitte</span>
<a id="__codelineno-4-68" name="__codelineno-4-68"></a><span class="w">    </span><span class="k">Exit</span><span class="w"> </span><span class="kd">Function</span>
<a id="__codelineno-4-69" name="__codelineno-4-69"></a><span class="w">  </span><span class="nf">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-70" name="__codelineno-4-70"></a><span class="w">  </span><span class="c1">&#39; on récupère la valeur</span>
<a id="__codelineno-4-71" name="__codelineno-4-71"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="nb">lcase</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;o&quot;</span><span class="k">Then</span>
<a id="__codelineno-4-72" name="__codelineno-4-72"></a><span class="w">    </span><span class="n">marie</span><span class="o">=</span><span class="no">true</span>
<a id="__codelineno-4-73" name="__codelineno-4-73"></a><span class="w">  </span><span class="k">Else</span>
<a id="__codelineno-4-74" name="__codelineno-4-74"></a><span class="w">    </span><span class="n">marie</span><span class="o">=</span><span class="no">false</span>
<a id="__codelineno-4-75" name="__codelineno-4-75"></a><span class="w">  </span><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-76" name="__codelineno-4-76"></a>
<a id="__codelineno-4-77" name="__codelineno-4-77"></a><span class="w">  </span><span class="c1">&#39; enfants doit être un nombre entier &gt;=0</span>
<a id="__codelineno-4-78" name="__codelineno-4-78"></a><span class="w">  </span><span class="n">modele</span><span class="p">.</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;^\d{1,2}$&quot;</span>
<a id="__codelineno-4-79" name="__codelineno-4-79"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">correspondances</span><span class="o">=</span><span class="n">modele</span><span class="p">.</span><span class="k">execute</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-4-80" name="__codelineno-4-80"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">correspondances</span><span class="p">.</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-4-81" name="__codelineno-4-81"></a><span class="w">    </span><span class="c1">&#39; erreur</span>
<a id="__codelineno-4-82" name="__codelineno-4-82"></a><span class="w">    </span><span class="n">getArguments</span><span class="o">=</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">syntaxe</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot;erreur : argument enfants incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-4-83" name="__codelineno-4-83"></a><span class="w">    </span><span class="c1">&#39; on quitte</span>
<a id="__codelineno-4-84" name="__codelineno-4-84"></a><span class="w">    </span><span class="k">Exit</span><span class="w"> </span><span class="kd">Function</span>
<a id="__codelineno-4-85" name="__codelineno-4-85"></a><span class="w">  </span><span class="nf">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-86" name="__codelineno-4-86"></a><span class="w">  </span><span class="c1">&#39; on récupère la valeur</span>
<a id="__codelineno-4-87" name="__codelineno-4-87"></a><span class="w">  </span><span class="n">enfants</span><span class="o">=</span><span class="nb">cint</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-4-88" name="__codelineno-4-88"></a>
<a id="__codelineno-4-89" name="__codelineno-4-89"></a><span class="w">  </span><span class="c1">&#39; salaire doit être un entier &gt;=0</span>
<a id="__codelineno-4-90" name="__codelineno-4-90"></a><span class="w">  </span><span class="n">modele</span><span class="p">.</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;^\d{1,9}$&quot;</span>
<a id="__codelineno-4-91" name="__codelineno-4-91"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">correspondances</span><span class="o">=</span><span class="n">modele</span><span class="p">.</span><span class="k">execute</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-4-92" name="__codelineno-4-92"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">correspondances</span><span class="p">.</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-4-93" name="__codelineno-4-93"></a><span class="w">    </span><span class="c1">&#39; erreur</span>
<a id="__codelineno-4-94" name="__codelineno-4-94"></a><span class="w">    </span><span class="n">getArguments</span><span class="o">=</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">syntaxe</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="no">vbCRLF</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot;erreur : argument salaire incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-4-95" name="__codelineno-4-95"></a><span class="w">    </span><span class="c1">&#39; on quitte</span>
<a id="__codelineno-4-96" name="__codelineno-4-96"></a><span class="w">    </span><span class="k">Exit</span><span class="w"> </span><span class="kd">Function</span>
<a id="__codelineno-4-97" name="__codelineno-4-97"></a><span class="w">  </span><span class="nf">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-98" name="__codelineno-4-98"></a><span class="w">  </span><span class="c1">&#39; on récupère la valeur</span>
<a id="__codelineno-4-99" name="__codelineno-4-99"></a><span class="w">  </span><span class="n">salaire</span><span class="o">=</span><span class="nb">clng</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-4-100" name="__codelineno-4-100"></a>
<a id="__codelineno-4-101" name="__codelineno-4-101"></a><span class="w">  </span><span class="c1">&#39; c&#39;est fini sans erreur</span>
<a id="__codelineno-4-102" name="__codelineno-4-102"></a><span class="w">  </span><span class="n">getArguments</span><span class="o">=</span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-4-103" name="__codelineno-4-103"></a><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
<a id="__codelineno-4-104" name="__codelineno-4-104"></a>
<a id="__codelineno-4-105" name="__codelineno-4-105"></a><span class="c1">&#39; ----------- getData</span>
<a id="__codelineno-4-106" name="__codelineno-4-106"></a><span class="kd">Function</span><span class="w"> </span><span class="nf">getData</span><span class="p">(</span><span class="k">byref</span><span class="w"> </span><span class="n">limites</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">coeffR</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">coeffN</span><span class="p">)</span>
<a id="__codelineno-4-107" name="__codelineno-4-107"></a><span class="w">  </span><span class="c1">&#39; les données des trois tableaux limites, coeffR, coeffN sont dans un fichier texte</span>
<a id="__codelineno-4-108" name="__codelineno-4-108"></a><span class="w">  </span><span class="c1">&#39; appelé data.txt. Chaque tableau occupe une ligne sous la forme val1 val2 ... valn</span>
<a id="__codelineno-4-109" name="__codelineno-4-109"></a><span class="w">  </span><span class="c1">&#39; on trouve dans l&#39;ordre limites, coeffR, coeffN</span>
<a id="__codelineno-4-110" name="__codelineno-4-110"></a>
<a id="__codelineno-4-111" name="__codelineno-4-111"></a><span class="w">  </span><span class="c1">&#39; rend un variant erreur tableau à 2 éléments pour gérer l&#39;éventuelle erreur</span>
<a id="__codelineno-4-112" name="__codelineno-4-112"></a><span class="w">  </span><span class="c1">&#39; erreur(0) : 0 si pas d&#39;erreur, un nombre entier &gt;0 sinon</span>
<a id="__codelineno-4-113" name="__codelineno-4-113"></a><span class="w">  </span><span class="c1">&#39; erreur(1) : le message d&#39;erreur si erreur</span>
<a id="__codelineno-4-114" name="__codelineno-4-114"></a>
<a id="__codelineno-4-115" name="__codelineno-4-115"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">objFichier</span><span class="p">,</span><span class="nv">MyFile</span><span class="p">,</span><span class="nv">codeErreur</span>
<a id="__codelineno-4-116" name="__codelineno-4-116"></a><span class="w">  </span><span class="kd">Const</span><span class="w"> </span><span class="no">ForReading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">dataFileName</span><span class="o">=</span><span class="s2">&quot;data.txt&quot;</span>
<a id="__codelineno-4-117" name="__codelineno-4-117"></a>
<a id="__codelineno-4-118" name="__codelineno-4-118"></a><span class="w">  </span><span class="c1">&#39; on crée un objet fichier</span>
<a id="__codelineno-4-119" name="__codelineno-4-119"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">objFichier</span><span class="o">=</span><span class="nb">CreateObject</span><span class="p">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span>
<a id="__codelineno-4-120" name="__codelineno-4-120"></a><span class="w">  </span><span class="c1">&#39; on ouvre le fichier data.txt en lecture</span>
<a id="__codelineno-4-121" name="__codelineno-4-121"></a><span class="w">  </span><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">Resume</span><span class="w"> </span><span class="k">Next</span>
<a id="__codelineno-4-122" name="__codelineno-4-122"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">MyFile</span><span class="o">=</span><span class="w"> </span><span class="n">objFichier</span><span class="p">.</span><span class="n">OpenTextFile</span><span class="p">(</span><span class="n">dataFileName</span><span class="p">,</span><span class="w"> </span><span class="n">ForReading</span><span class="p">)</span>
<a id="__codelineno-4-123" name="__codelineno-4-123"></a><span class="w">  </span><span class="c1">&#39; erreur ?</span>
<a id="__codelineno-4-124" name="__codelineno-4-124"></a><span class="w">  </span><span class="n">codeErreur</span><span class="o">=</span><span class="nb">err</span><span class="p">.</span><span class="n">number</span>
<a id="__codelineno-4-125" name="__codelineno-4-125"></a><span class="w">  </span><span class="k">On</span><span class="w"> </span><span class="k">Error</span><span class="w"> </span><span class="k">GoTo</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-4-126" name="__codelineno-4-126"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">codeErreur</span><span class="o">&lt;&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-4-127" name="__codelineno-4-127"></a><span class="w">    </span><span class="c1">&#39; il y a eu erreur - on la note</span>
<a id="__codelineno-4-128" name="__codelineno-4-128"></a><span class="w">    </span><span class="n">getData</span><span class="o">=</span><span class="nb">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;Impossible d&#39;ouvrir le fichier des données [&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">dataFileName</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">&quot;] en lecture&quot;</span><span class="p">)</span>
<a id="__codelineno-4-129" name="__codelineno-4-129"></a><span class="w">    </span><span class="c1">&#39; on rentre</span>
<a id="__codelineno-4-130" name="__codelineno-4-130"></a><span class="w">    </span><span class="k">Exit</span><span class="w"> </span><span class="kd">Function</span>
<a id="__codelineno-4-131" name="__codelineno-4-131"></a><span class="w">  </span><span class="nf">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-132" name="__codelineno-4-132"></a>
<a id="__codelineno-4-133" name="__codelineno-4-133"></a><span class="w">  </span><span class="c1">&#39; on suppose maintenant que le contenu est correct et on ne fait aucune vérification</span>
<a id="__codelineno-4-134" name="__codelineno-4-134"></a><span class="w">  </span><span class="c1">&#39; on lit les 3 lignes</span>
<a id="__codelineno-4-135" name="__codelineno-4-135"></a>
<a id="__codelineno-4-136" name="__codelineno-4-136"></a><span class="w">  </span><span class="c1">&#39; limites</span>
<a id="__codelineno-4-137" name="__codelineno-4-137"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">ligne</span><span class="p">,</span><span class="w"> </span><span class="nv">i</span>
<a id="__codelineno-4-138" name="__codelineno-4-138"></a><span class="w">  </span><span class="n">ligne</span><span class="o">=</span><span class="n">MyFile</span><span class="p">.</span><span class="n">ReadLine</span>
<a id="__codelineno-4-139" name="__codelineno-4-139"></a><span class="w">  </span><span class="n">getDataFromLine</span><span class="w"> </span><span class="n">ligne</span><span class="p">,</span><span class="n">limites</span>
<a id="__codelineno-4-140" name="__codelineno-4-140"></a>
<a id="__codelineno-4-141" name="__codelineno-4-141"></a><span class="w">  </span><span class="c1">&#39; coeffR</span>
<a id="__codelineno-4-142" name="__codelineno-4-142"></a><span class="w">  </span><span class="n">ligne</span><span class="o">=</span><span class="n">MyFile</span><span class="p">.</span><span class="n">ReadLine</span>
<a id="__codelineno-4-143" name="__codelineno-4-143"></a><span class="w">  </span><span class="n">getDataFromLine</span><span class="w"> </span><span class="n">ligne</span><span class="p">,</span><span class="n">coeffR</span>
<a id="__codelineno-4-144" name="__codelineno-4-144"></a>
<a id="__codelineno-4-145" name="__codelineno-4-145"></a>
<a id="__codelineno-4-146" name="__codelineno-4-146"></a><span class="w">  </span><span class="c1">&#39; coeffN</span>
<a id="__codelineno-4-147" name="__codelineno-4-147"></a><span class="w">  </span><span class="n">ligne</span><span class="o">=</span><span class="n">MyFile</span><span class="p">.</span><span class="n">ReadLine</span>
<a id="__codelineno-4-148" name="__codelineno-4-148"></a><span class="w">  </span><span class="n">coeffN</span><span class="o">=</span><span class="nb">split</span><span class="p">(</span><span class="n">ligne</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-4-149" name="__codelineno-4-149"></a><span class="w">  </span><span class="n">getDataFromLine</span><span class="w"> </span><span class="n">ligne</span><span class="p">,</span><span class="n">coeffN</span>
<a id="__codelineno-4-150" name="__codelineno-4-150"></a>
<a id="__codelineno-4-151" name="__codelineno-4-151"></a><span class="w">  </span><span class="c1">&#39; on ferme le fichier</span>
<a id="__codelineno-4-152" name="__codelineno-4-152"></a><span class="w">  </span><span class="n">MyFile</span><span class="p">.</span><span class="n">close</span>
<a id="__codelineno-4-153" name="__codelineno-4-153"></a>
<a id="__codelineno-4-154" name="__codelineno-4-154"></a><span class="w">  </span><span class="c1">&#39; c&#39;est fini sans erreur</span>
<a id="__codelineno-4-155" name="__codelineno-4-155"></a><span class="w">  </span><span class="n">getData</span><span class="o">=</span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-4-156" name="__codelineno-4-156"></a><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
<a id="__codelineno-4-157" name="__codelineno-4-157"></a>
<a id="__codelineno-4-158" name="__codelineno-4-158"></a><span class="c1">&#39; ----------- getDataFromLine</span>
<a id="__codelineno-4-159" name="__codelineno-4-159"></a><span class="kd">Sub</span><span class="w"> </span><span class="nf">getDataFromLine</span><span class="p">(</span><span class="k">byref</span><span class="w"> </span><span class="n">ligne</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">tableau</span><span class="p">)</span>
<a id="__codelineno-4-160" name="__codelineno-4-160"></a><span class="w">  </span><span class="c1">&#39; met dans tableau les valeurs numériques contenues dans ligne</span>
<a id="__codelineno-4-161" name="__codelineno-4-161"></a><span class="w">  </span><span class="c1">&#39; celles-ci sont séparées par un ou plusieurs espaces</span>
<a id="__codelineno-4-162" name="__codelineno-4-162"></a>
<a id="__codelineno-4-163" name="__codelineno-4-163"></a><span class="w">  </span><span class="c1">&#39; au départ le tableau est vide</span>
<a id="__codelineno-4-164" name="__codelineno-4-164"></a><span class="w">  </span><span class="n">tableau</span><span class="o">=</span><span class="nb">array</span><span class="p">()</span>
<a id="__codelineno-4-165" name="__codelineno-4-165"></a><span class="w">  </span><span class="c1">&#39; on définit un modèle pour la ligne</span>
<a id="__codelineno-4-166" name="__codelineno-4-166"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">modele</span><span class="p">,</span><span class="w"> </span><span class="nv">correspondances</span>
<a id="__codelineno-4-167" name="__codelineno-4-167"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">modele</span><span class="o">=</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="nb">RegExP</span>
<a id="__codelineno-4-168" name="__codelineno-4-168"></a><span class="w">  </span><span class="k">With</span><span class="w"> </span><span class="n">modele</span>
<a id="__codelineno-4-169" name="__codelineno-4-169"></a><span class="w">    </span><span class="p">.</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;\d+,\d+|\d+&quot;</span><span class="w">    </span><span class="c1">&#39; 140,5 ou 140</span>
<a id="__codelineno-4-170" name="__codelineno-4-170"></a><span class="w">    </span><span class="p">.</span><span class="k">global</span><span class="o">=</span><span class="no">true</span><span class="w">              </span><span class="c1">&#39; toutes les valeurs</span>
<a id="__codelineno-4-171" name="__codelineno-4-171"></a><span class="w">  </span><span class="k">End</span><span class="w"> </span><span class="k">With</span>
<a id="__codelineno-4-172" name="__codelineno-4-172"></a>
<a id="__codelineno-4-173" name="__codelineno-4-173"></a><span class="w">  </span><span class="c1">&#39; on analyse la ligne</span>
<a id="__codelineno-4-174" name="__codelineno-4-174"></a><span class="w">  </span><span class="k">Set</span><span class="w"> </span><span class="n">correspondances</span><span class="o">=</span><span class="n">modele</span><span class="p">.</span><span class="k">execute</span><span class="p">(</span><span class="n">ligne</span><span class="p">)</span>
<a id="__codelineno-4-175" name="__codelineno-4-175"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">i</span>
<a id="__codelineno-4-176" name="__codelineno-4-176"></a><span class="w">  </span><span class="k">For</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">correspondances</span><span class="p">.</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-4-177" name="__codelineno-4-177"></a><span class="w">    </span><span class="c1">&#39; on redimensionne le tableau</span>
<a id="__codelineno-4-178" name="__codelineno-4-178"></a><span class="w">    </span><span class="k">ReDim</span><span class="w"> </span><span class="n">Preserve</span><span class="w"> </span><span class="n">tableau</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-4-179" name="__codelineno-4-179"></a><span class="w">    </span><span class="c1">&#39; on affecte une valeur au nouvel élément</span>
<a id="__codelineno-4-180" name="__codelineno-4-180"></a><span class="w">    </span><span class="n">tableau</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">cdbl</span><span class="p">(</span><span class="n">correspondances</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-4-181" name="__codelineno-4-181"></a><span class="w">  </span><span class="k">Next</span>
<a id="__codelineno-4-182" name="__codelineno-4-182"></a>
<a id="__codelineno-4-183" name="__codelineno-4-183"></a><span class="w">  </span><span class="c1">&#39;fin</span>
<a id="__codelineno-4-184" name="__codelineno-4-184"></a><span class="k">End</span><span class="w"> </span><span class="k">Sub</span>
<a id="__codelineno-4-185" name="__codelineno-4-185"></a>
<a id="__codelineno-4-186" name="__codelineno-4-186"></a>
<a id="__codelineno-4-187" name="__codelineno-4-187"></a>
<a id="__codelineno-4-188" name="__codelineno-4-188"></a>
<a id="__codelineno-4-189" name="__codelineno-4-189"></a><span class="c1">&#39; ----------- calculerImpot</span>
<a id="__codelineno-4-190" name="__codelineno-4-190"></a><span class="kd">Function</span><span class="w"> </span><span class="nf">calculerImpot</span><span class="p">(</span><span class="k">byval</span><span class="w"> </span><span class="n">marie</span><span class="p">,</span><span class="k">ByVal</span><span class="w"> </span><span class="n">enfants</span><span class="p">,</span><span class="k">ByVal</span><span class="w"> </span><span class="n">salaire</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">limites</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">coeffR</span><span class="p">,</span><span class="w"> </span><span class="k">ByRef</span><span class="w"> </span><span class="n">coeffN</span><span class="p">)</span>
<a id="__codelineno-4-191" name="__codelineno-4-191"></a>
<a id="__codelineno-4-192" name="__codelineno-4-192"></a><span class="w">  </span><span class="c1">&#39; on calcule le nombre de parts</span>
<a id="__codelineno-4-193" name="__codelineno-4-193"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">nbParts</span>
<a id="__codelineno-4-194" name="__codelineno-4-194"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">marie</span><span class="o">=</span><span class="no">true</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-4-195" name="__codelineno-4-195"></a><span class="w">    </span><span class="n">nbParts</span><span class="o">=</span><span class="p">(</span><span class="n">enfants</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>
<a id="__codelineno-4-196" name="__codelineno-4-196"></a><span class="w">  </span><span class="k">Else</span>
<a id="__codelineno-4-197" name="__codelineno-4-197"></a><span class="w">    </span><span class="n">nbParts</span><span class="o">=</span><span class="p">(</span><span class="n">enfants</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-4-198" name="__codelineno-4-198"></a><span class="w">  </span><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-4-199" name="__codelineno-4-199"></a><span class="w">  </span><span class="k">If</span><span class="w"> </span><span class="n">enfants</span><span class="o">&gt;=</span><span class="mi">3</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span><span class="n">nbParts</span><span class="o">=</span><span class="n">nbParts</span><span class="o">+</span><span class="mf">0.5</span>
<a id="__codelineno-4-200" name="__codelineno-4-200"></a>
<a id="__codelineno-4-201" name="__codelineno-4-201"></a><span class="w">  </span><span class="c1">&#39; on calcule le quotient familial et le revenu imposable</span>
<a id="__codelineno-4-202" name="__codelineno-4-202"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">revenu</span><span class="p">,</span><span class="w"> </span><span class="nv">qf</span>
<a id="__codelineno-4-203" name="__codelineno-4-203"></a><span class="w">  </span><span class="n">revenu</span><span class="o">=</span><span class="mf">0.72</span><span class="o">*</span><span class="n">salaire</span>
<a id="__codelineno-4-204" name="__codelineno-4-204"></a><span class="w">  </span><span class="n">qf</span><span class="o">=</span><span class="n">revenu</span><span class="o">/</span><span class="n">nbParts</span>
<a id="__codelineno-4-205" name="__codelineno-4-205"></a>
<a id="__codelineno-4-206" name="__codelineno-4-206"></a><span class="w">  </span><span class="c1">&#39; on calcule l&#39;impôt</span>
<a id="__codelineno-4-207" name="__codelineno-4-207"></a><span class="w">  </span><span class="kd">Dim</span><span class="w"> </span><span class="nv">i</span><span class="p">,</span><span class="w"> </span><span class="nv">impot</span>
<a id="__codelineno-4-208" name="__codelineno-4-208"></a><span class="w">  </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-4-209" name="__codelineno-4-209"></a><span class="w">  </span><span class="k">Do</span><span class="w"> </span><span class="k">While</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="nb">ubound</span><span class="p">(</span><span class="n">limites</span><span class="p">)</span><span class="w"> </span><span class="ow">And</span><span class="w"> </span><span class="n">qf</span><span class="o">&gt;</span><span class="n">limites</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-4-210" name="__codelineno-4-210"></a><span class="w">    </span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-4-211" name="__codelineno-4-211"></a><span class="w">  </span><span class="k">Loop</span>
<a id="__codelineno-4-212" name="__codelineno-4-212"></a><span class="w">  </span><span class="n">calculerImpot</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">revenu</span><span class="o">*</span><span class="n">coeffr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">nbParts</span><span class="o">*</span><span class="n">coeffn</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-4-213" name="__codelineno-4-213"></a><span class="k">End</span><span class="w"> </span><span class="k">Function</span>
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Commentaires :</p>
<ul>
<li>dans le fichier texte <strong>data.txt</strong>, les valeurs peuvent être séparées par un ou plusieurs espaces, d'où l'impossibilité d'utiliser la fonction split pour récupérer les valeurs de la ligne. Il a fallu passer par une expression régulière</li>
<li>la fonction <strong>getData</strong> rend, outre les trois tableaux limites, coeffR, coeffN, un résultat indiquant s'il y a eu erreur ou non. Ce résultat est un variant tableau de eux éléments. Le premier élément est un code d'erreur (0 si pas d'erreur), le second le message d'erreur s'il y a eu erreur.</li>
<li>la fonction getData ne teste pas la validité des valeurs trouvées dans le fichier data.txt. En situation réelle, elle devrait le faire.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner">

      <div>
        <a href="https://tahe.developpez.com" target="_blank">
          https://tahe.developpez.com
        </a>
        <br>
        Ce cours tutoriel écrit par <strong>Serge Tahé</strong> est mis à disposition du public selon les termes de la
        <em>Licence Creative Commons Attribution – Pas d’Utilisation Commerciale –
        Partage dans les Mêmes Conditions 3.0 non transposé</em>.
      </div>

    </div>
  </div>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["navigation.sections", "navigation.indexes", "navigation.expand", "toc.integrate", "navigation.top"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="javascripts/focus.js"></script>
      
    
  </body>
</html>