
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Introduction au langage VBScript">
      
      
        <meta name="author" content="Serge Tahé">
      
      
        <link rel="canonical" href="https://stahe.github.io/vbscript-janv-2002/les-fonctions-et-procedures.html">
      
      
        <link rel="prev" href="la-gestion-des-erreurs.html">
      
      
        <link rel="next" href="les-fichiers-texte.html">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>5. Les fonctions et procédures - Introduction au langage VBScript</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/focus.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EBZC3JVJNR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    // CORRECTION ICI : Utilisation de guillemets doubles pour entourer le titre qui contient une apostrophe
    var siteName = "Introduction au langage VBScript";

    gtag('config', 'G-EBZC3JVJNR', {
        'page_title': siteName
    });
    console.log("[GA Debug] page_title forced to: " + siteName);
  </script>

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#5-les-fonctions-et-procedures" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Introduction au langage VBScript" class="md-header__button md-logo" aria-label="Introduction au langage VBScript" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction au langage VBScript
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. Les fonctions et procédures
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/stahe/vbscript-janv-2002" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Introduction au langage VBScript" class="md-nav__button md-logo" aria-label="Introduction au langage VBScript" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Introduction au langage VBScript
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stahe/vbscript-janv-2002" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-contextes-dx27execution-de-vbscript.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Les contextes d&#x27;exécution de VBSCRIPT
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-bases-de-la-programmation-vbscript.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Les bases de la programmation VBSCRIPT
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="la-gestion-des-erreurs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. La gestion des erreurs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    5. Les fonctions et procédures
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="les-fonctions-et-procedures.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Les fonctions et procédures
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#51-les-fonctions-predefinies-de-vbscript" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1. Les fonctions prédéfinies de vbscript
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-programmation-modulaire" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2. Programmation modulaire
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-les-fonctions-et-procedures-vbscript" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3. Les fonctions et procédures vbscript
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3. Les fonctions et procédures vbscript">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-declaration-des-fonctions-et-procedures-vbscript" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.1. Déclaration des fonctions et procédures vbscript
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-modes-de-passage-des-parametres-dune-fonction-ou-procedure" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.2. Modes de passage des paramètres d&#x27;une fonction ou procédure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-syntaxe-dappel-des-fonctions-et-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.3. Syntaxe d&#x27;appel des fonctions et procédures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-quelques-exemples-de-fonctions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.4. Quelques exemples de fonctions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#535-parametre-de-sortie-ou-resultat-dune-fonction" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.5. Paramètre de sortie ou résultat d&#x27;une fonction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-le-programme-vbscript-de-tri-de-valeurs" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4. Le programme Vbscript de tri de valeurs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#55-le-programme-impots-sous-forme-modulaire" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5. Le programme IMPOTS sous forme modulaire
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fichiers-texte.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Les fichiers texte
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="5-les-fonctions-et-procedures">5. Les fonctions et procédures</h1>
<h2 id="51-les-fonctions-predefinies-de-vbscript">5.1. Les fonctions prédéfinies de vbscript</h2>
<p>La richesse d&#x27;un langage dérive en grande partie de sa bibliothèque de fonctions, ces dernières pouvant être encapsulées dans des objets sous le nom de méthodes. Sous cet aspect, on peut considérer que vbscript est plutôt pauvre.</p>
<p>Le tableau suivant définit les fonctions de VBScript hors objets. Nous ne les détaillerons pas. Leur nom est en général une indication de leur rôle. Le lecteur consultera la documentation pour avoir des détails sur une fonction particulière.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Abs</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctarray.htm"><u><u>Array</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctasc.htm"><u><u>Asc</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctatn.htm"><u><u>Atn</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcbool.htm"><u><u>CBool</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcbyte.htm"><u><u>CByte</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctccur.htm"><u><u>CCur</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcdate.htm"><u><u>CDate</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcdbl.htm"><u><u>CDbl</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctchr.htm"><u><u>Chr</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcint.htm"><u><u>CInt</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctclng.htm"><u><u>CLng</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsidxconversion.htm"><u><u>Conversions</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcos.htm"><u><u>Cos</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcreateobject.htm"><u><u>CreateObject</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctcsng.htm"><u><u>CSng</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctdate.htm"><u><u>Date</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctdateadd.htm"><u><u>DateAdd</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctdatediff.htm"><u><u>DateDiff</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctdatepart.htm"><u><u>DatePart</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctdateserial.htm"><u><u>DateSerial</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctdatevalue.htm"><u><u>DateValue</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctday.htm"><u><u>Day</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsgrpderivedmath.htm"><u><u>Derived Maths</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcteval.htm"><u><u>Eval</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctexp.htm"><u><u>Exp</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctfilter.htm"><u><u>Filter</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctformatcurrency.htm"><u><u>FormatCurrency</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctformatdatetime.htm"><u><u>FormatDateTime</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctformatnumber.htm"><u><u>FormatNumber</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctformatpercent.htm"><u><u>FormatPercent</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctgetlocale.htm"><u><u>GetLocale</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctgetobject.htm"><u><u>GetObject</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctgetref.htm"><u><u>GetRef</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcthex.htm"><u><u>Hex</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcthour.htm"><u><u>Hour</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctinputbox.htm"><u><u>InputBox</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctinstr.htm"><u><u>InStr</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctinstrrev.htm"><u><u>InStrRev</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctint.htm"><u><u>Int, Fixs</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctisarray.htm"><u><u>IsArray</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctisdate.htm"><u><u>IsDate</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctisempty.htm"><u><u>IsEmpty</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctisnull.htm"><u><u>IsNull</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctisnumeric.htm"><u><u>IsNumeric</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctisobject.htm"><u><u>IsObject</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctjoin.htm"><u><u>Join</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctlbound.htm"><u><u>LBound</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctlcase.htm"><u><u>LCase</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctleft.htm"><u><u>Left</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctlen.htm"><u><u>Len</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctloadpicture.htm"><u><u>LoadPicture</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctlog.htm"><u><u>Log</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctltrim.htm"><u><u>LTrim; RTrim; and Trims</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsidxmathfunctions.htm"><u><u>Maths</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctmid.htm"><u><u>Mid</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctminute.htm"><u><u>Minute</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctmonth.htm"><u><u>Month</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctmonthname.htm"><u><u>MonthName</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctmsgbox.htm"><u><u>MsgBox</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctnow.htm"><u><u>Now</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctoct.htm"><u><u>Oct</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctreplace.htm"><u><u>Replace</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctrgb.htm"><u><u>RGB</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctright.htm"><u><u>Right</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctrnd.htm"><u><u>Rnd</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctround.htm"><u><u>Round</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctscriptengine.htm"><u><u>ScriptEngine</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctscriptenginebuildversion.htm"><u><u>ScriptEngineBuildVersion</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctscriptenginemajorversion.htm"><u><u>ScriptEngineMajorVersion</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctscriptengineminorversion.htm"><u><u>ScriptEngineMinorVersion</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctsecond.htm"><u><u>Second</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctsetlocale.htm"><u><u>SetLocale</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctsgn.htm"><u><u>Sgn</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctsin.htm"><u><u>Sin</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctspace.htm"><u><u>Space</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctsplit.htm"><u><u>Split</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctsqr.htm"><u><u>Sqr</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctstrcomp.htm"><u><u>StrComp</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctstring.htm"><u><u>String</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcttan.htm"><u><u>Tan</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcttime.htm"><u><u>Time</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcttimer.htm"><u><u>Timer</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcttimeserial.htm"><u><u>TimeSerial</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcttimevalue.htm"><u><u>TimeValue</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfcttypename.htm"><u><u>TypeName</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctubound.htm"><u><u>UBound</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctucase.htm"><u><u>UCase</u></u></a></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctvartype.htm"><u><u>VarType</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctweekday.htm"><u><u>Weekday</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctweekdayname.htm"><u><u>WeekdayName</u></u></a></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><a href="../../../../../st-2020/st-2020/cours/vbscript/vsfctyear.htm"><u><u>Year</u></u></a></p></td></tr></table>

<h2 id="52-programmation-modulaire">5.2. Programmation modulaire</h2>
<p>Décrire la solution programmée d&#x27;un problème, c&#x27;est décrire la suite d&#x27;actions élémentaires exécutables par l&#x27;ordinateur et capables de résoudre le problème. Selon les langages ces opérations élémentaires sont plus ou moins sophistiquées. On trouve par exemple:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code>. lire une donnée provenant du clavier ou du disque

. écrire une donnée à l&amp;#x27;écran, sur imprimante, sur disque, etc

. calculer des expressions

. se déplacer dans un fichier

. ...
</code></pre></div></td></tr></table></div>
<p>Décrire un problème complexe peut nécessiter plusieurs milliers de ces instructions élémentaires et plus. Il est alors très difficile pour l&#x27;esprit humain d&#x27;avoir une vue globale d&#x27;un programme. Devant cette difficulté d&#x27;appréhender le problème dans sa globalité, on le décompose alors en sous-problèmes plus simples à résoudre. Considérons le problème suivant : Trier une liste de valeurs numériques tapées au clavier et afficher la liste triée à l&#x27;écran.</p>
<p>On peut dans un premier temps décrire la solution sous la forme suivante:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>  <span class="n">début</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>        <span class="n">lire</span> <span class="n">les</span> <span class="n">valeurs</span> <span class="n">et</span> <span class="n">les</span> <span class="n">mettre</span> <span class="n">dans</span> <span class="n">un</span> <span class="n">tableau</span> <span class="n">T</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>        <span class="n">trier</span> <span class="n">le</span> <span class="n">tableau</span> <span class="n">T</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>        <span class="n">écrire</span> <span class="n">les</span> <span class="n">valeurs</span> <span class="n">triées</span> <span class="n">du</span> <span class="n">tableau</span> <span class="n">T</span> <span class="n">à</span> <span class="n">l</span><span class="s1">&#39;écran</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>  <span class="n">fin</span>
</code></pre></div></td></tr></table></div>
<p>On a décomposé le problème en 3 sous-problèmes, plus simples à résoudre. L&#x27;écriture algorithmique est souvent plus formalisée que la précédente et l&#x27;algorithme s&#x27;écrira plutôt:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>   <span class="n">début</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>         <span class="n">lire_tableau</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>         <span class="n">trier_tableau</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>         <span class="n">écrire_tableau</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>   <span class="n">fin</span>
</code></pre></div></td></tr></table></div>
<p>où T représente un tableau. Les opérations </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>    <span class="o">.</span> <span class="n">lire_tableau</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>    <span class="o">.</span> <span class="n">trier_tableau</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>    <span class="o">.</span> <span class="n">écrire_tableau</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>sont des opérations non élémentaires qui doivent être décrites à leur tour par des opérations élémentaires. Ceci est fait dans ce qu&#x27;on appelle des modules. La donnée T est appelée un paramètre du module. C&#x27;est une information que le programme appelant passe au module appelé (paramètre d&#x27;entrée) ou reçoit du module appelé (paramètre de sortie). Les paramètres d&#x27;un module sont donc les informations qui sont échangées entre le programme appelant et le module appelé.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">module lire_tableau(T)</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000017E0000008A7F5CD177.png" style="display:inline-block; margin:4px;width:5.054cm;height:1.826cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">module trier_tableau(T)</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000014F000000D8414BA015.png" style="display:inline-block; margin:4px;width:4.433cm;height:2.858cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">module écrire_tableau(T)</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000200000000AD49850B97.png" style="display:inline-block; margin:4px;width:6.773cm;height:2.29cm;" /></td></tr></table>

<p>Le module lire_tableau(T) pourrait être décrit comme suit :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">début</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>    <span class="n">écrire</span> <span class="s2">&quot;Tapez la suite de valeurs à trier sous la forme val1 val2 ... : &quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>    <span class="n">lire</span> <span class="n">valeurs</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>    <span class="n">construire</span> <span class="n">tableau</span> <span class="n">T</span> <span class="n">à</span> <span class="n">partir</span> <span class="n">de</span> <span class="n">la</span> <span class="n">chaîne</span> <span class="n">valeurs</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="n">fin</span>
</code></pre></div></td></tr></table></div>
<p>Ici, nous avons suffisamment décrit le module lire_tableau. En effet, les trois actions nécessaires ont une traduction immédiate en vbscript. La dernière nécessitera l&#x27;utilisation de la fonction split. Si vbscript n&#x27;avait pas cette fonction, l&#x27;action 3 devrait être décomposée à son tour en actions élémentaires ayant un équivalent immédiat en vbscript.</p>
<p>Le module écrire_tableau(T) pourrait être décrit comme suit :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">début</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>    <span class="n">construire</span> <span class="n">chaîne</span> <span class="n">texte</span> <span class="s2">&quot;valeur1,valeur2,....&quot;</span> <span class="n">à</span> <span class="n">partir</span> <span class="n">du</span> <span class="n">tableau</span> <span class="n">T</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>    <span class="n">écrire</span> <span class="n">texte</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="n">fin</span>
</code></pre></div></td></tr></table></div>
<p>Le module écrire_tableau(T) pourrait être décrit comme suit (on suppose que les indices des éléments de T commencent à 0) :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">début</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>      <span class="n">N</span><span class="o">&lt;--</span> <span class="n">indice</span> <span class="n">dernier</span> <span class="n">élément</span> <span class="n">du</span> <span class="n">tableau</span> <span class="n">T</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>      <span class="n">pour</span> <span class="n">IFIN</span> <span class="n">variant</span> <span class="n">de</span> <span class="n">N</span> <span class="n">à</span> <span class="mi">1</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>      <span class="n">faire</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>          <span class="o">//</span><span class="n">on</span> <span class="n">recherche</span> <span class="n">l</span><span class="s1">&#39;indice IMAX du plus gd élément de T</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a>          <span class="o">//</span> <span class="n">IFIN</span> <span class="n">est</span> <span class="n">l</span><span class="s1">&#39;indice du dernier élément de T</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a>          <span class="n">chercher_max</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">IFIN</span><span class="p">,</span> <span class="n">IMAX</span><span class="p">)</span> 
<a id="__codelineno-5-9" name="__codelineno-5-9"></a>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a>          <span class="o">//</span> <span class="n">on</span> <span class="n">échange</span> <span class="n">l</span><span class="s1">&#39;élément le plus grand de T avec le dernier élément de T</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>          <span class="n">échanger</span> <span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">IMAX</span><span class="p">,</span> <span class="n">IFIN</span><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a>      <span class="n">finfaire</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="n">FIN</span>
</code></pre></div></td></tr></table></div>
<p>Ici l&#x27;algorithme utilise de nouveau des actions non élémentaires:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a> <span class="o">.</span> <span class="n">chercher_max</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">IFIN</span><span class="p">,</span> <span class="n">IMAX</span><span class="p">)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a> <span class="o">.</span> <span class="n">échanger</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">IMAX</span><span class="p">,</span> <span class="n">IFIN</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>chercher_max(T, IFIN, IMAX) rend l&#x27;indice IMAX de l&#x27;élément le plus grand du tableau T dont l&#x27;indice du dernier élément est  IFIN.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000011B000000CB24BEC5B9.png" style="display:inline-block; margin:4px;width:3.745cm;height:2.686cm;" /></td></tr></table>

<p>échanger(T, IMAX, IFIN) échange 2 éléments du tableau T , ceux d&#x27;indice IMAX et IFIN.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001B9000000C5DC6E1A6D.png" style="display:inline-block; margin:4px;width:5.835cm;height:2.607cm;" /></td></tr></table>

<p>Il faut donc décrire les nouvelles opérations non élémentaires.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">module chercher_max(A, IFIN, IMAX)</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>   <span class="n">début</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>        <span class="n">IMAX</span><span class="o">&lt;--</span><span class="mi">0</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>        <span class="n">pour</span> <span class="n">i</span> <span class="n">variant</span> <span class="n">de</span> <span class="mi">1</span> <span class="n">à</span> <span class="n">IFIN</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>        <span class="n">faire</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>           <span class="n">si</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">T</span><span class="p">[</span><span class="n">IMAX</span><span class="p">]</span> <span class="n">alors</span> 
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>             <span class="n">début</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>                <span class="n">IMAX</span><span class="o">&lt;--</span><span class="n">i</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a>             <span class="n">fin</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a>        <span class="n">finfaire</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a>    <span class="n">fin</span>
</code></pre></div></td></tr></table></div>
</div></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">module échanger(T IMAX, IFIN)</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>  <span class="n">début</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>       <span class="n">temp</span><span class="o">&lt;----</span><span class="n">T</span><span class="p">[</span><span class="n">IMAX</span><span class="p">]</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>       <span class="n">T</span><span class="p">[</span><span class="n">IMAX</span><span class="p">]</span><span class="o">&lt;---</span><span class="n">T</span><span class="p">[</span><span class="n">IFIN</span><span class="p">]</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>       <span class="n">T</span><span class="p">[</span><span class="n">IFIN</span><span class="p">]</span><span class="o">&lt;---</span><span class="n">temp</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>  <span class="n">fin</span>
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Le problème initial  a été complètement décrit à l&#x27;aide d&#x27;opérations élémentaires vbscript et peut donc maintenant faire l&#x27;objet d&#x27;une traduction dans ce langage. On notera que les actions élémentaires peuvent différer d&#x27;un langage à l&#x27;autre et que donc l&#x27;analyse d&#x27;un problème doit à un certain moment tenir compte du langage de programmation utilisé. Un objet qui existe dans un langage peut ne pas exister dans un autre et modifier alors l&#x27;algorithme utilisé. Ainsi, si un langage avait une fonction de tri, il serait ici absurde de ne pas l&#x27;utiliser.</p>
<p>Le principe appliqué ici, est celui dit  de l&#x27;analyse descendante. Si on représente l&#x27;ossature de la solution, on a la chose suivante :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003410000012DD84E7EB3.png" style="display:inline-block; margin:4px;width:11.021cm;height:3.983cm;" /></td></tr></table>

<p>On a une structure en arbre.</p>
<h2 id="53-les-fonctions-et-procedures-vbscript">5.3. Les fonctions et procédures vbscript</h2>
<p>Une fois l&#x27;analyse modulaire opérée, le programmeur peut traduire les modules de son algorithme en fonctions ou procédures vbscript. Les fonctions et procédures admettent toutes deux des paramètres d&#x27;entrée/sortie mais la fonction rend un résultat qui permet son utilisation dans des expressions alors que la procédure n&#x27;en rend pas.</p>
<h3 id="531-declaration-des-fonctions-et-procedures-vbscript">5.3.1. Déclaration des fonctions et procédures vbscript</h3>
<p>La déclaration d&#x27;une procédure vbscript est la suivante </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">sub</span> <span class="n">nomProcédure</span><span class="p">([</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param1</span><span class="p">,</span> <span class="p">[</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>    <span class="n">instructions</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="n">end</span> <span class="n">sub</span>
</code></pre></div></td></tr></table></div>
<p>et celle d&#x27;une fonction </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">function</span> <span class="n">nomFonction</span><span class="p">([</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param1</span><span class="p">,</span> <span class="p">[</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>    <span class="n">instructions</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="n">end</span> <span class="n">sub</span>
</code></pre></div></td></tr></table></div>
<p>Pour rendre son résultat, la fonction doit comporter une instruction d&#x27;affectation du résultat à une variable portant le nom de la fonction :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>nomFonction=résultat
</code></pre></div></td></tr></table></div>
<p>L&#x27;exécution d&#x27;une fonction ou procédure s&#x27;arrête de deux façons :</p>
<ul>
<li>à la rencontre de l&#x27;instruction de fin de fonction (end function) ou fin de procédure (end sub)</li>
<li>à la rencontre de l&#x27;instruction de sortie de fonction (exit function) ou de procédure (exit sub)
Pour la fonction, on se rappellera que le résultat doit avoir été affecté à une variable portant le nom de la fonction avant que celle-ci ne se termine par un end function ou exit function.</li>
</ul>
<h3 id="532-modes-de-passage-des-parametres-dune-fonction-ou-procedure">5.3.2. Modes de passage des paramètres d&#x27;une fonction ou procédure</h3>
<p>Dans la déclaration des paramètres d&#x27;entrée-sortie d&#x27;une fonction ou procédure, on précise le mode (<strong>byRef,byVal</strong>) de transmission du paramètre du programme appelant vers le programme appelé :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">sub</span> <span class="n">nomProcédure</span><span class="p">([</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param1</span><span class="p">,</span> <span class="p">[</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">function</span> <span class="n">nomFonction</span><span class="p">([</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param1</span><span class="p">,</span> <span class="p">[</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">param2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Lorsque le mode de transmission byRef ou byVal n&#x27;est pas précisé, c&#x27;est le mode byRef qui est utilisé.</p>
<p><u><strong>Paramètres effectifs, paramètres formels</strong></u></p>
<p>Soit une fonction vbscript définie par</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">function</span> <span class="n">nomFonction</span><span class="p">([</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">paramForm1</span><span class="p">,</span> <span class="p">[</span><span class="n">Byref</span><span class="o">/</span><span class="n">Byval</span><span class="p">]</span> <span class="n">paramForm2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="o">...</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="n">end</span> <span class="n">function</span>
</code></pre></div></td></tr></table></div>
<p>Les paramètres parmamFormi utilisés dans la définition de la fonction ou de la procédure sont appelés <strong>paramètres formels</strong>. La fonction précédente pourra être utilisée à partir du programme principal ou d&#x27;un autre module par une instruction du genre :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">résultat</span><span class="o">=</span><span class="n">nomFonction</span><span class="p">(</span><span class="n">paramEff1</span><span class="p">,</span> <span class="n">paramEff2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Les paramètres parmamEffi utilisés dans l&#x27;appel à la fonction ou la procédure sont appelés <strong>paramètres effectifs</strong>. Lorsque l&#x27;exécution de la fonction nomFonction commence, les paramètres formels reçoivent les valeurs des paramètres effectifs correspondants. Les mots clés byRef et byVal fixent le mode de transmission de ces valeurs.</p>
<p><u><strong>Mode de transmission par valeur (byVal)</strong></u></p>
<p>Lorsqu&#x27;un paramètre formel précise ce mode de transmission, le paramètre formel et le paramètre effectif sont alors deux variables différentes. La valeur du paramètre effectif est copiée dans le paramètre formel avant exécution de la fonction ou procédure. Si celle-ci modifie la valeur du paramètre formel au cours de son exécution, cela ne modifie en rien la valeur du paramètre effectif correspondant. Ce mode de transmission convient bien aux paramètres d&#x27;entrée de la fonction ou procédure.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003AE0000015201B9BF3A.png" style="display:inline-block; margin:4px;width:12.462cm;height:4.471cm;" /></td></tr></table>

<p><u><strong>Mode de transmission par référence (byRef)</strong></u></p>
<p>Ce mode de transmission est le mode par défaut si aucun mode de transmission du paramètre n&#x27;est indiqué. Lorsqu&#x27;un paramètre formel précise ce mode de transmission, le paramètre formel et le paramètre effectif correspondant <strong>sont une seule et même variable</strong>. Ainsi si la fonction modifie le paramètre formel, le paramètre effectif est également modifié. Ce mode de transmission convient bien :</p>
<ul>
<li>aux paramètres de sortie car la valeur de ceux-ci doivt être transmise au programme appelant</li>
<li>aux paramètres d&#x27;entrée coûteux à recopier tels les tableaux</li>
</ul>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003BF0000013E151932EA.png" style="display:inline-block; margin:4px;width:12.688cm;height:4.207cm;" /></td></tr></table>

<p>Le programme suivant montre des exemples de passage de paramètres :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span>
<span class="normal"><a href="#__codelineno-14-28">28</a></span>
<span class="normal"><a href="#__codelineno-14-29">29</a></span>
<span class="normal"><a href="#__codelineno-14-30">30</a></span>
<span class="normal"><a href="#__codelineno-14-31">31</a></span>
<span class="normal"><a href="#__codelineno-14-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">Sub</span> <span class="n">proc1</span><span class="p">(</span><span class="n">byval</span> <span class="n">i</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a>  <span class="s1">&#39; i est passé par valeur (byval) - le paramètre effectif et le paramètre formel sont alors différents</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>  <span class="s1">&#39; j est passé par valeur (byref) - le paramètre effectif et le paramètre formel sont alors identiques</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a>  <span class="s1">&#39; le mode de passage de k n&#39;</span><span class="n">est</span> <span class="n">pas</span> <span class="n">précisé</span><span class="o">.</span> <span class="n">Par</span> <span class="n">défaut</span><span class="p">,</span> <span class="n">c</span><span class="s1">&#39;est par référence</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a>  <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a>  <span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a>  <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a>  <span class="n">affiche</span> <span class="s2">&quot;dans proc1&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="n">End</span> <span class="n">Sub</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a> <span class="n">Sub</span> <span class="n">affiche</span><span class="p">(</span><span class="n">byval</span> <span class="n">msg</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">i</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">j</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">k</span><span class="p">)</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a>  <span class="s1">&#39; affiche les valeurs de i et j et k</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="n">msg</span> <span class="o">&amp;</span> <span class="s2">&quot; i=&quot;</span> <span class="o">&amp;</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="s2">&quot; j=&quot;</span> <span class="o">&amp;</span> <span class="n">j</span> <span class="o">&amp;</span> <span class="s2">&quot; k=&quot;</span> <span class="o">&amp;</span> <span class="n">k</span>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="n">End</span> <span class="n">Sub</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="s1">&#39; ------------- appels aux fonctions et procédures</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="s1">&#39; init i et j</span>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a>  <span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">:</span><span class="n">j</span><span class="o">=</span><span class="mi">5</span> <span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="s1">&#39; vérification</span>
<a id="__codelineno-14-23" name="__codelineno-14-23"></a>  <span class="n">affiche</span> <span class="s2">&quot;dans programme principal, avant l&#39;appel à proc1 :&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a id="__codelineno-14-24" name="__codelineno-14-24"></a>
<a id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="s1">&#39; appel procédure proc1</span>
<a id="__codelineno-14-26" name="__codelineno-14-26"></a>  <span class="n">proc1</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a id="__codelineno-14-27" name="__codelineno-14-27"></a>
<a id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="s1">&#39; vérification</span>
<a id="__codelineno-14-29" name="__codelineno-14-29"></a>  <span class="n">affiche</span> <span class="s2">&quot;dans programme principal, après l&#39;appel à proc1 :&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>
<a id="__codelineno-14-30" name="__codelineno-14-30"></a>
<a id="__codelineno-14-31" name="__codelineno-14-31"></a><span class="s1">&#39; fin</span>
<a id="__codelineno-14-32" name="__codelineno-14-32"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">quit</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
</div></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">dans</span> <span class="n">programme</span> <span class="n">principal</span><span class="p">,</span> <span class="n">avant</span> <span class="n">l</span><span class="s1">&#39;appel à proc1 : i=4 j=5 k=6</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="n">dans</span> <span class="n">proc1</span> <span class="n">i</span><span class="o">=</span><span class="mi">5</span> <span class="n">j</span><span class="o">=</span><span class="mi">6</span> <span class="n">k</span><span class="o">=</span><span class="mi">7</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="n">dans</span> <span class="n">programme</span> <span class="n">principal</span><span class="p">,</span> <span class="n">après</span> <span class="n">l</span><span class="s1">&#39;appel à proc1 : i=4 j=6 k=7</span>
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p><strong>Commentaires</strong></p>
<ul>
<li>Dans un script vbscript, il n&#x27;y a pas de place particulière pour les fonctions et les procédures. Elles peuvent être n&#x27;importe où dans le texte source. En général, on les regroupe soit au début soit à la fin et on fait en sorte que le programme principal constitue un bloc continu.</li>
</ul>
<h3 id="533-syntaxe-dappel-des-fonctions-et-procedures">5.3.3. Syntaxe d&#x27;appel des fonctions et procédures</h3>
<p>Soit une procédure p admettant des paramètres formels pf1, pf2, ...</p>
<ul>
<li>l&#x27;appel à la procédure p se fait sous la forme
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">p</span> <span class="n">pe1</span><span class="p">,</span> <span class="n">pe2</span><span class="p">,</span> <span class="o">...</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<p>sans parenthèses autour des paramètres</p>
<ul>
<li>
<p>si la procédure p n&#x27;admet aucun paramètre, on peut indifféremment utiliser l&#x27;appel p ou p() et la déclaration sub p ou sub p()
Soit une fonction f admettant des paramètres formels pf1, pf2, ...</p>
</li>
<li>
<p>l&#x27;appel à la fonction f se fait sous la forme
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">résultat</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">pe1</span><span class="p">,</span> <span class="n">pe2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p>les parenthèses autour des paramètres sont obligatoires. Si la fonction f n&#x27;admet aucun paramètre, on peut indifféremment utiliser l&#x27;appel f ou f() et la déclaration function f ou function f().</p>
<ul>
<li>
<p>le résultat de la fonction f peut être ignoré par le programme appelant. La fonction f est alors considérée comme une procédure et suit les règles d&#x27;appel des procédures. On écrit alors f pe1, pe2, ... (sans parenthèses) pour appeler la fonction f.
Si la fonction ou procédure est une méthode d&#x27;objet, il semblerait que les règles soient quelque peu différentes et non homogènes.</p>
</li>
<li>
<p>ainsi on peut écrire MyFile.WriteLine &quot;Ceci est un test.&quot; ou MyFile.WriteLine(&quot;Ceci est un test.&quot;) </p>
</li>
<li>
<p>mais si on peut écrire wscript.echo 4, on ne peut pas écrire wscript.echo(4).
On s&#x27;en tiendra aux règles suivantes :</p>
</li>
<li>
<p>pas de parenthèses autour des paramètres d&#x27;une procédure ou d&#x27;une fonction utilisée comme une procédure</p>
</li>
<li>parenthèses autour des paramètres d&#x27;une fonction</li>
</ul>
<h3 id="534-quelques-exemples-de-fonctions">5.3.4. Quelques exemples de fonctions</h3>
<p>On trouvera ci-dessous quelques exemples de définitions et utilisations de fonctions :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span>
<span class="normal"><a href="#__codelineno-18-22">22</a></span>
<span class="normal"><a href="#__codelineno-18-23">23</a></span>
<span class="normal"><a href="#__codelineno-18-24">24</a></span>
<span class="normal"><a href="#__codelineno-18-25">25</a></span>
<span class="normal"><a href="#__codelineno-18-26">26</a></span>
<span class="normal"><a href="#__codelineno-18-27">27</a></span>
<span class="normal"><a href="#__codelineno-18-28">28</a></span>
<span class="normal"><a href="#__codelineno-18-29">29</a></span>
<span class="normal"><a href="#__codelineno-18-30">30</a></span>
<span class="normal"><a href="#__codelineno-18-31">31</a></span>
<span class="normal"><a href="#__codelineno-18-32">32</a></span>
<span class="normal"><a href="#__codelineno-18-33">33</a></span>
<span class="normal"><a href="#__codelineno-18-34">34</a></span>
<span class="normal"><a href="#__codelineno-18-35">35</a></span>
<span class="normal"><a href="#__codelineno-18-36">36</a></span>
<span class="normal"><a href="#__codelineno-18-37">37</a></span>
<span class="normal"><a href="#__codelineno-18-38">38</a></span>
<span class="normal"><a href="#__codelineno-18-39">39</a></span>
<span class="normal"><a href="#__codelineno-18-40">40</a></span>
<span class="normal"><a href="#__codelineno-18-41">41</a></span>
<span class="normal"><a href="#__codelineno-18-42">42</a></span>
<span class="normal"><a href="#__codelineno-18-43">43</a></span>
<span class="normal"><a href="#__codelineno-18-44">44</a></span>
<span class="normal"><a href="#__codelineno-18-45">45</a></span>
<span class="normal"><a href="#__codelineno-18-46">46</a></span>
<span class="normal"><a href="#__codelineno-18-47">47</a></span>
<span class="normal"><a href="#__codelineno-18-48">48</a></span>
<span class="normal"><a href="#__codelineno-18-49">49</a></span>
<span class="normal"><a href="#__codelineno-18-50">50</a></span>
<span class="normal"><a href="#__codelineno-18-51">51</a></span>
<span class="normal"><a href="#__codelineno-18-52">52</a></span>
<span class="normal"><a href="#__codelineno-18-53">53</a></span>
<span class="normal"><a href="#__codelineno-18-54">54</a></span>
<span class="normal"><a href="#__codelineno-18-55">55</a></span>
<span class="normal"><a href="#__codelineno-18-56">56</a></span>
<span class="normal"><a href="#__codelineno-18-57">57</a></span>
<span class="normal"><a href="#__codelineno-18-58">58</a></span>
<span class="normal"><a href="#__codelineno-18-59">59</a></span>
<span class="normal"><a href="#__codelineno-18-60">60</a></span>
<span class="normal"><a href="#__codelineno-18-61">61</a></span>
<span class="normal"><a href="#__codelineno-18-62">62</a></span>
<span class="normal"><a href="#__codelineno-18-63">63</a></span>
<span class="normal"><a href="#__codelineno-18-64">64</a></span>
<span class="normal"><a href="#__codelineno-18-65">65</a></span>
<span class="normal"><a href="#__codelineno-18-66">66</a></span>
<span class="normal"><a href="#__codelineno-18-67">67</a></span>
<span class="normal"><a href="#__codelineno-18-68">68</a></span>
<span class="normal"><a href="#__codelineno-18-69">69</a></span>
<span class="normal"><a href="#__codelineno-18-70">70</a></span>
<span class="normal"><a href="#__codelineno-18-71">71</a></span>
<span class="normal"><a href="#__codelineno-18-72">72</a></span>
<span class="normal"><a href="#__codelineno-18-73">73</a></span>
<span class="normal"><a href="#__codelineno-18-74">74</a></span>
<span class="normal"><a href="#__codelineno-18-75">75</a></span>
<span class="normal"><a href="#__codelineno-18-76">76</a></span>
<span class="normal"><a href="#__codelineno-18-77">77</a></span>
<span class="normal"><a href="#__codelineno-18-78">78</a></span>
<span class="normal"><a href="#__codelineno-18-79">79</a></span>
<span class="normal"><a href="#__codelineno-18-80">80</a></span>
<span class="normal"><a href="#__codelineno-18-81">81</a></span>
<span class="normal"><a href="#__codelineno-18-82">82</a></span>
<span class="normal"><a href="#__codelineno-18-83">83</a></span>
<span class="normal"><a href="#__codelineno-18-84">84</a></span>
<span class="normal"><a href="#__codelineno-18-85">85</a></span>
<span class="normal"><a href="#__codelineno-18-86">86</a></span>
<span class="normal"><a href="#__codelineno-18-87">87</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a> <span class="n">Function</span> <span class="n">plusgrandque</span><span class="p">(</span><span class="n">byval</span> <span class="n">i</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">j</span><span class="p">)</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>  <span class="s1">&#39; rend le booléen vrai si i&gt;j, le booléen faux sinon</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>  <span class="s1">&#39; vérification des données</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>  <span class="n">If</span> <span class="n">isnumeric</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">And</span> <span class="n">isnumeric</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="n">Then</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a>    <span class="n">If</span> <span class="n">i</span><span class="o">&gt;</span><span class="n">j</span> <span class="n">Then</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a>      <span class="n">plusgrandque</span><span class="o">=</span><span class="n">true</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a>    <span class="n">Else</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a>      <span class="n">plusgrandque</span><span class="o">=</span><span class="n">false</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a>    <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a>  <span class="n">Else</span>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a>    <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;Arguments (&quot;</span> <span class="o">&amp;</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="s2">&quot;,&quot;</span> <span class="o">&amp;</span> <span class="n">j</span> <span class="o">&amp;</span> <span class="s2">&quot;) erronés&quot;</span>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a>    <span class="n">plusgrandque</span><span class="o">=</span><span class="n">false</span>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a>  <span class="n">Exit</span> <span class="n">Function</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="n">End</span> <span class="n">Function</span>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a> <span class="n">Function</span> <span class="n">rendUnTableau</span><span class="p">(</span><span class="n">byval</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a>  <span class="s1">&#39; rend un tableau de n éléments</span>
<a id="__codelineno-18-20" name="__codelineno-18-20"></a>  <span class="n">tableau</span><span class="o">=</span><span class="n">array</span><span class="p">()</span>
<a id="__codelineno-18-21" name="__codelineno-18-21"></a>  <span class="s1">&#39; vérification validité du paramètre n</span>
<a id="__codelineno-18-22" name="__codelineno-18-22"></a>  <span class="n">If</span> <span class="n">isnumeric</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="n">And</span> <span class="n">n</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="n">Then</span>
<a id="__codelineno-18-23" name="__codelineno-18-23"></a>    <span class="n">ReDim</span> <span class="n">Preserve</span> <span class="n">tableau</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-18-24" name="__codelineno-18-24"></a>    <span class="n">For</span> <span class="n">i</span><span class="o">=</span> <span class="mi">0</span> <span class="n">To</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-18-25" name="__codelineno-18-25"></a>      <span class="n">tableau</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">i</span>
<a id="__codelineno-18-26" name="__codelineno-18-26"></a>    <span class="n">Next</span>
<a id="__codelineno-18-27" name="__codelineno-18-27"></a>  <span class="n">Else</span>
<a id="__codelineno-18-28" name="__codelineno-18-28"></a>    <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;Argument [&quot;</span> <span class="o">&amp;</span> <span class="n">n</span> <span class="o">&amp;</span> <span class="s2">&quot;] erroné&quot;</span>
<a id="__codelineno-18-29" name="__codelineno-18-29"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-18-30" name="__codelineno-18-30"></a>  <span class="s1">&#39; on rend le résultat</span>
<a id="__codelineno-18-31" name="__codelineno-18-31"></a>  <span class="n">rendUnTableau</span><span class="o">=</span><span class="n">tableau</span>
<a id="__codelineno-18-32" name="__codelineno-18-32"></a><span class="n">End</span> <span class="n">Function</span>
<a id="__codelineno-18-33" name="__codelineno-18-33"></a>
<a id="__codelineno-18-34" name="__codelineno-18-34"></a> <span class="n">Function</span> <span class="n">argumentsVariables</span><span class="p">(</span><span class="n">byref</span> <span class="n">arguments</span><span class="p">)</span>
<a id="__codelineno-18-35" name="__codelineno-18-35"></a>  <span class="s1">&#39; arguments est un tableau de nombres dont on rend la somme</span>
<a id="__codelineno-18-36" name="__codelineno-18-36"></a>  <span class="n">somme</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-18-37" name="__codelineno-18-37"></a>  <span class="n">For</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="n">To</span> <span class="n">ubound</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>
<a id="__codelineno-18-38" name="__codelineno-18-38"></a>    <span class="n">somme</span><span class="o">=</span><span class="n">somme</span><span class="o">+</span><span class="n">arguments</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-18-39" name="__codelineno-18-39"></a>  <span class="n">Next</span>
<a id="__codelineno-18-40" name="__codelineno-18-40"></a>  <span class="n">argumentsVariables</span><span class="o">=</span><span class="n">somme</span>
<a id="__codelineno-18-41" name="__codelineno-18-41"></a><span class="n">End</span> <span class="n">Function</span>
<a id="__codelineno-18-42" name="__codelineno-18-42"></a>
<a id="__codelineno-18-43" name="__codelineno-18-43"></a>  <span class="s1">&#39; deux fonctions sans paramètres déclarées de 2 façons différentes</span>
<a id="__codelineno-18-44" name="__codelineno-18-44"></a>  <span class="n">Function</span> <span class="n">sansParametres1</span>
<a id="__codelineno-18-45" name="__codelineno-18-45"></a>    <span class="n">sansParametres</span><span class="o">=</span><span class="mi">4</span>
<a id="__codelineno-18-46" name="__codelineno-18-46"></a>  <span class="n">End</span> <span class="n">Function</span>
<a id="__codelineno-18-47" name="__codelineno-18-47"></a>
<a id="__codelineno-18-48" name="__codelineno-18-48"></a>  <span class="n">Function</span> <span class="n">sansParametres2</span><span class="p">()</span>
<a id="__codelineno-18-49" name="__codelineno-18-49"></a>    <span class="n">sansParametres</span><span class="o">=</span><span class="mi">4</span>
<a id="__codelineno-18-50" name="__codelineno-18-50"></a>  <span class="n">End</span> <span class="n">Function</span>
<a id="__codelineno-18-51" name="__codelineno-18-51"></a>
<a id="__codelineno-18-52" name="__codelineno-18-52"></a>
<a id="__codelineno-18-53" name="__codelineno-18-53"></a><span class="s1">&#39; ------------- appels aux fonctions et procédures</span>
<a id="__codelineno-18-54" name="__codelineno-18-54"></a>
<a id="__codelineno-18-55" name="__codelineno-18-55"></a><span class="s1">&#39; appels fonction plusgrandque</span>
<a id="__codelineno-18-56" name="__codelineno-18-56"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;plusgrandque(10,6)=&quot;</span> <span class="o">&amp;</span> <span class="n">plusgrandque</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-18-57" name="__codelineno-18-57"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;plusgrandque(6,10)=&quot;</span> <span class="o">&amp;</span> <span class="n">plusgrandque</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-18-58" name="__codelineno-18-58"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;plusgrandque(6,6)=&quot;</span> <span class="o">&amp;</span> <span class="n">plusgrandque</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-18-59" name="__codelineno-18-59"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;plusgrandque(6,&#39;a&#39;)=&quot;</span> <span class="o">&amp;</span> <span class="n">plusgrandque</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<a id="__codelineno-18-60" name="__codelineno-18-60"></a>
<a id="__codelineno-18-61" name="__codelineno-18-61"></a><span class="s1">&#39; appels à la fonction rendUnTableau</span>
<a id="__codelineno-18-62" name="__codelineno-18-62"></a>  <span class="n">monTableau</span><span class="o">=</span><span class="n">rendUnTableau</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-18-63" name="__codelineno-18-63"></a>  <span class="n">For</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="n">To</span> <span class="n">ubound</span><span class="p">(</span><span class="n">monTableau</span><span class="p">)</span>
<a id="__codelineno-18-64" name="__codelineno-18-64"></a>    <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="n">monTableau</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-18-65" name="__codelineno-18-65"></a>  <span class="n">Next</span>
<a id="__codelineno-18-66" name="__codelineno-18-66"></a>  <span class="n">monTableau</span><span class="o">=</span><span class="n">rendUnTableau</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-18-67" name="__codelineno-18-67"></a>  <span class="n">For</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span> <span class="n">To</span> <span class="n">ubound</span><span class="p">(</span><span class="n">monTableau</span><span class="p">)</span>
<a id="__codelineno-18-68" name="__codelineno-18-68"></a>    <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="n">monTableau</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-18-69" name="__codelineno-18-69"></a>  <span class="n">Next</span>
<a id="__codelineno-18-70" name="__codelineno-18-70"></a>
<a id="__codelineno-18-71" name="__codelineno-18-71"></a><span class="s1">&#39; appels à la fonction argumentsVariables</span>
<a id="__codelineno-18-72" name="__codelineno-18-72"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;somme=&quot;</span> <span class="o">&amp;</span> <span class="n">argumentsVariables</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<a id="__codelineno-18-73" name="__codelineno-18-73"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;somme=&quot;</span> <span class="o">&amp;</span> <span class="n">argumentsVariables</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<a id="__codelineno-18-74" name="__codelineno-18-74"></a>
<a id="__codelineno-18-75" name="__codelineno-18-75"></a><span class="s1">&#39; appels des fonctions sans paramètres</span>
<a id="__codelineno-18-76" name="__codelineno-18-76"></a>  <span class="n">res</span><span class="o">=</span><span class="n">sansParametres1</span>
<a id="__codelineno-18-77" name="__codelineno-18-77"></a>  <span class="n">res</span><span class="o">=</span><span class="n">sansParametres1</span><span class="p">()</span>
<a id="__codelineno-18-78" name="__codelineno-18-78"></a>  <span class="n">sansParametres1</span>
<a id="__codelineno-18-79" name="__codelineno-18-79"></a>  <span class="n">sansParametres1</span><span class="p">()</span>
<a id="__codelineno-18-80" name="__codelineno-18-80"></a>
<a id="__codelineno-18-81" name="__codelineno-18-81"></a>  <span class="n">res</span><span class="o">=</span><span class="n">sansParametres2</span>
<a id="__codelineno-18-82" name="__codelineno-18-82"></a>  <span class="n">res</span><span class="o">=</span><span class="n">sansParametres2</span><span class="p">()</span>
<a id="__codelineno-18-83" name="__codelineno-18-83"></a>  <span class="n">sansParametres2</span>
<a id="__codelineno-18-84" name="__codelineno-18-84"></a>  <span class="n">sansParametres2</span><span class="p">()</span>
<a id="__codelineno-18-85" name="__codelineno-18-85"></a>
<a id="__codelineno-18-86" name="__codelineno-18-86"></a><span class="s1">&#39; fin</span>
<a id="__codelineno-18-87" name="__codelineno-18-87"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">quit</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
</div></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="n">plusgrandque</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">Vrai</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="n">plusgrandque</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span><span class="n">Faux</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="n">plusgrandque</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">Faux</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="n">Arguments</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">a</span><span class="p">)</span> <span class="n">erronés</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="n">plusgrandque</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">=</span><span class="n">Faux</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="mi">0</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="mi">1</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="mi">2</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="mi">3</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="mi">4</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="mi">5</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="mi">6</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="mi">7</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="mi">8</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="mi">9</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="n">Argument</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span> <span class="n">erroné</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="n">somme</span><span class="o">=</span><span class="mi">16</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="n">somme</span><span class="o">=</span><span class="mi">21</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="n">somme</span><span class="o">=</span><span class="mi">10</span>
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p><strong>Commentaires</strong></p>
<ul>
<li>la fonction rendUnTableau montre qu&#x27;une fonction peut rendre plusieurs résultats et non un seul. Il suffit qu&#x27;elle les place dans un variant tableau et qu&#x27;elle rende ce variant comme résultat.</li>
<li>inversement la fonction argumentsVariables montre qu&#x27;on peut écrire une fonction qui admet un nombre variable d&#x27;arguments. Il suffit là également de les mettre dans un variant tableau et de faire de ce variant un paramètre de la fonction.</li>
</ul>
<h3 id="535-parametre-de-sortie-ou-resultat-dune-fonction">5.3.5. Paramètre de sortie ou résultat d&#x27;une fonction</h3>
<p>Supposons que l&#x27;analyse d&#x27;une application ait montré la nécessité d&#x27;un module M avec des paramètres d&#x27;entrée Ei et des paramètres de sortie Sj. Rappelons que les paramètres d&#x27;entrée sont des informations que le programme appelant donne au programme appelé et qu&#x27;inversement les paramètres de sortie sont des informations que le programme appelé donne au programme appelant. On a en vbscript plusieurs solutions pour les paramètres de sortie :</p>
<ul>
<li>s&#x27;il n&#x27;y a qu&#x27;un seul paramètre de sortie, on peut en faire le résultat d&#x27;une fonction. Il n&#x27;y a alors plus de paramètre de sortie mais simplement un résultat de fonction.</li>
<li>s&#x27;il y a n paramètres de sortie, l&#x27;un d&#x27;entre-eux peut servir de résultat de fonction , les n-1 autres restant des paramètres de sortie. On peut aussi ne pas utiliser de fonction mais une procédure à n paramètres de sortie. On peut également utiliser une fonction qui rendra un tableau dans lequel on aura placé les n valeurs à rendre au programme appelant. On se rappellera que le programme appelé rend ses résultats au programme appelant par recopie de valeurs. Cette recopie est évitée dans le cas de paramètres de sortie passés par référence. Il y a donc dans cette dernière solution un gain de temps.</li>
</ul>
<h2 id="54-le-programme-vbscript-de-tri-de-valeurs">5.4. Le programme Vbscript de tri de valeurs</h2>
<p>Nous avions commencé la discussion sur la programmation modulaire par l&#x27;étude algorithmique d&#x27;un tri de valeurs numériques tapées au clavier. Voici la traduction VBScript qui pourrait en être faite :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span>
<span class="normal"><a href="#__codelineno-20-24">24</a></span>
<span class="normal"><a href="#__codelineno-20-25">25</a></span>
<span class="normal"><a href="#__codelineno-20-26">26</a></span>
<span class="normal"><a href="#__codelineno-20-27">27</a></span>
<span class="normal"><a href="#__codelineno-20-28">28</a></span>
<span class="normal"><a href="#__codelineno-20-29">29</a></span>
<span class="normal"><a href="#__codelineno-20-30">30</a></span>
<span class="normal"><a href="#__codelineno-20-31">31</a></span>
<span class="normal"><a href="#__codelineno-20-32">32</a></span>
<span class="normal"><a href="#__codelineno-20-33">33</a></span>
<span class="normal"><a href="#__codelineno-20-34">34</a></span>
<span class="normal"><a href="#__codelineno-20-35">35</a></span>
<span class="normal"><a href="#__codelineno-20-36">36</a></span>
<span class="normal"><a href="#__codelineno-20-37">37</a></span>
<span class="normal"><a href="#__codelineno-20-38">38</a></span>
<span class="normal"><a href="#__codelineno-20-39">39</a></span>
<span class="normal"><a href="#__codelineno-20-40">40</a></span>
<span class="normal"><a href="#__codelineno-20-41">41</a></span>
<span class="normal"><a href="#__codelineno-20-42">42</a></span>
<span class="normal"><a href="#__codelineno-20-43">43</a></span>
<span class="normal"><a href="#__codelineno-20-44">44</a></span>
<span class="normal"><a href="#__codelineno-20-45">45</a></span>
<span class="normal"><a href="#__codelineno-20-46">46</a></span>
<span class="normal"><a href="#__codelineno-20-47">47</a></span>
<span class="normal"><a href="#__codelineno-20-48">48</a></span>
<span class="normal"><a href="#__codelineno-20-49">49</a></span>
<span class="normal"><a href="#__codelineno-20-50">50</a></span>
<span class="normal"><a href="#__codelineno-20-51">51</a></span>
<span class="normal"><a href="#__codelineno-20-52">52</a></span>
<span class="normal"><a href="#__codelineno-20-53">53</a></span>
<span class="normal"><a href="#__codelineno-20-54">54</a></span>
<span class="normal"><a href="#__codelineno-20-55">55</a></span>
<span class="normal"><a href="#__codelineno-20-56">56</a></span>
<span class="normal"><a href="#__codelineno-20-57">57</a></span>
<span class="normal"><a href="#__codelineno-20-58">58</a></span>
<span class="normal"><a href="#__codelineno-20-59">59</a></span>
<span class="normal"><a href="#__codelineno-20-60">60</a></span>
<span class="normal"><a href="#__codelineno-20-61">61</a></span>
<span class="normal"><a href="#__codelineno-20-62">62</a></span>
<span class="normal"><a href="#__codelineno-20-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="s1">&#39; programme principal</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="n">Option</span> <span class="n">Explicit</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="n">Dim</span> <span class="n">T</span>        <span class="s1">&#39; le tableau de valeurs à trier</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="s1">&#39; lecture des valeurs</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="n">T</span><span class="o">=</span><span class="n">lire_tableau</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="s1">&#39; tri des valeurs</span>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="n">trier_tableau</span> <span class="n">T</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="s1">&#39; affichage des valeurs triées</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="n">ecrire_tableau</span> <span class="n">T</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="s1">&#39; fin</span>
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="n">wscript</span><span class="o">.</span><span class="n">quit</span> <span class="mi">0</span>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="s1">&#39; ---------- fonctions &amp; procédures</span>
<a id="__codelineno-20-17" name="__codelineno-20-17"></a>
<a id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="s1">&#39; -------- lire_tableau</span>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="n">Function</span> <span class="n">lire_tableau</span>
<a id="__codelineno-20-20" name="__codelineno-20-20"></a>  <span class="s1">&#39; on demande les valeurs</span>
<a id="__codelineno-20-21" name="__codelineno-20-21"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span> <span class="s2">&quot;Tapez les valeurs à trier sous la forme val1 val2  ... valn : &quot;</span>
<a id="__codelineno-20-22" name="__codelineno-20-22"></a>  <span class="s1">&#39; on les lit</span>
<a id="__codelineno-20-23" name="__codelineno-20-23"></a>  <span class="n">Dim</span> <span class="n">valeurs</span>
<a id="__codelineno-20-24" name="__codelineno-20-24"></a>  <span class="n">valeurs</span><span class="o">=</span><span class="n">wscript</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readLine</span>
<a id="__codelineno-20-25" name="__codelineno-20-25"></a>  <span class="s1">&#39; on les met dans un tableau</span>
<a id="__codelineno-20-26" name="__codelineno-20-26"></a>  <span class="n">lire_tableau</span><span class="o">=</span><span class="n">split</span><span class="p">(</span><span class="n">valeurs</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-20-27" name="__codelineno-20-27"></a><span class="n">End</span> <span class="n">Function</span>
<a id="__codelineno-20-28" name="__codelineno-20-28"></a>
<a id="__codelineno-20-29" name="__codelineno-20-29"></a><span class="s1">&#39; -------- ecrire_tableau</span>
<a id="__codelineno-20-30" name="__codelineno-20-30"></a><span class="n">Sub</span> <span class="n">ecrire_tableau</span><span class="p">(</span><span class="n">byref</span> <span class="n">T</span><span class="p">)</span>
<a id="__codelineno-20-31" name="__codelineno-20-31"></a>  <span class="s1">&#39; affiche le contenu du tableau T</span>
<a id="__codelineno-20-32" name="__codelineno-20-32"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="n">join</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<a id="__codelineno-20-33" name="__codelineno-20-33"></a><span class="n">End</span> <span class="n">Sub</span>
<a id="__codelineno-20-34" name="__codelineno-20-34"></a>
<a id="__codelineno-20-35" name="__codelineno-20-35"></a><span class="s1">&#39; -------- trier_tableau</span>
<a id="__codelineno-20-36" name="__codelineno-20-36"></a><span class="n">Sub</span> <span class="n">trier_tableau</span> <span class="p">(</span><span class="n">byref</span> <span class="n">T</span><span class="p">)</span>
<a id="__codelineno-20-37" name="__codelineno-20-37"></a>  <span class="s1">&#39; tri le tableau T en ordre croissant</span>
<a id="__codelineno-20-38" name="__codelineno-20-38"></a>
<a id="__codelineno-20-39" name="__codelineno-20-39"></a>  <span class="s1">&#39; on cherche l&#39;</span><span class="n">indice</span> <span class="n">imax</span> <span class="n">du</span> <span class="n">tableau</span> <span class="n">T</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">ifin</span><span class="p">]</span>
<a id="__codelineno-20-40" name="__codelineno-20-40"></a>  <span class="s1">&#39; pour échanger T[imax] avec le dernier élément du tableau T[0..ifin]</span>
<a id="__codelineno-20-41" name="__codelineno-20-41"></a>  <span class="s1">&#39; ensuite on recommence avec un tableau ayant 1 élément de moins</span>
<a id="__codelineno-20-42" name="__codelineno-20-42"></a>
<a id="__codelineno-20-43" name="__codelineno-20-43"></a>  <span class="n">Dim</span> <span class="n">ifin</span><span class="p">,</span> <span class="n">imax</span><span class="p">,</span> <span class="n">temp</span>
<a id="__codelineno-20-44" name="__codelineno-20-44"></a>  <span class="n">For</span> <span class="n">ifin</span><span class="o">=</span><span class="n">ubound</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="n">To</span> <span class="mi">1</span> <span class="n">Step</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-20-45" name="__codelineno-20-45"></a>    <span class="s1">&#39; on cherche l&#39;</span><span class="n">indice</span> <span class="n">imax</span> <span class="n">du</span> <span class="n">tableau</span> <span class="n">T</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">ifin</span><span class="p">]</span>
<a id="__codelineno-20-46" name="__codelineno-20-46"></a>    <span class="n">imax</span><span class="o">=</span><span class="n">chercher_max</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">ifin</span><span class="p">)</span>
<a id="__codelineno-20-47" name="__codelineno-20-47"></a>    <span class="s1">&#39; on l&#39;</span><span class="n">échange</span> <span class="n">le</span> <span class="nb">max</span> <span class="n">avec</span> <span class="n">le</span> <span class="n">dernier</span> <span class="n">élément</span> <span class="n">du</span> <span class="n">tableau</span> <span class="n">T</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">ifin</span><span class="p">]</span>
<a id="__codelineno-20-48" name="__codelineno-20-48"></a>    <span class="n">temp</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="n">ifin</span><span class="p">):</span><span class="n">T</span><span class="p">(</span><span class="n">ifin</span><span class="p">)</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="n">imax</span><span class="p">):</span><span class="n">T</span><span class="p">(</span><span class="n">imax</span><span class="p">)</span><span class="o">=</span><span class="n">temp</span>
<a id="__codelineno-20-49" name="__codelineno-20-49"></a>  <span class="n">Next</span>
<a id="__codelineno-20-50" name="__codelineno-20-50"></a><span class="n">End</span> <span class="n">Sub</span>
<a id="__codelineno-20-51" name="__codelineno-20-51"></a>
<a id="__codelineno-20-52" name="__codelineno-20-52"></a><span class="s1">&#39; -------- chercher_max</span>
<a id="__codelineno-20-53" name="__codelineno-20-53"></a><span class="n">Function</span> <span class="n">chercher_max</span><span class="p">(</span><span class="n">byRef</span> <span class="n">T</span><span class="p">,</span> <span class="n">ByVal</span> <span class="n">ifin</span><span class="p">)</span>
<a id="__codelineno-20-54" name="__codelineno-20-54"></a>  <span class="s1">&#39; on cherche l&#39;</span><span class="n">indice</span> <span class="n">imax</span> <span class="n">du</span> <span class="n">tableau</span> <span class="n">T</span><span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="n">ifin</span><span class="p">]</span>
<a id="__codelineno-20-55" name="__codelineno-20-55"></a>  <span class="n">Dim</span> <span class="n">i</span><span class="p">,</span> <span class="n">imax</span>
<a id="__codelineno-20-56" name="__codelineno-20-56"></a>  <span class="n">imax</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-20-57" name="__codelineno-20-57"></a>  <span class="n">For</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span> <span class="n">To</span> <span class="n">ifin</span>
<a id="__codelineno-20-58" name="__codelineno-20-58"></a>    <span class="n">If</span> <span class="n">cdbl</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">&gt;</span><span class="n">cdbl</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">imax</span><span class="p">))</span> <span class="n">Then</span> <span class="n">imax</span><span class="o">=</span><span class="n">i</span>
<a id="__codelineno-20-59" name="__codelineno-20-59"></a>  <span class="n">Next</span>
<a id="__codelineno-20-60" name="__codelineno-20-60"></a>
<a id="__codelineno-20-61" name="__codelineno-20-61"></a>  <span class="s1">&#39; On rend le résultat</span>
<a id="__codelineno-20-62" name="__codelineno-20-62"></a>  <span class="n">chercher_max</span><span class="o">=</span><span class="n">imax</span>
<a id="__codelineno-20-63" name="__codelineno-20-63"></a><span class="n">End</span> <span class="n">Function</span>
</code></pre></div></td></tr></table></div>
</div></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="n">Tapez</span> <span class="n">les</span> <span class="n">valeurs</span> <span class="n">à</span> <span class="n">trier</span> <span class="n">sous</span> <span class="n">la</span> <span class="n">forme</span> <span class="n">val1</span> <span class="n">val2</span>  <span class="o">...</span> <span class="n">valn</span> <span class="p">:</span> <span class="mi">10</span> <span class="mi">9</span> <span class="mi">8</span> <span class="mi">7</span> <span class="mi">6</span> <span class="mi">1</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="mi">1</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span>
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Commentaires :</p>
<ul>
<li>le module échanger qui avait été identifié dans l&#x27;algorithme initial n&#x27;a pas fait ici l&#x27;objet d&#x27;un module en vbscript parce que jugé trop simple pour faire l&#x27;objet d&#x27;un module particulier.</li>
</ul>
<h2 id="55-le-programme-impots-sous-forme-modulaire">5.5. Le programme IMPOTS sous forme modulaire</h2>
<p>Nous reprenons le programme de calcul de l&#x27;impôt écrit cette fois sous forme modulaire</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">  1</a></span>
<span class="normal"><a href="#__codelineno-22-2">  2</a></span>
<span class="normal"><a href="#__codelineno-22-3">  3</a></span>
<span class="normal"><a href="#__codelineno-22-4">  4</a></span>
<span class="normal"><a href="#__codelineno-22-5">  5</a></span>
<span class="normal"><a href="#__codelineno-22-6">  6</a></span>
<span class="normal"><a href="#__codelineno-22-7">  7</a></span>
<span class="normal"><a href="#__codelineno-22-8">  8</a></span>
<span class="normal"><a href="#__codelineno-22-9">  9</a></span>
<span class="normal"><a href="#__codelineno-22-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-22-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-22-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-22-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-22-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-22-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-22-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-22-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-22-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-22-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-22-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-22-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-22-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-22-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-22-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-22-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-22-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-22-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-22-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-22-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-22-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-22-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-22-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-22-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-22-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-22-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-22-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-22-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-22-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-22-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-22-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-22-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-22-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-22-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-22-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-22-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-22-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-22-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-22-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-22-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-22-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-22-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-22-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-22-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-22-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-22-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-22-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-22-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-22-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-22-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-22-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-22-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-22-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-22-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-22-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-22-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-22-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-22-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-22-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-22-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-22-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-22-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-22-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-22-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-22-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-22-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-22-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-22-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-22-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-22-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-22-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-22-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-22-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-22-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-22-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-22-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-22-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-22-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-22-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-22-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-22-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-22-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-22-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-22-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-22-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-22-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-22-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-22-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-22-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-22-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-22-100">100</a></span>
<span class="normal"><a href="#__codelineno-22-101">101</a></span>
<span class="normal"><a href="#__codelineno-22-102">102</a></span>
<span class="normal"><a href="#__codelineno-22-103">103</a></span>
<span class="normal"><a href="#__codelineno-22-104">104</a></span>
<span class="normal"><a href="#__codelineno-22-105">105</a></span>
<span class="normal"><a href="#__codelineno-22-106">106</a></span>
<span class="normal"><a href="#__codelineno-22-107">107</a></span>
<span class="normal"><a href="#__codelineno-22-108">108</a></span>
<span class="normal"><a href="#__codelineno-22-109">109</a></span>
<span class="normal"><a href="#__codelineno-22-110">110</a></span>
<span class="normal"><a href="#__codelineno-22-111">111</a></span>
<span class="normal"><a href="#__codelineno-22-112">112</a></span>
<span class="normal"><a href="#__codelineno-22-113">113</a></span>
<span class="normal"><a href="#__codelineno-22-114">114</a></span>
<span class="normal"><a href="#__codelineno-22-115">115</a></span>
<span class="normal"><a href="#__codelineno-22-116">116</a></span>
<span class="normal"><a href="#__codelineno-22-117">117</a></span>
<span class="normal"><a href="#__codelineno-22-118">118</a></span>
<span class="normal"><a href="#__codelineno-22-119">119</a></span>
<span class="normal"><a href="#__codelineno-22-120">120</a></span>
<span class="normal"><a href="#__codelineno-22-121">121</a></span>
<span class="normal"><a href="#__codelineno-22-122">122</a></span>
<span class="normal"><a href="#__codelineno-22-123">123</a></span>
<span class="normal"><a href="#__codelineno-22-124">124</a></span>
<span class="normal"><a href="#__codelineno-22-125">125</a></span>
<span class="normal"><a href="#__codelineno-22-126">126</a></span>
<span class="normal"><a href="#__codelineno-22-127">127</a></span>
<span class="normal"><a href="#__codelineno-22-128">128</a></span>
<span class="normal"><a href="#__codelineno-22-129">129</a></span>
<span class="normal"><a href="#__codelineno-22-130">130</a></span>
<span class="normal"><a href="#__codelineno-22-131">131</a></span>
<span class="normal"><a href="#__codelineno-22-132">132</a></span>
<span class="normal"><a href="#__codelineno-22-133">133</a></span>
<span class="normal"><a href="#__codelineno-22-134">134</a></span>
<span class="normal"><a href="#__codelineno-22-135">135</a></span>
<span class="normal"><a href="#__codelineno-22-136">136</a></span>
<span class="normal"><a href="#__codelineno-22-137">137</a></span>
<span class="normal"><a href="#__codelineno-22-138">138</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="s1">&#39; calcul de l&#39;</span><span class="n">impôt</span> <span class="n">d</span><span class="s1">&#39;un contribuable</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="s1">&#39; le programme doit être appelé avec trois paramètres : marié enfants salaire</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="s1">&#39; marié : caractère O si marié, N si non marié</span>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="s1">&#39; enfants : nombre d&#39;</span><span class="n">enfants</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="s1">&#39; salaire : salaire annuel sans les centimes</span>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="s1">&#39; déclaration obligatoire des variables</span>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a>  <span class="n">Option</span> <span class="n">Explicit</span>
<a id="__codelineno-22-9" name="__codelineno-22-9"></a>  <span class="n">Dim</span> <span class="n">erreur</span>
<a id="__codelineno-22-10" name="__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="s1">&#39; on récupère les arguments en vérifiant leur validité</span>
<a id="__codelineno-22-12" name="__codelineno-22-12"></a>  <span class="n">Dim</span> <span class="n">marie</span><span class="p">,</span> <span class="n">enfants</span><span class="p">,</span> <span class="n">salaire</span>
<a id="__codelineno-22-13" name="__codelineno-22-13"></a>  <span class="n">erreur</span><span class="o">=</span><span class="n">getArguments</span><span class="p">(</span><span class="n">marie</span><span class="p">,</span><span class="n">enfants</span><span class="p">,</span><span class="n">salaire</span><span class="p">)</span>
<a id="__codelineno-22-14" name="__codelineno-22-14"></a>  <span class="s1">&#39; erreur ?</span>
<a id="__codelineno-22-15" name="__codelineno-22-15"></a>  <span class="n">If</span> <span class="n">erreur</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">&lt;&gt;</span><span class="mi">0</span> <span class="n">Then</span> <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="n">erreur</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="n">wscript</span><span class="o">.</span><span class="n">quit</span> <span class="n">erreur</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-22-16" name="__codelineno-22-16"></a>
<a id="__codelineno-22-17" name="__codelineno-22-17"></a><span class="s1">&#39; on récupère les données nécessaires au calcul de l&#39;</span><span class="n">impôt</span>
<a id="__codelineno-22-18" name="__codelineno-22-18"></a>  <span class="n">Dim</span> <span class="n">limites</span><span class="p">,</span> <span class="n">coeffR</span><span class="p">,</span> <span class="n">coeffN</span>
<a id="__codelineno-22-19" name="__codelineno-22-19"></a>  <span class="n">getData</span> <span class="n">limites</span><span class="p">,</span><span class="n">coeffR</span><span class="p">,</span><span class="n">coeffN</span>
<a id="__codelineno-22-20" name="__codelineno-22-20"></a>
<a id="__codelineno-22-21" name="__codelineno-22-21"></a>  <span class="s1">&#39; on affiche le résultat</span>
<a id="__codelineno-22-22" name="__codelineno-22-22"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">echo</span> <span class="s2">&quot;impôt=&quot;</span> <span class="o">&amp;</span> <span class="n">calculerImpot</span><span class="p">(</span><span class="n">marie</span><span class="p">,</span><span class="n">enfants</span><span class="p">,</span><span class="n">salaire</span><span class="p">,</span><span class="n">limites</span><span class="p">,</span><span class="n">coeffR</span><span class="p">,</span><span class="n">coeffN</span><span class="p">)</span>
<a id="__codelineno-22-23" name="__codelineno-22-23"></a>
<a id="__codelineno-22-24" name="__codelineno-22-24"></a>  <span class="s1">&#39; on quitte sans erreur</span>
<a id="__codelineno-22-25" name="__codelineno-22-25"></a>  <span class="n">wscript</span><span class="o">.</span><span class="n">quit</span> <span class="mi">0</span>
<a id="__codelineno-22-26" name="__codelineno-22-26"></a>
<a id="__codelineno-22-27" name="__codelineno-22-27"></a><span class="s1">&#39; ------------ fonctions et procédures</span>
<a id="__codelineno-22-28" name="__codelineno-22-28"></a>
<a id="__codelineno-22-29" name="__codelineno-22-29"></a><span class="s1">&#39; ----------- getArguments</span>
<a id="__codelineno-22-30" name="__codelineno-22-30"></a><span class="n">Function</span> <span class="n">getArguments</span><span class="p">(</span><span class="n">byref</span> <span class="n">marie</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">enfants</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">salaire</span><span class="p">)</span>
<a id="__codelineno-22-31" name="__codelineno-22-31"></a>  <span class="s1">&#39; doit récupérer trois valeurs passées comme argument au programme principal</span>
<a id="__codelineno-22-32" name="__codelineno-22-32"></a>  <span class="s1">&#39; un argument est transmis au programme sans espaces devant et derrière</span>
<a id="__codelineno-22-33" name="__codelineno-22-33"></a>  <span class="s1">&#39; on utilisera des expression régulières pour vérifier la validité des données</span>
<a id="__codelineno-22-34" name="__codelineno-22-34"></a>
<a id="__codelineno-22-35" name="__codelineno-22-35"></a>  <span class="s1">&#39; rend un variant tableau erreur à 2 valeurs</span>
<a id="__codelineno-22-36" name="__codelineno-22-36"></a>  <span class="s1">&#39; erreur(0) : code d&#39;</span><span class="n">erreur</span><span class="p">,</span> <span class="mi">0</span> <span class="n">si</span> <span class="n">pas</span> <span class="n">d</span><span class="s1">&#39;erreur</span>
<a id="__codelineno-22-37" name="__codelineno-22-37"></a>  <span class="s1">&#39; erreur(1) : message d&#39;</span><span class="n">erreur</span> <span class="n">si</span> <span class="n">erreur</span> <span class="n">sinon</span> <span class="n">la</span> <span class="n">chaîne</span> <span class="n">vide</span>
<a id="__codelineno-22-38" name="__codelineno-22-38"></a>
<a id="__codelineno-22-39" name="__codelineno-22-39"></a>  <span class="n">Dim</span> <span class="n">syntaxe</span>
<a id="__codelineno-22-40" name="__codelineno-22-40"></a>  <span class="n">syntaxe</span><span class="o">=</span> <span class="n">_</span>
<a id="__codelineno-22-41" name="__codelineno-22-41"></a>    <span class="s2">&quot;Syntaxe : pg marié enfants salaire&quot;</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="n">_</span>
<a id="__codelineno-22-42" name="__codelineno-22-42"></a>    <span class="s2">&quot;marié : caractère O si marié, N si non marié&quot;</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="n">_</span>
<a id="__codelineno-22-43" name="__codelineno-22-43"></a>    <span class="s2">&quot;enfants : nombre d&#39;enfants (entier &gt;=0)&quot;</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="n">_</span>
<a id="__codelineno-22-44" name="__codelineno-22-44"></a>    <span class="s2">&quot;salaire : salaire annuel sans les centimes (entier &gt;=0)&quot;</span>
<a id="__codelineno-22-45" name="__codelineno-22-45"></a>
<a id="__codelineno-22-46" name="__codelineno-22-46"></a><span class="s1">&#39; on vérifie qu&#39;</span><span class="n">il</span> <span class="n">y</span> <span class="n">a</span> <span class="mi">3</span> <span class="n">arguments</span>
<a id="__codelineno-22-47" name="__codelineno-22-47"></a>  <span class="n">Dim</span> <span class="n">nbArguments</span>
<a id="__codelineno-22-48" name="__codelineno-22-48"></a>  <span class="n">nbArguments</span><span class="o">=</span><span class="n">wscript</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">count</span>
<a id="__codelineno-22-49" name="__codelineno-22-49"></a>  <span class="n">If</span> <span class="n">nbArguments</span><span class="o">&lt;&gt;</span><span class="mi">3</span> <span class="n">Then</span>
<a id="__codelineno-22-50" name="__codelineno-22-50"></a>    <span class="s1">&#39; msg d&#39;</span><span class="n">erreur</span>
<a id="__codelineno-22-51" name="__codelineno-22-51"></a>    <span class="n">getArguments</span><span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">syntaxe</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="s2">&quot;erreur : nombre d&#39;arguments incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-22-52" name="__codelineno-22-52"></a>    <span class="s1">&#39; fin</span>
<a id="__codelineno-22-53" name="__codelineno-22-53"></a>    <span class="n">Exit</span> <span class="n">Function</span>
<a id="__codelineno-22-54" name="__codelineno-22-54"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-22-55" name="__codelineno-22-55"></a>
<a id="__codelineno-22-56" name="__codelineno-22-56"></a>  <span class="n">Dim</span> <span class="n">modele</span><span class="p">,</span> <span class="n">correspondances</span>
<a id="__codelineno-22-57" name="__codelineno-22-57"></a>  <span class="n">Set</span> <span class="n">modele</span><span class="o">=</span><span class="n">new</span> <span class="n">regexp</span>
<a id="__codelineno-22-58" name="__codelineno-22-58"></a>
<a id="__codelineno-22-59" name="__codelineno-22-59"></a>  <span class="s1">&#39; le statut marital doit être parmi les caractères oOnN</span>
<a id="__codelineno-22-60" name="__codelineno-22-60"></a>  <span class="n">modele</span><span class="o">.</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;^[oOnN]$&quot;</span>
<a id="__codelineno-22-61" name="__codelineno-22-61"></a>  <span class="n">Set</span> <span class="n">correspondances</span><span class="o">=</span><span class="n">modele</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">wscript</span><span class="o">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-22-62" name="__codelineno-22-62"></a>  <span class="n">If</span> <span class="n">correspondances</span><span class="o">.</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span> <span class="n">Then</span>
<a id="__codelineno-22-63" name="__codelineno-22-63"></a>    <span class="s1">&#39; msg d&#39;</span><span class="n">erreur</span>
<a id="__codelineno-22-64" name="__codelineno-22-64"></a>    <span class="n">getArguments</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">syntaxe</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="s2">&quot;erreur : argument marie incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-22-65" name="__codelineno-22-65"></a>    <span class="s1">&#39; on quitte</span>
<a id="__codelineno-22-66" name="__codelineno-22-66"></a>    <span class="n">Exit</span> <span class="n">Function</span>
<a id="__codelineno-22-67" name="__codelineno-22-67"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-22-68" name="__codelineno-22-68"></a>  <span class="s1">&#39; on récupère la valeur</span>
<a id="__codelineno-22-69" name="__codelineno-22-69"></a>  <span class="n">If</span> <span class="n">lcase</span><span class="p">(</span><span class="n">wscript</span><span class="o">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="n">Then</span>
<a id="__codelineno-22-70" name="__codelineno-22-70"></a>    <span class="n">marie</span><span class="o">=</span><span class="n">true</span>
<a id="__codelineno-22-71" name="__codelineno-22-71"></a>  <span class="n">Else</span>
<a id="__codelineno-22-72" name="__codelineno-22-72"></a>    <span class="n">marie</span><span class="o">=</span><span class="n">false</span>
<a id="__codelineno-22-73" name="__codelineno-22-73"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-22-74" name="__codelineno-22-74"></a>
<a id="__codelineno-22-75" name="__codelineno-22-75"></a>  <span class="s1">&#39; enfants doit être un nombre entier &gt;=0</span>
<a id="__codelineno-22-76" name="__codelineno-22-76"></a>  <span class="n">modele</span><span class="o">.</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;^\d{1,2}$&quot;</span>
<a id="__codelineno-22-77" name="__codelineno-22-77"></a>  <span class="n">Set</span> <span class="n">correspondances</span><span class="o">=</span><span class="n">modele</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">wscript</span><span class="o">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-22-78" name="__codelineno-22-78"></a>  <span class="n">If</span> <span class="n">correspondances</span><span class="o">.</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span> <span class="n">Then</span>
<a id="__codelineno-22-79" name="__codelineno-22-79"></a>    <span class="s1">&#39; erreur</span>
<a id="__codelineno-22-80" name="__codelineno-22-80"></a>    <span class="n">getArguments</span><span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">syntaxe</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="s2">&quot;erreur : argument enfants incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-22-81" name="__codelineno-22-81"></a>    <span class="s1">&#39; on quitte</span>
<a id="__codelineno-22-82" name="__codelineno-22-82"></a>    <span class="n">Exit</span> <span class="n">Function</span>
<a id="__codelineno-22-83" name="__codelineno-22-83"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-22-84" name="__codelineno-22-84"></a>  <span class="s1">&#39; on récupère la valeur</span>
<a id="__codelineno-22-85" name="__codelineno-22-85"></a>  <span class="n">enfants</span><span class="o">=</span><span class="n">cint</span><span class="p">(</span><span class="n">wscript</span><span class="o">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-22-86" name="__codelineno-22-86"></a>
<a id="__codelineno-22-87" name="__codelineno-22-87"></a>  <span class="s1">&#39; salaire doit être un entier &gt;=0</span>
<a id="__codelineno-22-88" name="__codelineno-22-88"></a>  <span class="n">modele</span><span class="o">.</span><span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;^\d{1,9}$&quot;</span>
<a id="__codelineno-22-89" name="__codelineno-22-89"></a>  <span class="n">Set</span> <span class="n">correspondances</span><span class="o">=</span><span class="n">modele</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">wscript</span><span class="o">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-22-90" name="__codelineno-22-90"></a>  <span class="n">If</span> <span class="n">correspondances</span><span class="o">.</span><span class="n">count</span><span class="o">=</span><span class="mi">0</span> <span class="n">Then</span>
<a id="__codelineno-22-91" name="__codelineno-22-91"></a>    <span class="s1">&#39; erreur</span>
<a id="__codelineno-22-92" name="__codelineno-22-92"></a>    <span class="n">getArguments</span><span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">syntaxe</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="n">vbCRLF</span> <span class="o">&amp;</span> <span class="s2">&quot;erreur : argument salaire incorrect&quot;</span><span class="p">)</span>
<a id="__codelineno-22-93" name="__codelineno-22-93"></a>    <span class="s1">&#39; on quitte</span>
<a id="__codelineno-22-94" name="__codelineno-22-94"></a>    <span class="n">Exit</span> <span class="n">Function</span>
<a id="__codelineno-22-95" name="__codelineno-22-95"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-22-96" name="__codelineno-22-96"></a>  <span class="s1">&#39; on récupère la valeur</span>
<a id="__codelineno-22-97" name="__codelineno-22-97"></a>  <span class="n">salaire</span><span class="o">=</span><span class="n">clng</span><span class="p">(</span><span class="n">wscript</span><span class="o">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-22-98" name="__codelineno-22-98"></a>
<a id="__codelineno-22-99" name="__codelineno-22-99"></a>  <span class="s1">&#39; c&#39;</span><span class="n">est</span> <span class="n">fini</span> <span class="n">sans</span> <span class="n">erreur</span>
<a id="__codelineno-22-100" name="__codelineno-22-100"></a>  <span class="n">getArguments</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-22-101" name="__codelineno-22-101"></a><span class="n">End</span> <span class="n">Function</span>
<a id="__codelineno-22-102" name="__codelineno-22-102"></a>
<a id="__codelineno-22-103" name="__codelineno-22-103"></a><span class="s1">&#39; ----------- getData</span>
<a id="__codelineno-22-104" name="__codelineno-22-104"></a><span class="n">Sub</span> <span class="n">getData</span><span class="p">(</span><span class="n">byref</span> <span class="n">limites</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">coeffR</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">coeffN</span><span class="p">)</span>  
<a id="__codelineno-22-105" name="__codelineno-22-105"></a>  <span class="s1">&#39; on définit les données nécessaire au calcul de l&#39;</span><span class="n">impôt</span> <span class="n">dans</span> <span class="mi">3</span> <span class="n">tableaux</span>
<a id="__codelineno-22-106" name="__codelineno-22-106"></a>  <span class="n">limites</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="mi">12620</span><span class="p">,</span><span class="mi">13190</span><span class="p">,</span><span class="mi">15640</span><span class="p">,</span><span class="mi">24740</span><span class="p">,</span><span class="mi">31810</span><span class="p">,</span><span class="mi">39970</span><span class="p">,</span><span class="mi">48360</span><span class="p">,</span> <span class="n">_</span>
<a id="__codelineno-22-107" name="__codelineno-22-107"></a>    <span class="mi">55790</span><span class="p">,</span><span class="mi">92970</span><span class="p">,</span><span class="mi">127860</span><span class="p">,</span><span class="mi">151250</span><span class="p">,</span><span class="mi">172040</span><span class="p">,</span><span class="mi">195000</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-22-108" name="__codelineno-22-108"></a>  <span class="n">coeffr</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">_</span>
<a id="__codelineno-22-109" name="__codelineno-22-109"></a>    <span class="mf">0.5</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.65</span><span class="p">)</span>
<a id="__codelineno-22-110" name="__codelineno-22-110"></a>  <span class="n">coeffn</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">631</span><span class="p">,</span><span class="mf">1290.5</span><span class="p">,</span><span class="mf">2072.5</span><span class="p">,</span><span class="mf">3309.5</span><span class="p">,</span><span class="mi">4900</span><span class="p">,</span><span class="mf">6898.5</span><span class="p">,</span><span class="mf">9316.5</span><span class="p">,</span> <span class="n">_</span>
<a id="__codelineno-22-111" name="__codelineno-22-111"></a>    <span class="mi">12106</span><span class="p">,</span><span class="mf">16754.5</span><span class="p">,</span><span class="mf">23147.5</span><span class="p">,</span><span class="mi">30710</span><span class="p">,</span><span class="mi">39312</span><span class="p">,</span><span class="mi">49062</span><span class="p">)</span>
<a id="__codelineno-22-112" name="__codelineno-22-112"></a><span class="n">End</span> <span class="n">Sub</span>
<a id="__codelineno-22-113" name="__codelineno-22-113"></a>
<a id="__codelineno-22-114" name="__codelineno-22-114"></a><span class="s1">&#39; ----------- calculerImpot</span>
<a id="__codelineno-22-115" name="__codelineno-22-115"></a><span class="n">Function</span> <span class="n">calculerImpot</span><span class="p">(</span><span class="n">byval</span> <span class="n">marie</span><span class="p">,</span><span class="n">ByVal</span> <span class="n">enfants</span><span class="p">,</span><span class="n">ByVal</span> <span class="n">salaire</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">limites</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">coeffR</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">coeffN</span><span class="p">)</span>
<a id="__codelineno-22-116" name="__codelineno-22-116"></a>
<a id="__codelineno-22-117" name="__codelineno-22-117"></a>  <span class="s1">&#39; on calcule le nombre de parts</span>
<a id="__codelineno-22-118" name="__codelineno-22-118"></a>  <span class="n">Dim</span> <span class="n">nbParts</span>
<a id="__codelineno-22-119" name="__codelineno-22-119"></a>  <span class="n">If</span> <span class="n">marie</span><span class="o">=</span><span class="n">true</span> <span class="n">Then</span>
<a id="__codelineno-22-120" name="__codelineno-22-120"></a>    <span class="n">nbParts</span><span class="o">=</span><span class="p">(</span><span class="n">enfants</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>
<a id="__codelineno-22-121" name="__codelineno-22-121"></a>  <span class="n">Else</span>
<a id="__codelineno-22-122" name="__codelineno-22-122"></a>    <span class="n">nbParts</span><span class="o">=</span><span class="p">(</span><span class="n">enfants</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-22-123" name="__codelineno-22-123"></a>  <span class="n">End</span> <span class="n">If</span>
<a id="__codelineno-22-124" name="__codelineno-22-124"></a>  <span class="n">If</span> <span class="n">enfants</span><span class="o">&gt;=</span><span class="mi">3</span> <span class="n">Then</span> <span class="n">nbParts</span><span class="o">=</span><span class="n">nbParts</span><span class="o">+</span><span class="mf">0.5</span>
<a id="__codelineno-22-125" name="__codelineno-22-125"></a>
<a id="__codelineno-22-126" name="__codelineno-22-126"></a>  <span class="s1">&#39; on calcule le quotient familial et le revenu imposable</span>
<a id="__codelineno-22-127" name="__codelineno-22-127"></a>  <span class="n">Dim</span> <span class="n">revenu</span><span class="p">,</span> <span class="n">qf</span>
<a id="__codelineno-22-128" name="__codelineno-22-128"></a>  <span class="n">revenu</span><span class="o">=</span><span class="mf">0.72</span><span class="o">*</span><span class="n">salaire</span>
<a id="__codelineno-22-129" name="__codelineno-22-129"></a>  <span class="n">qf</span><span class="o">=</span><span class="n">revenu</span><span class="o">/</span><span class="n">nbParts</span>
<a id="__codelineno-22-130" name="__codelineno-22-130"></a>
<a id="__codelineno-22-131" name="__codelineno-22-131"></a>  <span class="s1">&#39; on calcule l&#39;</span><span class="n">impôt</span>
<a id="__codelineno-22-132" name="__codelineno-22-132"></a>  <span class="n">Dim</span> <span class="n">i</span><span class="p">,</span> <span class="n">impot</span>
<a id="__codelineno-22-133" name="__codelineno-22-133"></a>  <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-22-134" name="__codelineno-22-134"></a>  <span class="n">Do</span> <span class="n">While</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">ubound</span><span class="p">(</span><span class="n">limites</span><span class="p">)</span> <span class="n">And</span> <span class="n">qf</span><span class="o">&gt;</span><span class="n">limites</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-22-135" name="__codelineno-22-135"></a>    <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-22-136" name="__codelineno-22-136"></a>  <span class="n">Loop</span>
<a id="__codelineno-22-137" name="__codelineno-22-137"></a>  <span class="n">calculerImpot</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">revenu</span><span class="o">*</span><span class="n">coeffr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">nbParts</span><span class="o">*</span><span class="n">coeffn</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-22-138" name="__codelineno-22-138"></a><span class="n">End</span> <span class="n">Function</span>
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p><strong>Commentaires</strong></p>
<ul>
<li>la fonction <strong>getArguments</strong> permet de récupérer les informations (marie, enfants, salaire) du contribuable. Ici, elles sont passées en arguments au programme vbscript. Si cela devait changer, par exemple si ces arguments venaient d&#x27;une interface graphique, seule la procédure getArguments devrait être réécrite et pas les autres.</li>
<li>la fonction getArguments peut détecter des erreurs sur les arguments. Lorsque ceci se produit, on aurait pu décider d&#x27;arrêter l&#x27;exécution du programme dans la fonction getArguments par une instruction wscript.quit. Ceci ne doit jamais être fait dans une fonction ou procédure. Si une fonction ou procédure détecte une erreur, elle doit le signaler d&#x27;une façon ou d&#x27;une autre au programme appelant. C&#x27;est à lui de prendre la décision d&#x27;arrêter l&#x27;exécution ou non, pas à la procédure. Dans notre exemple, le programme appelant pourrait décider de redemander à l&#x27;utilisateur de retaper la donnée erronée au clavier plutôt que d&#x27;arrêter l&#x27;exécution.</li>
<li>ici, la fonction getArguments rend un variant tableau où le 1er élément est un code d&#x27;erreur (0 si pas d&#x27;erreur) et le second un message d&#x27;erreur si il y a eu erreur. En testant le résultat obtenu, le programme appelant peut savoir s&#x27;il y a eu erreur ou non.</li>
<li>la procédure <strong>getData</strong> permet d&#x27;obtenir les données nécessaires au calcul de l&#x27;impôt. Ici elles sont directement définies dans la procédure getData. Si ces données devaient provenir d&#x27;une autre source, d&#x27;un fichier ou d&#x27;une base de données par exemple, seule la procédure getData devrait être réécrite et pas les autres.</li>
<li>la fonction <strong>calculerImpot</strong> permet de calculer l&#x27;impôt une fois que toutes les données ont été obtenues quelque soit la façon dont elles ont été obtenues.</li>
<li>on notera donc qu&#x27;une écriture modulaire permet une (ré)utilisation de certains modules dans différents contextes. Ce concept a été dans les vingt dernières années fortement développé dans le concept d&#x27;objet.</li>
</ul>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner">

      <div>
        <a href="https://tahe.developpez.com" target="_blank">
          https://tahe.developpez.com
        </a>
        <br>
        Ce cours tutoriel écrit par <strong>Serge Tahé</strong> est mis à disposition du public selon les termes de la
        <em>Licence Creative Commons Attribution – Pas d’Utilisation Commerciale –
        Partage dans les Mêmes Conditions 3.0 non transposé</em>.
      </div>

    </div>
  </div>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["navigation.sections", "navigation.indexes", "toc.integrate", "navigation.top"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="javascripts/focus.js"></script>
      
    
  </body>
</html>