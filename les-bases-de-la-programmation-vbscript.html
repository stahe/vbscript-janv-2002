
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Introduction au langage VBScript">
      
      
        <meta name="author" content="Serge Tahé">
      
      
        <link rel="canonical" href="https://stahe.github.io/vbscript-janv-2002/les-bases-de-la-programmation-vbscript.html">
      
      
        <link rel="prev" href="les-contextes-dx27execution-de-vbscript.html">
      
      
        <link rel="next" href="la-gestion-des-erreurs.html">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>3. Les bases de la programmation VBSCRIPT - Introduction au langage VBScript</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/focus.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-EBZC3JVJNR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    var siteName = "Introduction au langage VBScript";
    gtag('config', 'G-EBZC3JVJNR', {
        'page_title': siteName
    });
  </script>

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#3-les-bases-de-la-programmation-vbscript" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Introduction au langage VBScript" class="md-header__button md-logo" aria-label="Introduction au langage VBScript" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction au langage VBScript
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3. Les bases de la programmation VBSCRIPT
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/stahe/vbscript-janv-2002" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Introduction au langage VBScript" class="md-nav__button md-logo" aria-label="Introduction au langage VBScript" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Introduction au langage VBScript
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stahe/vbscript-janv-2002" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-contextes-dx27execution-de-vbscript.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Les contextes d&#x27;exécution de VBSCRIPT
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    3. Les bases de la programmation VBSCRIPT
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="les-bases-de-la-programmation-vbscript.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Les bases de la programmation VBSCRIPT
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31-afficher-des-informations" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1. Afficher des informations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-ecriture-des-instructions-dans-un-script-vbscript" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2. Ecriture des instructions dans un script Vbscript
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-ecrire-avec-la-fonction-msgbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3. Écrire avec la fonction msgBox
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-les-donnees-utilisables-en-vbscript" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4. Les données utilisables en Vbscript
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-les-sous-types-du-type-variant" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5. Les sous-types du type variant
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-connaitre-le-type-exact-de-la-donnee-contenue-dans-un-variant" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.6. Connaître le type exact de la donnée contenue dans un variant
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37-declarer-les-variables-utilisees-par-le-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.7. Déclarer les variables utilisées par le script
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-les-fonctions-de-conversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.8. Les fonctions de conversion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39-lire-des-donnees-tapees-au-clavier" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.9. Lire des données tapées au clavier
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#310-saisir-des-donnees-avec-la-fonction-inputbox" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.10. Saisir des données avec la fonction inputbox
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#311-utiliser-des-objets-structures" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.11. Utiliser des objets structurés
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#312-affecter-une-valeur-a-une-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.12. Affecter une valeur à une variable
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#313-evaluer-des-expressions" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.13. Évaluer des expressions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#314-controler-lexecution-du-programme" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.14. Contrôler l&#x27;exécution du programme
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.14. Contrôler l&#39;exécution du programme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3141-executer-des-actions-de-facon-conditionnelle" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.14.1. Exécuter des actions de façon conditionnelle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3142-executer-des-actions-de-facon-repetee" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.14.2. Exécuter des actions de façon répétée
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3143-terminer-lexecution-du-programme" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.14.3. Terminer l&#x27;exécution du programme
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#315-les-tableaux-de-donnees-dans-un-variant" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.15. Les tableaux de données dans un variant
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#316-les-variables-tableaux" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.16. Les variables tableaux
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#317-les-fonctions-split-et-join" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.17. Les fonctions split et join
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#318-les-dictionnaires" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.18. Les dictionnaires
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#319-trier-un-tableau-ou-un-dictionnaire" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.19. Trier un tableau ou un dictionnaire
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#320-les-arguments-dun-programme" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.20. Les arguments d&#x27;un programme
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#321-une-premiere-application-impots" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.21. Une première application : IMPOTS
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="la-gestion-des-erreurs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. La gestion des erreurs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fonctions-et-procedures.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Les fonctions et procédures
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fichiers-texte.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Les fichiers texte
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="3-les-bases-de-la-programmation-vbscript">3. Les bases de la programmation VBSCRIPT</h1>
<p>Après avoir décrit les contextes d&#x27;exécution possibles pour un script vbscript, nous abordons maintenant le langage lui-même. Dans toute la suite, nous nous plaçons dans les conditions suivantes :</p>
<ul>
<li>le conteneur du script est WSH</li>
<li>le script est placé dans un fichier de suffixe .vbs</li>
</ul>
<p>Pour présenter un concept, nous opérons en général de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>* on introduit le concept si besoin est
* on présente un programme d&amp;#x27;illustration avec ses résultats
* on commente les résultats et le programme si besoin est
</code></pre></div></td></tr></table></div>
<p>Les conteneurs vbscript ne sont pas sensibles à la &quot;casse&quot; utilisée (majuscules/minuscules) dans le texte du script. Aussi pourra-t-on écrire indifféremment <em>wscript.echo &quot;coucou&quot;</em> ou <em>WSCRIPT.ECHO &quot;coucou&quot;</em>.</p>
<p>Les programmes présentés dans la suite font beaucoup d&#x27;écritures à l&#x27;écran aussi allons-nous présenter de nouveau les méthodes d&#x27;écriture de l&#x27;objet wscript.</p>
<h2 id="31-afficher-des-informations">3.1. Afficher des informations</h2>
<p>Nous avons déjà utilisé la méthode <em>echo</em> de l&#x27;objet <em>wscript</em> mais ce dernier a d&#x27;autres méthodes permettant d&#x27;écrire à l&#x27;écran comme le montre le script suivant :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000018500000062E235339D.png" style="display:inline-block; margin:4px;width:10.292cm;height:2.593cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>un
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>deuxtrois
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>quatre
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>cinq
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>On notera les points suivants :</p>
<ul>
<li>Toute texte placé après une apostrophe est considéré comme un commentaire du script et n&#x27;est pas interprété par WSH ( ligne 1).</li>
<li>la méthode <em>echo</em> écrit ses arguments et passe à la ligne suivante de même que la méthode writeLine (lignes 2 et 6)</li>
<li>la méthode <em>write</em> écrit ses arguments et ne passe pas à la ligne suivante (ligne 3)</li>
<li>une marque de fin de ligne est représentée par la suite de deux caractères de codes ASCII 13 et 10. Ainsi ligne 4 est-elle représentée par l&#x27;expression chr(13) &amp; chr(10) où chr(i) est le caractère de code ASCII i et &amp; l&#x27;opérateur de concaténation de chaîne. Ainsi &quot;chat&quot; &amp; &quot;eau&quot; est la chaîne &quot;chateau&quot;.</li>
<li>la marque de fin de ligne peut être représentée plus facilement par la constante vbCRLF (ligne 5)</li>
</ul>
<h2 id="32-ecriture-des-instructions-dans-un-script-vbscript">3.2. Ecriture des instructions dans un script Vbscript</h2>
<p>Par défaut, on écrit une instruction par ligne. Néanmoins, on peut écrire plusieurs instructions par ligne en les séparant par le caractère : comme dans <em>inst1:inst2:inst3</em>. Si une ligne est trop longue, on peut la découper en morceaux. Il faut alors que les différentes parties de l&#x27;instruction soient terminées par les deux caractères (espace)_. Nous reprenons l&#x27;exemple précédent en réécrivant différemment les instructions :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000021D0000005123E5DAEC.png" style="display:inline-block; margin:4px;width:14.314cm;height:2.143cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>un
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>deuxtrois
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>quatre
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>cinq
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="33-ecrire-avec-la-fonction-msgbox">3.3. Écrire avec la fonction msgBox</h2>
<p>Si dans ce document, nous utilisons quasi exclusivement l&#x27;objet <em>wscript</em> pour écrire à l&#x27;écran, il existe une fonction plus sophistiquée pour afficher des informations dans une fenêtre cette fois-ci. C&#x27;est la fonction <em>msgbox</em> qui s&#x27;utilise en général avec trois paramètres :</p>
<p><strong>msgbox message, icônes+boutons, titre</strong></p>
<ul>
<li>message est le texte du message à afficher</li>
<li>icônes+boutons (facultatif) est en fait un nombre qui indique le type d&#x27;icône et les boutons à placer dans la fenêtre du message. Ce nombre est le plus souvent la somme de deux nombres : le premier détermine l&#x27;icône, le second les boutons</li>
<li>titre est le texte à placer dans la barre de titre de la fenêtre de message</li>
</ul>
<p>Les valeurs à utiliser pour préciser l&#x27;icône et les boutons de la fenêtre d&#x27;affichage sont les suivantes :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Constante</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Valeur</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Description</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbOKOnly</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   0</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche uniquement le bouton <b>OK</b>.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbOKCancel</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   1</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche les boutons <b>OK</b> et <b>Annuler</b>.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbAbortRetryIgnore</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   2</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche les boutons <b>Abandon</b>, <b>Réessayer</b> et <b>Ignorer</b>.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbYesNoCancel</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   3</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche les boutons <b>Oui</b>, <b>Non</b> et <b>Annuler</b>.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbYesNo</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   4</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche les boutons <b>Oui</b> et <b>Non</b>.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbRetryCancel</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   5</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche les boutons <b>Réessayer</b> et <b>Annuler</b>.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbCritical</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">16</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche l&#x27;icône Message critique. </p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbQuestion</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">32</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche l&#x27;icône Demande d&#x27;avertissement.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbExclamation</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">48</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche l&#x27;icône Message d&#x27;avertissement.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbInformation</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">64</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Affiche l&#x27;icône Message d&#x27;information.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbDefaultButton1</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   0</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Le premier bouton est le bouton par défaut.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbDefaultButton2</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"> 256</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Le deuxième bouton est le bouton par défaut.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbDefaultButton3</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"> 512</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Le troisième bouton est le bouton par défaut.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbDefaultButton4</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"> 768</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Le quatrième bouton est le bouton par défaut.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbApplicationModal</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">   0</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Application modale ; l&#x27;utilisateur doit répondre au message avant de continuer à travailler dans l&#x27;application courante.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbSystemModal</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">4096</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Système modal ; toutes les applications sont suspendues jusqu&#x27;à ce que l&#x27;utilisateur réponde au message.</p></td></tr></table>

<p>Voici des exemples :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000024300000091EB465C82.png" style="display:inline-block; margin:4px;width:15.319cm;height:3.836cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000006A000000612496E7EB.png" style="display:inline-block; margin:4px;width:2.805cm;height:2.566cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000006800000063BFE0B9B0.png" style="display:inline-block; margin:4px;width:2.752cm;height:2.619cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000084000000776EF25534.png" style="display:inline-block; margin:4px;width:3.493cm;height:3.149cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000007E00000074CBC6883B.png" style="display:inline-block; margin:4px;width:3.334cm;height:3.069cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000007F00000075DA191345.png" style="display:inline-block; margin:4px;width:3.36cm;height:3.096cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000007E00000075ADFEF8D7.png" style="display:inline-block; margin:4px;width:3.334cm;height:3.096cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000000C000000075BE989999.png" style="display:inline-block; margin:4px;width:5.08cm;height:3.096cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;" colspan="3"><img src="images/100000000000017C000000768584D2B0.png" style="display:inline-block; margin:4px;width:10.054cm;height:3.122cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table></td></tr></table>

<p>Dans certains cas, on présente une fenêtre d&#x27;information qui est également une fenêtre de saisie. Si on pose une question, on veut par exemple savoir si l&#x27;utilisateur a cliqué sur le bouton <em>oui</em> ou sur le bouton <em>non</em>. La fonction <em>msgBox</em> rend un résultat que dans le programme précédent nous n&#x27;avons pas utilisé. Ce résultat est un nombre entier représentant le bouton utilisé par l&#x27;utilisateur pour fermer la fenêtre d&#x27;affichage :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Constante</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Valeur</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Bouton choisi</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbOK</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">1</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">OK</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbCancel</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">2</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Annuler</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbAbort</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">3</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Abandon</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbRetry</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">4</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Réessayer </p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbIgnore</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">5</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Ignorer</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbYes</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">6</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Oui</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbNo</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">7</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Non</p></td></tr></table>

<p>Le programme suivant montre l&#x27;utilisation du résultat de la fonction msgBox. On présente 4 fois une fenêtre avec les boutons oui, non, annuler. On répond de la façon suivante :</p>
<ol>
<li>on clique sur oui</li>
<li>on clique sur non</li>
<li>on clique sur annuler</li>
<li>on ferme la fenêtre sans utiliser de bouton. Le programme montre que cela revient à utiliser le bouton Annuler.</li>
</ol>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000002570000007692BD1954.png" style="display:inline-block; margin:4px;width:15.849cm;height:3.122cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000006B00000063EFCFCB32.png" style="display:inline-block; margin:4px;width:2.831cm;height:2.619cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000069000000632AA3981E.png" style="display:inline-block; margin:4px;width:2.778cm;height:2.619cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000006A000000636DA25B2B.png" style="display:inline-block; margin:4px;width:2.805cm;height:2.619cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000006B000000658D6E56A8.png" style="display:inline-block; margin:4px;width:2.831cm;height:2.672cm;" /></td></tr></table></td></tr></table>

<h2 id="34-les-donnees-utilisables-en-vbscript">3.4. Les données utilisables en Vbscript</h2>
<p>VBscript ne connaît qu&#x27;un type de données : le <strong>variant</strong>. La valeur d&#x27;un variant peut être un nombre (4, 10.2), une chaîne de caractères (&quot;bonjour&quot;), un booléen (true/false), une date (#01/01/2002#), l&#x27;adresse d&#x27;un objet, un ensemble de toutes ces données placées dans une structure appelée tableau.</p>
<p>Examinons le programme suivant et ses résultats :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000002600000023B1DFE3C70.png" style="display:inline-block; margin:4px;width:15.981cm;height:15.028cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a>4
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>i=4
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>10,2
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>r1=10,2
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>0,014
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>r2=0,014
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>c1=bonjour
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>01/10/02
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>d1=01/10/02
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>10/01/02
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>d2=10/01/02
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>-1
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>b1=Vrai
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>0
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>b2=Faux
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>v=4
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>v=10,2
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>v=bonjour
<a id="__codelineno-2-19" name="__codelineno-2-19"></a>v=01/10/02
<a id="__codelineno-2-20" name="__codelineno-2-20"></a>v=Vrai
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p><strong>Commentaires :</strong></p>
<ul>
<li>un certain nombre de langages de programmation (C, C++, Pascal, Java, C#, ...) exigent la déclaration préalable d&#x27;une variable avant son utilisation. Cette déclaration consiste à indiquer le nom de la variable et le type de données elle peut contenir (entier, réel, chaîne, date, booléen, ...). La déclaration des variables permet différentes choses :<ul>
<li>connaître la place mémoire nécessaire à la variable si différents types de données nécessitent différents espaces mémoire</li>
<li>de vérifier la cohérence du programme. Ainsi si <em>i</em> est un entier et <em>c</em> une chaîne de caractères, multiplier <em>i</em> par <em>c</em> n&#x27;a aucun sens. Si le type des variables <em>i</em> et <em>c</em> a été déclaré par le programmeur, le programme chargé d&#x27;analyser le programme avant son exécution peut signaler une telle incohérence.</li>
</ul>
</li>
</ul>
<p>Comme la plupart des langages de script à type de données unique (Perl, Python, Javascript, ...) Vbscript autorise de ne pas déclarer les variables. C&#x27;est ce qui a été fait dans l&#x27;exemple ci-dessus.</p>
<ul>
<li>
<p>notons la syntaxe de différentes données</p>
<ul>
<li>10.2 en ligne 10 (point décimal et non virgule). On notera qu&#x27;à l&#x27;affichage c&#x27;est 10,2 qui est affiché.</li>
<li>1.4e-2 en ligne 13 (notation scientifique). A l&#x27;affichage, c&#x27;est le nombre 0,014 qui a été affiché</li>
<li>[#01/10/2002#] (ligne 26) pour représenter la date du 10 janvier 2002. C&#x27;est donc le format #mm/jj/aaaa# que vbscript utilise pour représenter la date <em>jj</em> du mois <em>mm</em> de l&#x27;année <em>aaaa</em></li>
<li>les booléens true et false (vrai/faux) en lignes 31 et 34. Ces deux valeurs sont représentées respectivement par les entiers -1 et 0 comme le montre l&#x27;affichage des lignes 32 et 35. Lorsqu&#x27;un booléen est concaténé à une chaîne de caractères, ces valeurs deviennent respectivement les chaînes &quot;Vrai&quot; et &quot;Faux&quot; comme le montrent les lignes 33 et 36. On remarquera au passage que l&#x27;opérateur &amp; de concaténation peut servir à concaténer autre chose que des chaînes.</li>
</ul>
</li>
<li>
<p>une variable v n&#x27;ayant pas de type assigné, elle peut accueillir successivement dans le temps des valeurs de différents types.</p>
</li>
</ul>
<h2 id="35-les-sous-types-du-type-variant">3.5. Les sous-types du type variant</h2>
<p>Voici que dit la documentation officielle sur les différents types de données que peut contenir un variant :</p>
<p><em>Au-delà de la simple distinction nombre/chaîne, un </em><strong><em>Variant</em></strong><em> peut distinguer différents types d&#x27;information numérique. Par exemple, certaines informations numériques représentent une date ou une heure. Lorsque ces informations sont utilisées avec d&#x27;autres données de date ou d&#x27;heure, le résultat est toujours exprimé sous la forme d&#x27;une date ou d&#x27;une heure. Vous disposez aussi d&#x27;autres types d&#x27;information numérique, des valeurs booléennes jusqu&#x27;aux grands nombres à virgule flottante. Ces différentes catégories d&#x27;information qui peuvent être contenues dans un </em><strong><em>Variant</em></strong><em> sont des sous-types. Dans la plupart des cas, vous placez simplement vos données dans un </em><strong><em>Variant</em></strong><em> et celui-ci se comporte de la façon la plus appropriée en fonction de ces données.</em></p>
<p><em>Le tableau suivant présente différents sous-types susceptibles d&#x27;être contenus dans un </em><strong><em>Variant</em></strong><em>.</em></p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Sous-type</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Description</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Empty</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Le <b>Variant</b> n&#x27;est pas initialisé. Sa valeur est égale à zéro pour les variables numériques et à une chaîne de longueur nulle (&quot;&quot;) pour les variables chaîne.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Null</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Le <b>Variant</b> contient intentionnellement des données incorrectes. </p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Boolean</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient <a href="../../../../../st-2020/st-2020/cours/vbscript/vskeytrue.htm"><u><u>True</u></u></a> (vrai) ou <a href="../../../../../st-2020/st-2020/cours/vbscript/vskeyfalse.htm"><u><u>False</u></u></a> (faux).</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Byte</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un entier de 0 à 255. </p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Integer</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un entier de -32 768 à 32 767. </p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Currency</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">-922 337 203 685 477,5808 à 922 337 203 685 477,5807.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Long</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un entier de -2 147 483 648 à 2 147 483 647.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Single</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un nombre à virgule flottante en précision simple de -3,402823E38 à -1,401298E-45 pour les valeurs négatives ; de 1,401298E-45 à 3,402823E38 pour les valeurs positives.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Double</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un nombre à virgule flottante en précision double de -1,79769313486232E308 à -4,94065645841247E-324 pour les valeurs négatives ; de 4,94065645841247E-324 à 1,79769313486232E308 pour les valeurs positives.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Date (Time)</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un nombre qui représente une date entre le 1er janvier 100 et le 31 décembre 9999.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">String</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient une chaîne de longueur variable limitée à environ 2 milliards de caractères.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Object</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un objet.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Error</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Contient un numéro d&#x27;erreur.</p></td></tr></table>

<h2 id="36-connaitre-le-type-exact-de-la-donnee-contenue-dans-un-variant">3.6. Connaître le type exact de la donnée contenue dans un variant</h2>
<p>Une variable de type variant peut contenir des données de divers types. Il nous faut quelquefois connaître la nature exacte de ces données. Si dans un programme nous écrivons <em>produit=nombre1*nombre2</em>, nous supposons que <em>nombre1</em> et <em>nombre2</em> sont deux données numériques. Parfois nous n&#x27;en sommes pas sûrs car ces valeurs peuvent provenir d&#x27;une saisie au clavier, d&#x27;un fichier, d&#x27;une source extérieure quelconque. Il nous faut alors vérifier la nature des données placées dans <em>nombre1</em> et <em>nombre2</em>. La fonction <em>typename(var)</em> nous permet de connaître le type de données contenue dans la variable <em>var</em>. Voici des exemples :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001D500000105A13C9E69.png" style="display:inline-block; margin:4px;width:12.409cm;height:6.906cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a>var=1,type=Integer
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>var=deux,type=String
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>var=Vrai,type=Boolean
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>var=4,5,type=Double
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>var=11/10/01,type=Date
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Une autre fonction possible est <em>vartype(var)</em> qui rend un nombre représentant le type de la donnée contenue par la variable <em>var</em> :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Constante</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Valeur</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Description</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbEmpty</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Empty (non initialisée)</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbNull</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">1</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Null (aucune donnée valide)</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbInteger</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">2</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Entier</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbLong</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">3</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Entier long </p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbSingle</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">4</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Nombre en virgule flottante en simple précision</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbDouble</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">5</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Nombre en virgule flottante en double précision</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbCurrency</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">6</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Monétaire</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbDate</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">7</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Date</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbString</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">8</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Chaîne</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbObject</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">9</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Objet Automation</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbError</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">10</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Erreur</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbBoolean</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">11</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Booléen</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbVariant</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">12</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Variant (utilisé seulement avec des tableaux de Variants)</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbDataObject</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">13</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Objet non Automation</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbByte</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">17</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Octet</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">vbArray</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">8192</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Tableau</p></td></tr></table>

<p><strong>Remarque</strong>   Ces constantes sont spécifiées par VBScript. En conséquence, les noms peuvent être utilisés n&#x27;importe où dans votre code à la place des valeurs réelles.</p>
<p>Les informations ci-dessus proviennent de la documentation de VBscript. Celle-ci est parfois incorrecte, issue probablement de copier-coller faits à partir de la documentation de VB. La fonction <em>vartype</em> de VBScript ne fait qu&#x27;une partie de ce qui est annoncé ci-dessus.</p>
<p>Le programme précédent, réécrit pour <em>vartype</em> donne les résultats suivants :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001E5000001072224CD0A.png" style="display:inline-block; margin:4px;width:12.832cm;height:6.959cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>var=1,type=2
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>var=deux,type=8
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>var=Vrai,type=11
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>var=4,5,type=5
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>var=11/10/01,type=7
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="37-declarer-les-variables-utilisees-par-le-script">3.7. Déclarer les variables utilisées par le script</h2>
<p>Nous avons indiqué qu&#x27;il n&#x27;était pas obligatoire de déclarer les variables utilisées par le script. Dans ce cas, si nous écrivons :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>1) somme=4
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>...
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>2) somme=smme+10
</code></pre></div></td></tr></table></div>
<p>avec une faute de frappe <em>smme</em> au lieu de somme dans l&#x27;instruction 2, vbscript ne signalera aucune erreur. Il supposera que <em>smme</em> est une nouvelle variable. Il la créera et dans le contexte de l&#x27;instruction 2 l&#x27;utilisera en l&#x27;initialisant à 0.</p>
<p>Ce genre d&#x27;erreurs peut être très difficile à retrouver. Aussi est-il conseillé de forcer la déclaration des variables avec la directive <strong>option explicit</strong> placée en début de script. Ensuite toute variable doit être déclarée avec une instruction <strong>dim</strong> avant sa première utilisation : </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>option explicit
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>...
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>dim somme
<a id="__codelineno-6-4" name="__codelineno-6-4"></a>1) somme=4
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>...
<a id="__codelineno-6-6" name="__codelineno-6-6"></a>2) somme=smme+10
</code></pre></div></td></tr></table></div>
<p>Dans cet exemple, vbscript indiquera qu&#x27;il y a une variable non déclarée <strong>smme</strong> en 2) comme le montre l&#x27;exemple qui suit :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000013100000070D6922D66.png" style="display:inline-block; margin:4px;width:8.07cm;height:2.963cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>dim1.vbs(9, 1) Erreur d&#39;exécution Microsoft VBScript: Variable non définie: &#39;smme&#39;
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Si dans les courts exemples du document, les variables ne sont la plupart du temps pas déclarées, nous forcerons leur déclaration dès que nous écrirons les premiers scripts significatifs. La directive <strong>Option explicit</strong> sera alors utilisée systématiquement.</p>
<h2 id="38-les-fonctions-de-conversion">3.8. Les fonctions de conversion</h2>
<p>Vbscript transforme les données des variants en chaînes, nombres, booléens, ... selon le contexte. La plupart du temps, cela fonctionne bien mais parfois cela donne quelques surprises comme nous le verrons ultérieurement. On peut alors vouloir &quot;forcer&quot; le type de donnée du variant. VBscript possède des fonctions de conversion qui transforment une expression en divers types de données. En voici quelques unes :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Cint (expression)</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">transforme expression en entier court (integer)</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Clng (expression)</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">transforme expression en entier long (long)</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Cdbl (expression)</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">transforme expression en réel double (double)</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Csng (expression)</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">transforme expression en réel simple (single)</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Ccur (expression)</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">transforme expression en donnée monétaire (currency)</p></td></tr></table>

<p>Voici quelques exemples :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000028A00000248B842EA4D.png" style="display:inline-block; margin:4px;width:15.981cm;height:14.367cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>var=4,code type=8,nom type=String
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>var=4,code type=2,nom type=Integer
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>var=1000000,code type=8,nom type=String
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>var=1000000,code type=3,nom type=Long
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>var=3,4e-5,code type=8,nom type=String
<a id="__codelineno-8-6" name="__codelineno-8-6"></a>var=0,000034,code type=5,nom type=Double
<a id="__codelineno-8-7" name="__codelineno-8-7"></a>var=3,4e-5,code type=8,nom type=String
<a id="__codelineno-8-8" name="__codelineno-8-8"></a>var=0,000034,code type=4,nom type=Single
<a id="__codelineno-8-9" name="__codelineno-8-9"></a>var=1000,45,code type=8,nom type=String
<a id="__codelineno-8-10" name="__codelineno-8-10"></a>var=1000,45,code type=6,nom type=Currency
<a id="__codelineno-8-11" name="__codelineno-8-11"></a>var=14,code type=2,nom type=Integer
<a id="__codelineno-8-12" name="__codelineno-8-12"></a>var=14,code type=8,nom type=String
<a id="__codelineno-8-13" name="__codelineno-8-13"></a>var=1000,45,code type=5,nom type=Double
<a id="__codelineno-8-14" name="__codelineno-8-14"></a>var=1000,code type=2,nom type=Integer
<a id="__codelineno-8-15" name="__codelineno-8-15"></a>var=1000,75,code type=5,nom type=Double
<a id="__codelineno-8-16" name="__codelineno-8-16"></a>var=1001,code type=2,nom type=Integer
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="39-lire-des-donnees-tapees-au-clavier">3.9. Lire des données tapées au clavier</h2>
<p>L&#x27;objet wscript permet à un script de récupérer des données tapées au clavier. La méthode <em>wscript.stdin.readLine</em> permet de lire une ligne de texte tapée au clavier et validée par la touche &quot;Entrée&quot;. Cette ligne lue peut être affectée à une variable.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000013C0000004A7580C8B3.png" style="display:inline-block; margin:4px;width:8.361cm;height:1.958cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>Tapez votre nom : st
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>Bonjour st
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Commentaires :</p>
<ul>
<li>Dans la colonne des résultats et dans la ligne [Tapez votre nom : <em>st</em>] , <em>st</em> est la ligne tapée par l&#x27;utilisateur.</li>
</ul>
<p>Si le texte tapé au clavier représente un nombre, il est quand même considéré avant tout comme une chaîne de caractères comme le montre l&#x27;exemple ci-dessous :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001680000004C1B2D006F.png" style="display:inline-block; margin:4px;width:9.525cm;height:2.011cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>Tapez un nombre : 14
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>nombre lu=14,type=String
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Si ce nombre intervient dans une opération arithmétique, VBscript fera automatiquement la conversion de la chaîne vers un nombre mais pas toujours. Regardons l&#x27;exemple qui suit :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000188000000C40B47CABD.png" style="display:inline-block; margin:4px;width:9.816cm;height:4.895cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span>
<span class="normal"><a href="#__codelineno-11-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>nombre1 : 3
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>nombre2 : 4
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>3+4=34
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>3-4=-1
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>3x4=12
<a id="__codelineno-11-6" name="__codelineno-11-6"></a>3/4=0,75
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Dans les résultats, on voit que la ligne 8 du script ne s&#x27;est pas déroulée comme attendu, ceci parce que (malheureusement) en vbscript l&#x27;opérateur + a deux significations : addition de deux nombres ou concaténation de deux chaînes (les deux chaînes sont collées l&#x27;une à l&#x27;autre). Nous avons vu précédemment que les nombres tapés au clavier étaient lus comme étant des chaînes de caractères et que vbscript transformait celles-ci en nombres selon les besoins. Il l&#x27;a correctement fait pour les opérations -,*,/ qui ne peuvent faire intervenir que des nombres mais pas pour l&#x27;opérateur + qui lui peut également faire intervenir des chaînes. Il a supposé ici qu&#x27;on voulait faire une concaténation de chaînes.</p>
<p>Une solution simple à ce problème est de transformer en nombres les chaînes dès leur lecture comme le montre l&#x27;amélioration qui suit du programme précédent :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001E500000132E9912AA0.png" style="display:inline-block; margin:4px;width:9.79cm;height:6.191cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>nombre1 : 3
<a id="__codelineno-12-2" name="__codelineno-12-2"></a>nombre1=3,type=String
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>nombre1=3,type=Long
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>nombre2 : 4
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>nombre2=4,type=String
<a id="__codelineno-12-6" name="__codelineno-12-6"></a>nombre2=4,type=Long
<a id="__codelineno-12-7" name="__codelineno-12-7"></a>3+4=7
<a id="__codelineno-12-8" name="__codelineno-12-8"></a>3-4=-1
<a id="__codelineno-12-9" name="__codelineno-12-9"></a>3x4=12
<a id="__codelineno-12-10" name="__codelineno-12-10"></a>3/4=0,75
</code></pre></div></td></tr></table></div>
</div><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a>
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="310-saisir-des-donnees-avec-la-fonction-inputbox">3.10. Saisir des données avec la fonction inputbox</h2>
<p>On peut vouloir saisir des données dans une interface graphique plutôt qu&#x27;au clavier. On utilise alors la fonction <em>inputBox</em>. Celle-ci admet de nombreux paramètres dont seuls les deux premiers sont fréquemment utilisés :</p>
<p><strong>reponse=inputBox(message,titre)</strong></p>
<ul>
<li><strong>message</strong> : la question que vous posez à l&#x27;utilisateur</li>
<li><strong>titre</strong> (facultatif) : le titre que vous donnez à la fenêtre de saisie</li>
<li><strong>reponse</strong> : le texte tapé par l&#x27;utilisateur. Si celui-ci a fermé la fenêtre sans répondre, <strong>reponse</strong> est la chaîne vide.</li>
</ul>
<p>Voici un exemple où on demande le nom et l&#x27;âge d&#x27;une personne. Pour le nom on donne une information et on fait OK. Pour l&#x27;âge, on donne également une information mais on fait Annuler.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000015400000058BDB51C54.png" style="display:inline-block; margin:4px;width:8.996cm;height:2.328cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000016A00000097C484981F.png" style="display:inline-block; margin:4px;width:9.578cm;height:3.995cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000008500000063A2EA4688.png" style="display:inline-block; margin:4px;width:3.519cm;height:2.619cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001690000009815026986.png" style="display:inline-block; margin:4px;width:9.551cm;height:4.022cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000006A000000648784CD3E.png" style="display:inline-block; margin:4px;width:2.805cm;height:2.646cm;" /></td></tr></table></td></tr></table>

<h2 id="311-utiliser-des-objets-structures">3.11. Utiliser des objets structurés</h2>
<p>Il est possible de créer avec vbscript des objets ayant des méthodes et des propriétés. Pour ne pas compliquer les choses, nous allons présenter ici un objet avec des propriétés et pas de méthodes. Considérons une personne. Elle a de nombreuses propriétés qui la caractérisent : taille, poids, couleur de peau, des yeux, des cheveux, ... Nous n&#x27;en retiendrons que deux : son nom et son âge. Avant de pouvoir utiliser des objets, il faut créer le moule qui va permettre de les fabriquer. Cela se fait en vbscript avec une <strong>classe</strong>. La classe <em>personne</em> pourrait être définie comme suit :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">class</span><span class="w"> </span><span class="nc">personne</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">nom</span><span class="p">,</span><span class="nv">age</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="k">End</span><span class="w"> </span><span class="k">class</span>
</code></pre></div></td></tr></table></div>
<p>C&#x27;est l&#x27;instruction [Dim nom,age] qui définit les deux propriétés de la classe <em>personne</em>. Pour créer des exemplaires (on parle d&#x27;instances) de la classe <em>personne</em>, on écrit :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a>set personne1=new personne
<a id="__codelineno-15-2" name="__codelineno-15-2"></a>set personne2=new personne
</code></pre></div></td></tr></table></div>
<p>Pourquoi ne pas écrire </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a>personne1=new personne
<a id="__codelineno-16-2" name="__codelineno-16-2"></a>personne2=new personne
</code></pre></div></td></tr></table></div>
<p>Parce qu&#x27;un variant ne peut contenir un objet. Il peut seulement en contenir l&#x27;adresse. En écrivant <em>set personne1=new personne</em>, la séquence d&#x27;événements suivante prend place :</p>
<ol>
<li>un objet <em>personne</em> est créé. Cela veut dire que de la mémoire lui est allouée.</li>
<li>l&#x27;adresse de cet objet <em>personne</em> est affectée à la variable <em>personne1</em></li>
</ol>
<p>Nous avons alors le schéma mémoire suivant pour les variables <em>personne1</em> et <em>personne2</em> :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000497000000F514788662.png" style="display:inline-block; margin:4px;width:15.545cm;height:3.242cm;" /></td></tr></table>

<p>Par abus de langage, on pourra dire que <em>personne1</em> est un objet <em>personne</em>. On peut accepter cet abus de langage si on se rappelle que <em>personne1</em> est en fait l&#x27;adresse d&#x27;un objet <em>personne</em> et non l&#x27;objet <em>personne</em> lui-même.</p>
<p>Nous avons dit qu&#x27;un objet <em>personne</em> avait deux propriétés <em>nom</em> et <em>age</em>. Comment exploiter ces propriétés ? Par la notation <em>objet.propriété</em> comme il a été expliqué un peu plus haut. Ainsi</p>
<p><em>personne1.nom</em> désigne le nom de la personne 1 et <em>personne1.age</em> son âge. Voici un court programme d&#x27;illustration :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001780000009C61977378.png" style="display:inline-block; margin:4px;width:9.948cm;height:4.128cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a>p1=(dupont,18)
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Le programme précédent pourrait être modifié comme suit :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000113000000E1B892A957.png" style="display:inline-block; margin:4px;width:7.276cm;height:5.953cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>nom=dupont
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>age=18
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Nous avons utilisé ici la structure <em>with ... end with</em> qui permet de &quot;factoriser&quot; des noms d&#x27;objets dans des expressions. La structure <em>with p1 ... end with</em> des lignes 9-12 et 15-18 permet d&#x27;utiliser ensuite la syntaxe <em>.nom</em> en lieu et place de <em>p1.nom</em> et <em>.age</em> en lieu et place de <em>p1.age</em>. Cela permet d&#x27;alléger l&#x27;écriture des instructions où le même nom d&#x27;objet est utilisée de façon répétée.</p>
<h2 id="312-affecter-une-valeur-a-une-variable">3.12. Affecter une valeur à une variable</h2>
<p>Il y a deux instructions pour affecter une valeur à une variable :</p>
<ul>
<li><strong>variable=expression</strong></li>
<li><strong>set variable=expression</strong></li>
</ul>
<p>La forme 2 est réservée aux expressions dont le résultat est une référence d&#x27;objet. Pour tous les autres types d&#x27;expressions c&#x27;est la forme 1 qui convient. La différence entre les deux formes est la suivante :</p>
<ol>
<li>dans l&#x27;instruction <em>variable=expression</em>, variable reçoit une valeur. Si v1 et v2 sont deux variables, écrire v1=v2 affecte la valeur de v1 à v2. On a donc la duplication d&#x27;une valeur à deux endroits différents. Si par la suite, la valeur de v2 est modifiée, celle de v1 ne l&#x27;est en rien.</li>
</ol>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000023B0000008421180CC7.png" style="display:inline-block; margin:4px;width:7.555cm;height:1.746cm;" /></td></tr></table>

<ol>
<li>dans l&#x27;instruction <em>set variable=expression</em>, variable reçoit comme valeur l&#x27;adresse d&#x27;un objet. Si v1 et v2 sont deux variables et si v2 est l&#x27;adresse d&#x27;un objet obj2, écrire set v1=v2 affecte la valeur de v1 à v2, donc l&#x27;adresse de l&#x27;objet obj2. Lorsque le script manipule ensuite v1 et v2, ce ne sont pas les &quot;valeurs&quot; de v1 et v2 qui sont manipulées mais bien les objets &quot;pointés&quot; par v1 et v2, donc le même objet ici. On dit que v1 et v2 sont deux références au même objet et manipuler ce dernier via v1 ou v2 ne fait aucune différence. Dit autrement, modifier l&#x27;objet référencé par v2 modifie celui référencé par v1.</li>
</ol>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000003B0000000E90473EECF.png" style="display:inline-block; margin:4px;width:12.488cm;height:3.083cm;" /></td></tr></table>

<p>Voici un exemple :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000020A000001614638114F.png" style="display:inline-block; margin:4px;width:12.878cm;height:9.34cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>i=4
<a id="__codelineno-19-2" name="__codelineno-19-2"></a>j=4
<a id="__codelineno-19-3" name="__codelineno-19-3"></a>i=4
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>j=5
<a id="__codelineno-19-5" name="__codelineno-19-5"></a>p1.nom=dupont
<a id="__codelineno-19-6" name="__codelineno-19-6"></a>p1.age=18
<a id="__codelineno-19-7" name="__codelineno-19-7"></a>p1.nom=dupont
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>p1.age=19
<a id="__codelineno-19-9" name="__codelineno-19-9"></a>p2.nom=dupont
<a id="__codelineno-19-10" name="__codelineno-19-10"></a>p2.age=19
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="313-evaluer-des-expressions">3.13. Évaluer des expressions</h2>
<p>Les principaux opérateurs permettant d&#x27;évaluer des expressions sont les suivantes :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Type d&#x27;opérateurs</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Opérateurs</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Exemple</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;" rowspan="4"><p style="margin:0;">Arithmétique</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">+,-,*,/</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">mod</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><i>a mod b</i> donne le reste de la division entière de a par b. Auparavant a et b ont été transformés en entiers si besoin était.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">\</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><i>a \ b</i> donne le quotient de la division entière de a par b. Auparavant a et b ont été transformés en entiers si besoin était.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">^</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><i>a^b</i> élève a à la puissance b. Ainsi a^2 est égal à a2</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;" rowspan="2"><p style="margin:0;">Comparaison</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">&lt;,&lt;=</p><p style="margin:0;">&gt;, &gt;=</p><p style="margin:0;">=,&lt;&gt;</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><i>a&lt;&gt;b</i> est vrai si a est différent de b</p><p style="margin:0;"><i>a=b</i> est vrai si a est égal à b</p><p style="margin:0;">a et b peuvent être tous deux des nombres ou tous deux des chaînes de caractères. Dans ce dernier cas, chaine1&lt;chaine2 si dans l&#x27;ordre alphabétique chaine1 précède chaine2. Dans la comparaison de chaînes, les majuscules précèdent les minuscules dans l&#x27;ordre alphabétique.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">is</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><i>obj1 is obj2</i> est vrai si obj1 et obj2 sont des références sur le même objet.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Logique</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">and, or, not, xor</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Les opérandes sont tous ici booléens.</p><p style="margin:0;"><i>bool1 or bool2</i> est vrai si bool1 ou bool2 est vrai</p><p style="margin:0;"><i>bool1 and bool2</i> est vrai si bool1 et bool2 sont vrais</p><p style="margin:0;"><i>not bool1</i> est vrai si bool1 est faux et vice-versa</p><p style="margin:0;"><i>bool1 xor bool2</i> est vrai si seulement un seul des booléens bool1, bool2 est vrai</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Concaténation</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">&amp;, +</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"> Il est déconseillé d&#x27;utiliser l&#x27;opérateur + pour concaténer deux chaînes à cause de la confusion possible avec l&#x27;addition de deux nombres. On utilisera donc exclusivement l&#x27;opérateur &amp;.</p></td></tr></table>

<h2 id="314-controler-lexecution-du-programme">3.14. Contrôler l&#x27;exécution du programme</h2>
<h3 id="3141-executer-des-actions-de-facon-conditionnelle">3.14.1. Exécuter des actions de façon conditionnelle</h3>
<p>L&#x27;instruction vbscript permettant de faire des actions selon la valeur vraie/fausse d&#x27;une condition est la suivante :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span>
<span class="normal"><a href="#__codelineno-20-5">5</a></span>
<span class="normal"><a href="#__codelineno-20-6">6</a></span>
<span class="normal"><a href="#__codelineno-20-7">7</a></span>
<span class="normal"><a href="#__codelineno-20-8">8</a></span>
<span class="normal"><a href="#__codelineno-20-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a>if expression then
<a id="__codelineno-20-2" name="__codelineno-20-2"></a>    action-vrai-1
<a id="__codelineno-20-3" name="__codelineno-20-3"></a>    action-vrai-2
<a id="__codelineno-20-4" name="__codelineno-20-4"></a>    ..
<a id="__codelineno-20-5" name="__codelineno-20-5"></a>else
<a id="__codelineno-20-6" name="__codelineno-20-6"></a>    action-faux-1
<a id="__codelineno-20-7" name="__codelineno-20-7"></a>    action-faux-2
<a id="__codelineno-20-8" name="__codelineno-20-8"></a>    ...
<a id="__codelineno-20-9" name="__codelineno-20-9"></a>end if
</code></pre></div></td></tr></table></div>
</div></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">L&#x27;expression <i>expression</i> est tout d&#x27;abord évaluée. Cette expression doit avoir une valeur booléenne. Si elle a la valeur vrai, les actions du <i>then</i> sont exécutées sinon ce sont celles du <i>else</i> s&#x27;il est présent.</p></td></tr></table>

<p>Suit un programme présentant différentes variantes du if-then-else :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001B8000000DA659D3AAB.png" style="display:inline-block; margin:4px;width:11.642cm;height:5.768cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span>
<span class="normal"><a href="#__codelineno-21-4">4</a></span>
<span class="normal"><a href="#__codelineno-21-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a>3 est plus grand que 0
<a id="__codelineno-21-2" name="__codelineno-21-2"></a>3 est plus grand que 2
<a id="__codelineno-21-3" name="__codelineno-21-3"></a>i=4
<a id="__codelineno-21-4" name="__codelineno-21-4"></a>4 est plus petit que 10
<a id="__codelineno-21-5" name="__codelineno-21-5"></a>i=3
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Commentaires :</p>
<ul>
<li>en vbscript, on peut écrire <em>instruction1:instruction2:... : instructionn</em> au lieu d&#x27;écrire une instruction par ligne. C&#x27;est cette possibilité qui a été exploitée en ligne 10 par exemple.</li>
</ul>
<h3 id="3142-executer-des-actions-de-facon-repetee">3.14.2. Exécuter des actions de façon répétée</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Boucle à nombre d&#x27;itérations connu</b></p><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a>for i=idébut to ifin step ipas
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>    actions
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>next
</code></pre></div></td></tr></table></div>
</div></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">&bull; la variable i est ici appelée variable de boucle. Elle peut porter un nom quelconque</p><p style="margin:0;">&bull; i prend la valeur idébut</p><p style="margin:0;">&bull; la valeur de i est comparée à ifin. Si i&lt;=ifin, les actions situées entre le for... next sont exécutées</p><p style="margin:0;">&bull; i est incrémenté de la quantité ipas (i=i+ipas)</p><p style="margin:0;">&bull; on reboucle à l&#x27;étape 3 précédente. Au bout d&#x27;un nombre fini d&#x27;étapes, la valeur de i dépassera ifin. L&#x27;exécution du script se poursuit avec l&#x27;instruction qui suit le next</p><p style="margin:0;">&bull; si l&#x27;incrément ipas est négatif, la condition de l&#x27;étape 3 est changée. On exécute les actions du for...next que si i&gt;=ifin.</p><p style="margin:0;">On peut sortir d&#x27;une boucle for à tout moment avec l&#x27;instruction <b>exit for</b>.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Boucle à nombre d&#x27;itérations inconnu</b></p><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a>do while condition
<a id="__codelineno-23-2" name="__codelineno-23-2"></a>    actions
<a id="__codelineno-23-3" name="__codelineno-23-3"></a>loop
</code></pre></div></td></tr></table></div>
</div></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">&bull; l&#x27;expression condition est évaluée. Si elle est vraie, les actions du while...loop sont exécutées</p><p style="margin:0;">&bull; les actions exécutées ont pu modifier la valeur de condition. On reboucle sur l&#x27;étape 1 précédente.</p><p style="margin:0;">&bull; lorsque l&#x27;expression condition devient fausse, la boucle est terminée</p><p style="margin:0;">On peut sortir d&#x27;une boucle do while à tout moment avec l&#x27;instruction <b>exit do</b>.</p></td></tr></table>

<p>Le programme ci-dessous illustre ces points :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000002440000019C731E707D.png" style="display:inline-block; margin:4px;width:15.346cm;height:10.901cm;" /></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span>
<span class="normal"><a href="#__codelineno-24-15">15</a></span>
<span class="normal"><a href="#__codelineno-24-16">16</a></span>
<span class="normal"><a href="#__codelineno-24-17">17</a></span>
<span class="normal"><a href="#__codelineno-24-18">18</a></span>
<span class="normal"><a href="#__codelineno-24-19">19</a></span>
<span class="normal"><a href="#__codelineno-24-20">20</a></span>
<span class="normal"><a href="#__codelineno-24-21">21</a></span>
<span class="normal"><a href="#__codelineno-24-22">22</a></span>
<span class="normal"><a href="#__codelineno-24-23">23</a></span>
<span class="normal"><a href="#__codelineno-24-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a>i=0,tableau(i)=10,somme=10
<a id="__codelineno-24-2" name="__codelineno-24-2"></a>i=1,tableau(i)=20,somme=30
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>i=2,tableau(i)=30,somme=60
<a id="__codelineno-24-4" name="__codelineno-24-4"></a>i=3,tableau(i)=40,somme=100
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>i=0,tableau(i)=10,somme=10
<a id="__codelineno-24-6" name="__codelineno-24-6"></a>i=1,tableau(i)=20,somme=30
<a id="__codelineno-24-7" name="__codelineno-24-7"></a>i=2,tableau(i)=30,somme=60
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>i=1
<a id="__codelineno-24-9" name="__codelineno-24-9"></a>i=2
<a id="__codelineno-24-10" name="__codelineno-24-10"></a>i=3
<a id="__codelineno-24-11" name="__codelineno-24-11"></a>i=4
<a id="__codelineno-24-12" name="__codelineno-24-12"></a>i=5
<a id="__codelineno-24-13" name="__codelineno-24-13"></a>i=6
<a id="__codelineno-24-14" name="__codelineno-24-14"></a>i=7
<a id="__codelineno-24-15" name="__codelineno-24-15"></a>i=8
<a id="__codelineno-24-16" name="__codelineno-24-16"></a>i=9
<a id="__codelineno-24-17" name="__codelineno-24-17"></a>i=10
<a id="__codelineno-24-18" name="__codelineno-24-18"></a>i=11
<a id="__codelineno-24-19" name="__codelineno-24-19"></a>i=1
<a id="__codelineno-24-20" name="__codelineno-24-20"></a>i=2
<a id="__codelineno-24-21" name="__codelineno-24-21"></a>i=3
<a id="__codelineno-24-22" name="__codelineno-24-22"></a>i=4
<a id="__codelineno-24-23" name="__codelineno-24-23"></a>i=5
<a id="__codelineno-24-24" name="__codelineno-24-24"></a>i=6
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p><strong>Note</strong> : Dans la phase de développement d&#x27;un programme, il n&#x27;est pas rare qu&#x27;un programme &quot;boucle&quot;, c.a.d. qu&#x27;il ne s&#x27;arrête jamais. En général, le programme exécute une boucle dont la condition de sortie ne peut être vérifiée comme par exemple dans l&#x27;exemple qui suit :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a>&#39; boucle infinie
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>i=0
<a id="__codelineno-25-3" name="__codelineno-25-3"></a>Do While 1=1
<a id="__codelineno-25-4" name="__codelineno-25-4"></a>  i=i+1
<a id="__codelineno-25-5" name="__codelineno-25-5"></a>  wscript.echo i
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>Loop
<a id="__codelineno-25-7" name="__codelineno-25-7"></a>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>&#39; une autre du même genre
<a id="__codelineno-25-9" name="__codelineno-25-9"></a>i=0
<a id="__codelineno-25-10" name="__codelineno-25-10"></a>Do While true
<a id="__codelineno-25-11" name="__codelineno-25-11"></a>  i=i+1
<a id="__codelineno-25-12" name="__codelineno-25-12"></a>  wscript.echo i
<a id="__codelineno-25-13" name="__codelineno-25-13"></a>Loop
</code></pre></div></td></tr></table></div>
<p>Si on exécute le programme précédent, la première boucle ne s&#x27;arrêtera jamais d&#x27;elle-même. On peut forcer son arrêt en tapant <strong>CTRL-C</strong> au clavier (touche CTRL et touche C enfoncées en même temps).</p>
<h3 id="3143-terminer-lexecution-du-programme">3.14.3. Terminer l&#x27;exécution du programme</h3>
<p>L&#x27;instruction <strong><em>wscript.quit n</em></strong> termine l&#x27;exécution du programme en renvoyant un code d&#x27;erreur égal à n. Sous DOS, ce code d&#x27;erreur peut être testé avec l&#x27;instruction if ERRORLEVEL n qui est vrai si le code d&#x27;erreur renvoyé par le dernier programme exécuté est &gt;=n. Considérons le programme suivant et ses résultats :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001450000004D41CC124F.png" style="display:inline-block; margin:4px;width:8.599cm;height:2.037cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a>début
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Juste après l&#x27;exécution du programme, on émet les trois commandes DOS suivantes :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span>
<span class="normal"><a href="#__codelineno-27-5">5</a></span>
<span class="normal"><a href="#__codelineno-27-6">6</a></span>
<span class="normal"><a href="#__codelineno-27-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a>C:\&gt;if ERRORLEVEL 5 echo 5
<a id="__codelineno-27-2" name="__codelineno-27-2"></a>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a>C:\&gt;if ERRORLEVEL 4 echo 4
<a id="__codelineno-27-4" name="__codelineno-27-4"></a>4
<a id="__codelineno-27-5" name="__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a>C: &gt;if ERRORLEVEL 3 echo 3
<a id="__codelineno-27-7" name="__codelineno-27-7"></a>3
</code></pre></div></td></tr></table></div>
<p>La commande DOS 1 teste si le code d&#x27;erreur retourné par le programme est &gt;=5. Si oui, elle affiche (echo) 5 sinon rien.</p>
<p>La commande DOS 2 teste si le code d&#x27;erreur retourné par le programme est &gt;=4. Si oui, elle affiche 4 sinon rien.</p>
<p>La commande DOS 3 teste si le code d&#x27;erreur retourné par le programme est &gt;=3. Si oui, elle affiche 3 sinon rien.</p>
<p>Des résultats affichés, on peut déduire que le code d&#x27;erreur retourné par le programme était 4.</p>
<h2 id="315-les-tableaux-de-donnees-dans-un-variant">3.15. Les tableaux de données dans un variant</h2>
<p>Un variant T peut contenir une liste de valeurs. On dit alors que c&#x27;est un tableau. Un tableau T possède diverses propriétés :</p>
<ul>
<li>on a accès à l&#x27;élément i du tableau T par la syntaxe <strong>T(i)</strong> où i est un entier appelé indice entre 0 et n-1 si T a n éléments.</li>
<li>on peut connaître l&#x27;indice du dernier élément du tableau T avec l&#x27;expression <strong>ubound(T)</strong>. Le nombre d&#x27;éléments du tableau T est alors ubound(T)+1. On appelle souvent ce nombre la taille du tableau.</li>
<li>un variant T peut être initialisé avec un tableau vide par la syntaxe <strong>T=array()</strong> ou avec une suite d&#x27;éléments par la syntaxe <strong>T=array(élément0, élément1, ...., élémentn)</strong></li>
<li>on peut ajouter des éléments à un tableau T déjà créé. Pour cela, on utilise l&#x27;instruction <strong>redim preserve T(N)</strong> où N est le nouvel indice du dernier élément du tableau T. L&#x27;opération est appelée un redimensionnement (redim). Le mot clé <strong>preserve</strong> indique que lors de ce redimensionnement, le contenu actuel du tableau doit être préservé. En l&#x27;absence de ce mot clé, T est redimensionné et vidé de ses éléments.</li>
<li>un élément T(i) du tableau T est de type variant et peut donc contenir n&#x27;importe quelle valeur et en particulier un tableau. Dans ce cas, la notation <strong>T(i)(j)</strong> désigne l&#x27;élément j du tableau T(i).</li>
</ul>
<p>Ces diverses propriétés des tableaux sont illustrées par le programme qui suit :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000000000228000001575F89DF38.png" style="display:inline-block; margin:4px;width:12.878cm;height:9.075cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a>Le tableau t1 a 5 éléments
<a id="__codelineno-28-2" name="__codelineno-28-2"></a>t1(0)=1
<a id="__codelineno-28-3" name="__codelineno-28-3"></a>t1(1)=-4,5
<a id="__codelineno-28-4" name="__codelineno-28-4"></a>t1(2)=deux
<a id="__codelineno-28-5" name="__codelineno-28-5"></a>t1(3)=Vrai
<a id="__codelineno-28-6" name="__codelineno-28-6"></a>t1(4)=10/01/02
<a id="__codelineno-28-7" name="__codelineno-28-7"></a>t1=1:-4,5:deux:Vrai:10/01/02
<a id="__codelineno-28-8" name="__codelineno-28-8"></a>t1(5)=10:20:30
<a id="__codelineno-28-9" name="__codelineno-28-9"></a>t1(5)(1)=20
<a id="__codelineno-28-10" name="__codelineno-28-10"></a>t1=1 ~ -4,5 ~ deux
<a id="__codelineno-28-11" name="__codelineno-28-11"></a>t1=:::
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p>Commentaires</p>
<ul>
<li>on a utilisé ici une fonction appelée <strong>join</strong> explicitée un peu plus loin.</li>
</ul>
<h2 id="316-les-variables-tableaux">3.16. Les variables tableaux</h2>
<p>Il existe en vbscript une autre façon d&#x27;utiliser un tableau, c&#x27;est d&#x27;utiliser une variable tableau. Une telle variable doit alors être obligatoirement déclarée contrairement aux variables scalaires par une instruction <strong>dim</strong>. Diverses déclarations sont possibles :</p>
<ul>
<li><strong>dim tableau(n)</strong> déclare un tableau statique de n+1 éléments numérotés de 0 à n. Ce type de tableau ne peut pas être redimensionné</li>
<li><strong>dim tableau()</strong> déclare un tableau dynamique vide. Il devra être redimensionné pour être utilisé par l&#x27;instruction redim de la même manière que pour un variant contenant un tableau</li>
<li><strong>dim tableau(n,m)</strong> déclare un tableau à 2 dimensions de (n+1)*(m+1) éléments. L&#x27;élément (i,j) du tableau est noté <em>tableau(i,j)</em>. On notera la différence avec un variant où le même élément aurait été noté <em>tableau(i)(j)</em>.</li>
</ul>
<p>Pourquoi deux types de tableaux qui finalement sont très proches ? La documentation de vbscript n&#x27;en parle pas et n&#x27;indique pas non plus si l&#x27;un est plus performant que l&#x27;autre. Par la suite, nous utiliserons quasi exclusivement le tableau dans un variant dans nos exemples. On se rappellera cependant que VBscript dérive du langage Visual Basic qui contient lui des données typées (integer, double, boolean, ...). Dans ce cas, si on doit utiliser un tableau de nombres réels par exemple, la variable tableau sera plus performante que la variable variant. On déclarera alors quelque chose comme <em>dim tableau(1000) as double</em> pour déclarer un tableau de nombres réels ou simplement <em>dim tableau() as double</em> si le tableau est dynamique.</p>
<p>Voici un exemple illustrant l&#x27;utilisation de variables tableau :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001E7000001FB07353B72.png" style="display:inline-block; margin:4px;width:12.885cm;height:13.414cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a>Le tableau t1 a 5 éléments
<a id="__codelineno-29-2" name="__codelineno-29-2"></a>t1(0)=1
<a id="__codelineno-29-3" name="__codelineno-29-3"></a>t1(1)=-4,5
<a id="__codelineno-29-4" name="__codelineno-29-4"></a>t1(2)=deux
<a id="__codelineno-29-5" name="__codelineno-29-5"></a>t1(3)=Vrai
<a id="__codelineno-29-6" name="__codelineno-29-6"></a>t1(4)=10/01/02
<a id="__codelineno-29-7" name="__codelineno-29-7"></a>t1=1:-4,5:deux:Vrai:10/01/02
<a id="__codelineno-29-8" name="__codelineno-29-8"></a>Le tableau t1 a 5 éléments
<a id="__codelineno-29-9" name="__codelineno-29-9"></a>t2(0)=0
<a id="__codelineno-29-10" name="__codelineno-29-10"></a>t2(1)(2)=30
<a id="__codelineno-29-11" name="__codelineno-29-11"></a>t2=:::
<a id="__codelineno-29-12" name="__codelineno-29-12"></a>t3(0,0)=0
<a id="__codelineno-29-13" name="__codelineno-29-13"></a>t3(0,1)=1
<a id="__codelineno-29-14" name="__codelineno-29-14"></a>t3(1,0)=10
<a id="__codelineno-29-15" name="__codelineno-29-15"></a>t3(1,1)=11
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="317-les-fonctions-split-et-join">3.17. Les fonctions split et join</h2>
<p>Les fonctions split et join permettent de passer d&#x27;une chaîne de caractères à un tableau et vice-versa :</p>
<ul>
<li>Si <strong>T</strong> est un tableau et <strong>car</strong> une chaîne de caractères, <strong>join(T,car)</strong> est une chaîne de caractères formée par la réunion de tous les éléments du tableau T, chacun étant séparé du suivant par la chaîne <strong>car</strong>. Ainsi join(array(1,2,3),&quot;abcd&quot;) donnera la chaîne &quot;1abcd2abcd3&quot;</li>
<li>Si <strong>C</strong> est une chaîne de caractères formée d&#x27;une suite de champs séparés par la chaîne <strong>car</strong> la fonction <strong>split(C,car)</strong> est un tableau dont les éléments sont les différents de la chaîne C. Ainsi split(&quot;1abcd2abcd3&quot;,&quot;abcd&quot;) donnera le tableau (1,2,3)</li>
</ul>
<p>Voici un exemple :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a>&#39; transformation tableau--&gt;chaîne et vice-versa
<a id="__codelineno-30-2" name="__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a>&#39; tableau --&gt; chaine
<a id="__codelineno-30-4" name="__codelineno-30-4"></a>tableau=array(&quot;un&quot;,2,&quot;trois&quot;)
<a id="__codelineno-30-5" name="__codelineno-30-5"></a>chaine=join(tableau,&quot;,&quot;)
<a id="__codelineno-30-6" name="__codelineno-30-6"></a>wscript.echo chaine
<a id="__codelineno-30-7" name="__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a>&#39; chaine --&gt; tableau
<a id="__codelineno-30-9" name="__codelineno-30-9"></a>tableau2=split(chaine,&quot;,&quot;)
<a id="__codelineno-30-10" name="__codelineno-30-10"></a>For i=0 To ubound(tableau2)
<a id="__codelineno-30-11" name="__codelineno-30-11"></a>  wscript.echo tableau2(i)
<a id="__codelineno-30-12" name="__codelineno-30-12"></a>Next
</code></pre></div></td></tr></table></div>
</div></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a>un,2,trois
<a id="__codelineno-31-2" name="__codelineno-31-2"></a>un
<a id="__codelineno-31-3" name="__codelineno-31-3"></a>2
<a id="__codelineno-31-4" name="__codelineno-31-4"></a>trois
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="318-les-dictionnaires">3.18. Les dictionnaires</h2>
<p>On a accès à l&#x27;élément d&#x27;un tableau T lorsqu&#x27;on connaît son numéro i. Il est alors accessible par la notation T(i). Il existe des tableaux dont on accèe aux éléments, non pas par un numéro mais par une chaîne de caractères. L&#x27;exemple typique de ce type de tableau est le dictionnaire. Lorsqu&#x27;on cherche la signification d&#x27;un mot dans le &quot;Larousse&quot; ou &quot;Le petit Robert&quot;, on accède à celle-ci par le mot. On pourrait représenter ce dictionnaire par un tableau à 2 colonnes :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">mot1</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">description1</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">mot2</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">description2</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">mot3</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">description3</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">....</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;">&nbsp;</td></tr></table>

<p>On pourrait alors écrire des choses comme :</p>
<p>dictionnaire(&quot;mot1&quot;)=&quot;description1&quot;</p>
<p>dictionnaire(&quot;mot2&quot;)=&quot;description2&quot;</p>
<p>...</p>
<p>On est alors proche du fonctionnement d&#x27;un tableau si ce n&#x27;est que les indices du tableau ne sont pas des nombres entiers mais des chaînes de caractères. On appelle ce type de tableau un <strong>dictionnaire</strong> (ou tableau associatif, hashtable) et les indices chaînes de caractères les <strong>clés</strong> du dictionnaire (keys). L&#x27;usage des dictionnaires est extrêmement fréquent dans le monde informatique. Nous avons tous une carte de sécurité sociale avec dessus un numéro. Ce numéro nous identifie de façon unique et donne accès aux informations qui nous concernent. Dans le modèle dictionnaire(&quot;clé&quot;)=&quot;informations&quot;, &quot;clé&quot; serait ici le n° de sécurité sociale et &quot;informations&quot; toutes les informations stockées à notre sujet sur les ordinateurs de la sécurité sociale.</p>
<p>Sous Windows, on dispose d&#x27;un objet Active X appelé &quot;<strong>Scripting.Dictionary</strong>&quot; qui permet de créer et gérer des dictionnaires. Un objet Active X est un composant logiciel qui expose une interface utilisable par des programmes qui peuvent être écrits en différents langages, tant qu&#x27;ils respectent la norme d&#x27;utilisation des objets Active X. L&#x27;objet Scripting.dictionary est donc utilisable par les langages de programmation de Windows : javascript, per, python, C, C++, vb, vba,... et pas seulement par vbscript.</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">1</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Un objet Scripting.Dictionary est créé par une instruction</p><p style="margin:0;">    <b>set dico=wscript.CreateObject(&quot;Scripting.Dictionary&quot;)</b></p><p style="margin:0;">ou simplement</p><p style="margin:0;">    <b>set dico=CreateObject(&quot;Scripting.Dictionary&quot;)</b></p><p style="margin:0;"><i>CreateObject</i> est une méthode de l&#x27;objet WScript permettant de créer des instances d&#x27;objets Active X. La version 2 montre que wscript peut être un objet implicite. Lorsqu&#x27;une méthode ne peut être &quot;rapprochée&quot; d&#x27;un objet, le conteneur WSH essaiera de le rapprocher de l&#x27;objet wscript.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">2</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Une fois le dictionnaire créé, on va pouvoir lui ajouter des éléments avec la méthode add :</p><p style="margin:0;">    <b>dico.add &quot;clé&quot;,valeur</b></p><p style="margin:0;">va créer une nouvelle entrée dans le dictionnaire associée à la clé &quot;clé&quot;. La valeur associée est un variant dont une donnée quelconque.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">3</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">Pour récupérer la valeur associée à une clé donnée on utilise la méthode <b>item</b> du dictionnaire :</p><p style="margin:0;">    <b>var=dico.item(&quot;clé&quot;)</b></p><p style="margin:0;">ou    <b>set var=dico.item(&quot;clé)</b> si la valeur associée à la clé est un objet.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">4</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">L&#x27;ensemble des clés du dictionnaire peut être récupéré dans un tableau variant grâce à la méthode <b>keys</b> :</p><p style="margin:0;">    <b>clés=dico.keys</b></p><p style="margin:0;"><b>clés</b> est un tableau dont on peut parcourir les éléments.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">5</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">L&#x27;ensemble des valeurs du dictionnaire peut être récupéré dans un tableau variant grâce à la méthode <b>items</b> :</p><p style="margin:0;">    <b>valeurs=dico.items</b></p><p style="margin:0;"><b>items</b> est un tableau dont on peut parcourir les éléments.</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">6</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">L&#x27;existence d&#x27;une clé peut être testée avec la méthode <b>exists</b> :</p><p style="margin:0;">    <b>dico.exists(&quot;clé&quot;)</b> est vrai si la clé &quot;clé&quot; existe dans le dictionnaire</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">7</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">On peut enlever une entrée du dictionnaire (clé+valeur) avec la méthode <b>remove</b> :</p><p style="margin:0;">    <b>dico.remove(&quot;clé&quot;)</b> enlève l&#x27;entrée du dictionnaire associée à la clé &quot;clé&quot;.     <b>dico.removeall</b> enlève toutes les clés, c.a.d. vide le dictionnaire.</p></td></tr></table>

<p>Le programme suivant utilise ces diverses possibilités :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span>
<span class="normal"><a href="#__codelineno-32-19">19</a></span>
<span class="normal"><a href="#__codelineno-32-20">20</a></span>
<span class="normal"><a href="#__codelineno-32-21">21</a></span>
<span class="normal"><a href="#__codelineno-32-22">22</a></span>
<span class="normal"><a href="#__codelineno-32-23">23</a></span>
<span class="normal"><a href="#__codelineno-32-24">24</a></span>
<span class="normal"><a href="#__codelineno-32-25">25</a></span>
<span class="normal"><a href="#__codelineno-32-26">26</a></span>
<span class="normal"><a href="#__codelineno-32-27">27</a></span>
<span class="normal"><a href="#__codelineno-32-28">28</a></span>
<span class="normal"><a href="#__codelineno-32-29">29</a></span>
<span class="normal"><a href="#__codelineno-32-30">30</a></span>
<span class="normal"><a href="#__codelineno-32-31">31</a></span>
<span class="normal"><a href="#__codelineno-32-32">32</a></span>
<span class="normal"><a href="#__codelineno-32-33">33</a></span>
<span class="normal"><a href="#__codelineno-32-34">34</a></span>
<span class="normal"><a href="#__codelineno-32-35">35</a></span>
<span class="normal"><a href="#__codelineno-32-36">36</a></span>
<span class="normal"><a href="#__codelineno-32-37">37</a></span>
<span class="normal"><a href="#__codelineno-32-38">38</a></span>
<span class="normal"><a href="#__codelineno-32-39">39</a></span>
<span class="normal"><a href="#__codelineno-32-40">40</a></span>
<span class="normal"><a href="#__codelineno-32-41">41</a></span>
<span class="normal"><a href="#__codelineno-32-42">42</a></span>
<span class="normal"><a href="#__codelineno-32-43">43</a></span>
<span class="normal"><a href="#__codelineno-32-44">44</a></span>
<span class="normal"><a href="#__codelineno-32-45">45</a></span>
<span class="normal"><a href="#__codelineno-32-46">46</a></span>
<span class="normal"><a href="#__codelineno-32-47">47</a></span>
<span class="normal"><a href="#__codelineno-32-48">48</a></span>
<span class="normal"><a href="#__codelineno-32-49">49</a></span>
<span class="normal"><a href="#__codelineno-32-50">50</a></span>
<span class="normal"><a href="#__codelineno-32-51">51</a></span>
<span class="normal"><a href="#__codelineno-32-52">52</a></span>
<span class="normal"><a href="#__codelineno-32-53">53</a></span>
<span class="normal"><a href="#__codelineno-32-54">54</a></span>
<span class="normal"><a href="#__codelineno-32-55">55</a></span>
<span class="normal"><a href="#__codelineno-32-56">56</a></span>
<span class="normal"><a href="#__codelineno-32-57">57</a></span>
<span class="normal"><a href="#__codelineno-32-58">58</a></span>
<span class="normal"><a href="#__codelineno-32-59">59</a></span>
<span class="normal"><a href="#__codelineno-32-60">60</a></span>
<span class="normal"><a href="#__codelineno-32-61">61</a></span>
<span class="normal"><a href="#__codelineno-32-62">62</a></span>
<span class="normal"><a href="#__codelineno-32-63">63</a></span>
<span class="normal"><a href="#__codelineno-32-64">64</a></span>
<span class="normal"><a href="#__codelineno-32-65">65</a></span>
<span class="normal"><a href="#__codelineno-32-66">66</a></span>
<span class="normal"><a href="#__codelineno-32-67">67</a></span>
<span class="normal"><a href="#__codelineno-32-68">68</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a>&#39; création et utilisation d&#39;un dictionnaire
<a id="__codelineno-32-2" name="__codelineno-32-2"></a>Set dico=CreateObject(&quot;Scripting.Dictionary&quot;)
<a id="__codelineno-32-3" name="__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a>&#39; remplisage dico
<a id="__codelineno-32-5" name="__codelineno-32-5"></a>dico.add &quot;clé1&quot;,&quot;valeur1&quot;
<a id="__codelineno-32-6" name="__codelineno-32-6"></a>dico.add &quot;clé2&quot;,&quot;valeur2&quot;
<a id="__codelineno-32-7" name="__codelineno-32-7"></a>dico.add &quot;clé3&quot;,&quot;valeur3&quot;
<a id="__codelineno-32-8" name="__codelineno-32-8"></a>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a>&#39; nombre d&#39;éléments
<a id="__codelineno-32-10" name="__codelineno-32-10"></a>wscript.echo &quot;Le dictionnaire a &quot; &amp; dico.count &amp; &quot; éléments&quot;
<a id="__codelineno-32-11" name="__codelineno-32-11"></a>
<a id="__codelineno-32-12" name="__codelineno-32-12"></a>&#39; liste des clés
<a id="__codelineno-32-13" name="__codelineno-32-13"></a>wscript.echo &quot;liste des clés&quot;
<a id="__codelineno-32-14" name="__codelineno-32-14"></a>cles=dico.keys
<a id="__codelineno-32-15" name="__codelineno-32-15"></a>For i=0 To ubound(cles)
<a id="__codelineno-32-16" name="__codelineno-32-16"></a>  wscript.echo cles(i)
<a id="__codelineno-32-17" name="__codelineno-32-17"></a>Next
<a id="__codelineno-32-18" name="__codelineno-32-18"></a>
<a id="__codelineno-32-19" name="__codelineno-32-19"></a>&#39; liste des valeurs
<a id="__codelineno-32-20" name="__codelineno-32-20"></a>wscript.echo &quot;liste des valeurs&quot;
<a id="__codelineno-32-21" name="__codelineno-32-21"></a>valeurs=dico.items
<a id="__codelineno-32-22" name="__codelineno-32-22"></a>For i=0 To ubound(valeurs)
<a id="__codelineno-32-23" name="__codelineno-32-23"></a>  wscript.echo valeurs(i)
<a id="__codelineno-32-24" name="__codelineno-32-24"></a>Next
<a id="__codelineno-32-25" name="__codelineno-32-25"></a>
<a id="__codelineno-32-26" name="__codelineno-32-26"></a>&#39; liste des clés et valeurs
<a id="__codelineno-32-27" name="__codelineno-32-27"></a>wscript.echo &quot;liste des clés et valeurs&quot;
<a id="__codelineno-32-28" name="__codelineno-32-28"></a>cles=dico.keys
<a id="__codelineno-32-29" name="__codelineno-32-29"></a>For i=0 To ubound(cles)
<a id="__codelineno-32-30" name="__codelineno-32-30"></a>  wscript.echo &quot;dico(&quot; &amp; cles(i) &amp; &quot;)=&quot; &amp; dico.item(cles(i))
<a id="__codelineno-32-31" name="__codelineno-32-31"></a>Next
<a id="__codelineno-32-32" name="__codelineno-32-32"></a>
<a id="__codelineno-32-33" name="__codelineno-32-33"></a>&#39; recherche d&#39;éléments
<a id="__codelineno-32-34" name="__codelineno-32-34"></a>&#39; clé1
<a id="__codelineno-32-35" name="__codelineno-32-35"></a>If dico.exists(&quot;clé1&quot;) Then
<a id="__codelineno-32-36" name="__codelineno-32-36"></a>    wscript.echo &quot;La clé clé1 existe dans le dictionnaire et la valeur associée est &quot; &amp; dico.item(&quot;clé1&quot;)
<a id="__codelineno-32-37" name="__codelineno-32-37"></a>  Else
<a id="__codelineno-32-38" name="__codelineno-32-38"></a>    wscript.echo &quot;La clé clé1  n&#39;existe pas dans le dictionnaire&quot;
<a id="__codelineno-32-39" name="__codelineno-32-39"></a>  End If
<a id="__codelineno-32-40" name="__codelineno-32-40"></a>&#39; clé4  
<a id="__codelineno-32-41" name="__codelineno-32-41"></a>If dico.exists(&quot;clé4&quot;) Then
<a id="__codelineno-32-42" name="__codelineno-32-42"></a>    wscript.echo &quot;La clé clé4 existe dans le dictionnaire et la valeur associée est &quot; &amp; dico.item(&quot;clé4&quot;)
<a id="__codelineno-32-43" name="__codelineno-32-43"></a>  Else
<a id="__codelineno-32-44" name="__codelineno-32-44"></a>    wscript.echo &quot;La clé clé4  n&#39;existe pas dans le dictionnaire&quot;
<a id="__codelineno-32-45" name="__codelineno-32-45"></a>  End If
<a id="__codelineno-32-46" name="__codelineno-32-46"></a>
<a id="__codelineno-32-47" name="__codelineno-32-47"></a>&#39; on enlève la clé 1
<a id="__codelineno-32-48" name="__codelineno-32-48"></a>dico.remove(&quot;clé1&quot;)
<a id="__codelineno-32-49" name="__codelineno-32-49"></a>
<a id="__codelineno-32-50" name="__codelineno-32-50"></a>&#39; liste des clés et valeurs
<a id="__codelineno-32-51" name="__codelineno-32-51"></a>wscript.echo &quot;liste des clés et valeurs après suppression de clé1&quot;
<a id="__codelineno-32-52" name="__codelineno-32-52"></a>cles=dico.keys
<a id="__codelineno-32-53" name="__codelineno-32-53"></a>For i=0 To ubound(cles)
<a id="__codelineno-32-54" name="__codelineno-32-54"></a>  wscript.echo &quot;dico(&quot; &amp; cles(i) &amp; &quot;)=&quot; &amp; dico.item(cles(i))
<a id="__codelineno-32-55" name="__codelineno-32-55"></a>Next
<a id="__codelineno-32-56" name="__codelineno-32-56"></a>
<a id="__codelineno-32-57" name="__codelineno-32-57"></a>&#39; on supprime tout
<a id="__codelineno-32-58" name="__codelineno-32-58"></a>dico.removeall
<a id="__codelineno-32-59" name="__codelineno-32-59"></a>
<a id="__codelineno-32-60" name="__codelineno-32-60"></a>&#39; liste des clés et valeurs
<a id="__codelineno-32-61" name="__codelineno-32-61"></a>wscript.echo &quot;liste des clés et valeurs après suppression de tous les éléments&quot;
<a id="__codelineno-32-62" name="__codelineno-32-62"></a>cles=dico.keys
<a id="__codelineno-32-63" name="__codelineno-32-63"></a>For i=0 To ubound(cles)
<a id="__codelineno-32-64" name="__codelineno-32-64"></a>  wscript.echo &quot;dico(&quot; &amp; cles(i) &amp; &quot;)=&quot; &amp; dico.item(cles(i))
<a id="__codelineno-32-65" name="__codelineno-32-65"></a>Next
<a id="__codelineno-32-66" name="__codelineno-32-66"></a>
<a id="__codelineno-32-67" name="__codelineno-32-67"></a>&#39; fin
<a id="__codelineno-32-68" name="__codelineno-32-68"></a>wscript.quit 0
</code></pre></div></td></tr></table></div>
</div></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span>
<span class="normal"><a href="#__codelineno-33-16">16</a></span>
<span class="normal"><a href="#__codelineno-33-17">17</a></span>
<span class="normal"><a href="#__codelineno-33-18">18</a></span>
<span class="normal"><a href="#__codelineno-33-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a>Le dictionnaire a 3 éléments
<a id="__codelineno-33-2" name="__codelineno-33-2"></a>liste des clés
<a id="__codelineno-33-3" name="__codelineno-33-3"></a>clé1
<a id="__codelineno-33-4" name="__codelineno-33-4"></a>clé2
<a id="__codelineno-33-5" name="__codelineno-33-5"></a>clé3
<a id="__codelineno-33-6" name="__codelineno-33-6"></a>liste des valeurs
<a id="__codelineno-33-7" name="__codelineno-33-7"></a>valeur1
<a id="__codelineno-33-8" name="__codelineno-33-8"></a>valeur2
<a id="__codelineno-33-9" name="__codelineno-33-9"></a>valeur3
<a id="__codelineno-33-10" name="__codelineno-33-10"></a>liste des clés et valeurs
<a id="__codelineno-33-11" name="__codelineno-33-11"></a>dico(clé1)=valeur1
<a id="__codelineno-33-12" name="__codelineno-33-12"></a>dico(clé2)=valeur2
<a id="__codelineno-33-13" name="__codelineno-33-13"></a>dico(clé3)=valeur3
<a id="__codelineno-33-14" name="__codelineno-33-14"></a>La clé clé1 existe dans le dictionnaire et la valeur associée est valeur1
<a id="__codelineno-33-15" name="__codelineno-33-15"></a>La clé clé4  n&#39;existe pas dans le dictionnaire
<a id="__codelineno-33-16" name="__codelineno-33-16"></a>liste des clés et valeurs après suppression de clé1
<a id="__codelineno-33-17" name="__codelineno-33-17"></a>dico(clé2)=valeur2
<a id="__codelineno-33-18" name="__codelineno-33-18"></a>dico(clé3)=valeur3
<a id="__codelineno-33-19" name="__codelineno-33-19"></a>liste des clés et valeurs après suppression de tous les éléments
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<h2 id="319-trier-un-tableau-ou-un-dictionnaire">3.19. Trier un tableau ou un dictionnaire</h2>
<p>Il est courant de vouloir trier un tableau ou un dictionnaire dans l&#x27;ordre croissant ou décroissant de ses valeurs ou de ses clés pour un dictionnaire. Alors que dans la pupart des langages, existent des fonctions de tri, il ne semble pas en exister en vbscript. C&#x27;est une lacune.</p>
<h2 id="320-les-arguments-dun-programme">3.20. Les arguments d&#x27;un programme</h2>
<p>Il est possible d&#x27;appeler un programme vbscript en lui passant des paramètres comme dans :</p>
<p>cscript prog1.vbs arg1 arg2 .... argn</p>
<p>Cela permet à l&#x27;utilisateur de passer des informations au programme. Comment celui-ci fait-il pour les récupérer ? Regardons le programme suivant :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/10000000000001A90000009CBB72DF77.png" style="display:inline-block; margin:4px;width:11.245cm;height:4.128cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span>
<span class="normal"><a href="#__codelineno-34-2">2</a></span>
<span class="normal"><a href="#__codelineno-34-3">3</a></span>
<span class="normal"><a href="#__codelineno-34-4">4</a></span>
<span class="normal"><a href="#__codelineno-34-5">5</a></span>
<span class="normal"><a href="#__codelineno-34-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a>C:\&gt;cscript arg1.vbs a b c
<a id="__codelineno-34-2" name="__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a>Il y a 3 arguments
<a id="__codelineno-34-4" name="__codelineno-34-4"></a>a
<a id="__codelineno-34-5" name="__codelineno-34-5"></a>b
<a id="__codelineno-34-6" name="__codelineno-34-6"></a>c
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p><strong>Commentaires</strong></p>
<ul>
<li><em>WScript.Arguments</em> est la collection des arguments passés au script</li>
<li>une collection C est un objet qui a<ul>
<li>une propriété <em>count</em> qui est le nombre d&#x27;éléments dans la collection</li>
<li>une méthode <em>C(i)</em> qui donne l&#x27;élément i de la collection</li>
</ul>
</li>
</ul>
<h2 id="321-une-premiere-application-impots">3.21. Une première application : IMPOTS</h2>
<p>On se propose d&#x27;écrire un programme permettant de calculer l&#x27;impôt d&#x27;un contribuable. On se place dans le cas simplifié d&#x27;un contribuable n&#x27;ayant que son seul salaire à déclarer :</p>
<ul>
<li>on calcule le nombre de parts du salarié <strong>nbParts=nbEnfants/2 +1</strong> s&#x27;il n&#x27;est pas marié, <strong>nbEnfants/2+2</strong> s&#x27;il est marié, où <em>nbEnfants</em> est son nombre d&#x27;enfants.</li>
<li>on calcule son revenu imposable <strong>R=0.72*S</strong> où S est son salaire annuel</li>
<li>on calcule son coefficient familial <strong>Q=R/N</strong></li>
</ul>
<p>on calcule son impôt I d&#x27;après les données suivantes</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">12620.0    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0</p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">13190    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.05    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">631</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">15640    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.1    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">1290.5</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">24740    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.15    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">2072.5</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">31810    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.2    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">3309.5</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">39970    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.25    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">4900</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">48360    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.3    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">6898.5</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">55790    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.35    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">9316.5</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">92970    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.4    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">12106</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">127860    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.45    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">16754.5</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">151250    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.50    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">23147.5</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">172040    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.55    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">30710</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">195000    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.60    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">39312</p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">0.65    </p></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;">49062</p></td></tr></table>

<p>Chaque ligne a 3 champs. Pour calculer l&#x27;impôt I, on recherche la première ligne où <em>QF&lt;=champ1</em>. Par exemple, si QF=30000 on trouvera la ligne </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a>    24740        0.15        2072.5
</code></pre></div></td></tr></table></div>
<p>L&#x27;impôt I est alors égal à <strong>0.15*R - 2072.5*nbParts</strong>. Si QF est tel que la relation <em>QF&lt;=champ1</em> n&#x27;est jamais vérifiée, alors ce sont les coefficcients de la dernière ligne qui sont utilisés. Ici :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a>    0                0.65        49062
</code></pre></div></td></tr></table></div>
<p>ce qui donne l&#x27;impôt I=0.65*R - 49062*nbParts.</p>
<p>Le programme est le suivant :</p>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Programme</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-37-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-37-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-37-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-37-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-37-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-37-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-37-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-37-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-37-10">10</a></span>
<span class="normal"><a href="#__codelineno-37-11">11</a></span>
<span class="normal"><a href="#__codelineno-37-12">12</a></span>
<span class="normal"><a href="#__codelineno-37-13">13</a></span>
<span class="normal"><a href="#__codelineno-37-14">14</a></span>
<span class="normal"><a href="#__codelineno-37-15">15</a></span>
<span class="normal"><a href="#__codelineno-37-16">16</a></span>
<span class="normal"><a href="#__codelineno-37-17">17</a></span>
<span class="normal"><a href="#__codelineno-37-18">18</a></span>
<span class="normal"><a href="#__codelineno-37-19">19</a></span>
<span class="normal"><a href="#__codelineno-37-20">20</a></span>
<span class="normal"><a href="#__codelineno-37-21">21</a></span>
<span class="normal"><a href="#__codelineno-37-22">22</a></span>
<span class="normal"><a href="#__codelineno-37-23">23</a></span>
<span class="normal"><a href="#__codelineno-37-24">24</a></span>
<span class="normal"><a href="#__codelineno-37-25">25</a></span>
<span class="normal"><a href="#__codelineno-37-26">26</a></span>
<span class="normal"><a href="#__codelineno-37-27">27</a></span>
<span class="normal"><a href="#__codelineno-37-28">28</a></span>
<span class="normal"><a href="#__codelineno-37-29">29</a></span>
<span class="normal"><a href="#__codelineno-37-30">30</a></span>
<span class="normal"><a href="#__codelineno-37-31">31</a></span>
<span class="normal"><a href="#__codelineno-37-32">32</a></span>
<span class="normal"><a href="#__codelineno-37-33">33</a></span>
<span class="normal"><a href="#__codelineno-37-34">34</a></span>
<span class="normal"><a href="#__codelineno-37-35">35</a></span>
<span class="normal"><a href="#__codelineno-37-36">36</a></span>
<span class="normal"><a href="#__codelineno-37-37">37</a></span>
<span class="normal"><a href="#__codelineno-37-38">38</a></span>
<span class="normal"><a href="#__codelineno-37-39">39</a></span>
<span class="normal"><a href="#__codelineno-37-40">40</a></span>
<span class="normal"><a href="#__codelineno-37-41">41</a></span>
<span class="normal"><a href="#__codelineno-37-42">42</a></span>
<span class="normal"><a href="#__codelineno-37-43">43</a></span>
<span class="normal"><a href="#__codelineno-37-44">44</a></span>
<span class="normal"><a href="#__codelineno-37-45">45</a></span>
<span class="normal"><a href="#__codelineno-37-46">46</a></span>
<span class="normal"><a href="#__codelineno-37-47">47</a></span>
<span class="normal"><a href="#__codelineno-37-48">48</a></span>
<span class="normal"><a href="#__codelineno-37-49">49</a></span>
<span class="normal"><a href="#__codelineno-37-50">50</a></span>
<span class="normal"><a href="#__codelineno-37-51">51</a></span>
<span class="normal"><a href="#__codelineno-37-52">52</a></span>
<span class="normal"><a href="#__codelineno-37-53">53</a></span>
<span class="normal"><a href="#__codelineno-37-54">54</a></span>
<span class="normal"><a href="#__codelineno-37-55">55</a></span>
<span class="normal"><a href="#__codelineno-37-56">56</a></span>
<span class="normal"><a href="#__codelineno-37-57">57</a></span>
<span class="normal"><a href="#__codelineno-37-58">58</a></span>
<span class="normal"><a href="#__codelineno-37-59">59</a></span>
<span class="normal"><a href="#__codelineno-37-60">60</a></span>
<span class="normal"><a href="#__codelineno-37-61">61</a></span>
<span class="normal"><a href="#__codelineno-37-62">62</a></span>
<span class="normal"><a href="#__codelineno-37-63">63</a></span>
<span class="normal"><a href="#__codelineno-37-64">64</a></span>
<span class="normal"><a href="#__codelineno-37-65">65</a></span>
<span class="normal"><a href="#__codelineno-37-66">66</a></span>
<span class="normal"><a href="#__codelineno-37-67">67</a></span>
<span class="normal"><a href="#__codelineno-37-68">68</a></span>
<span class="normal"><a href="#__codelineno-37-69">69</a></span>
<span class="normal"><a href="#__codelineno-37-70">70</a></span>
<span class="normal"><a href="#__codelineno-37-71">71</a></span>
<span class="normal"><a href="#__codelineno-37-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="c1">&#39; calcul de l&#39;impôt d&#39;un contribuable</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="c1">&#39; le programme doit être appelé avec trois paramètres : marié enfants salaire</span>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="c1">&#39; marié : caractère O si marié, N si non marié</span>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="c1">&#39; enfants : nombre d&#39;enfants</span>
<a id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="c1">&#39; salaire : salaire annuel sans les centimes</span>
<a id="__codelineno-37-6" name="__codelineno-37-6"></a>
<a id="__codelineno-37-7" name="__codelineno-37-7"></a><span class="c1">&#39; aucune vérification de la validité des données n&#39;est faite mais on</span>
<a id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="c1">&#39; vérifie qu&#39;il y en a bien trois</span>
<a id="__codelineno-37-9" name="__codelineno-37-9"></a>
<a id="__codelineno-37-10" name="__codelineno-37-10"></a><span class="c1">&#39; déclaration obligatoire des variables</span>
<a id="__codelineno-37-11" name="__codelineno-37-11"></a><span class="k">Option</span><span class="w"> </span><span class="k">Explicit</span>
<a id="__codelineno-37-12" name="__codelineno-37-12"></a>
<a id="__codelineno-37-13" name="__codelineno-37-13"></a><span class="c1">&#39; on vérifie qu&#39;il y a 3 arguments</span>
<a id="__codelineno-37-14" name="__codelineno-37-14"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">nbArguments</span>
<a id="__codelineno-37-15" name="__codelineno-37-15"></a><span class="n">nbArguments</span><span class="o">=</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">.</span><span class="n">count</span>
<a id="__codelineno-37-16" name="__codelineno-37-16"></a><span class="k">If</span><span class="w"> </span><span class="n">nbArguments</span><span class="o">&lt;&gt;</span><span class="mi">3</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-37-17" name="__codelineno-37-17"></a><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;Syntaxe : pg marié enfants salaire&quot;</span>
<a id="__codelineno-37-18" name="__codelineno-37-18"></a><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;marié : caractère O si marié, N si non marié&quot;</span>
<a id="__codelineno-37-19" name="__codelineno-37-19"></a><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;enfants : nombre d&#39;enfants&quot;</span>
<a id="__codelineno-37-20" name="__codelineno-37-20"></a><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;salaire : salaire annuel sans les centimes&quot;</span>
<a id="__codelineno-37-21" name="__codelineno-37-21"></a><span class="c1">&#39; arrêt avec code d&#39;erreur 1</span>
<a id="__codelineno-37-22" name="__codelineno-37-22"></a><span class="n">wscript</span><span class="p">.</span><span class="n">quit</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-37-23" name="__codelineno-37-23"></a><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-37-24" name="__codelineno-37-24"></a>
<a id="__codelineno-37-25" name="__codelineno-37-25"></a><span class="c1">&#39; on récupère les arguments sans vérifier leur validité</span>
<a id="__codelineno-37-26" name="__codelineno-37-26"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">marie</span><span class="p">,</span><span class="w"> </span><span class="nv">enfants</span><span class="p">,</span><span class="w"> </span><span class="nv">salaire</span>
<a id="__codelineno-37-27" name="__codelineno-37-27"></a><span class="k">If</span><span class="w"> </span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;O&quot;</span><span class="w"> </span><span class="ow">Or</span><span class="w"> </span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-37-28" name="__codelineno-37-28"></a><span class="n">marie</span><span class="o">=</span><span class="no">true</span>
<a id="__codelineno-37-29" name="__codelineno-37-29"></a><span class="k">Else</span>
<a id="__codelineno-37-30" name="__codelineno-37-30"></a><span class="n">marie</span><span class="o">=</span><span class="no">false</span>
<a id="__codelineno-37-31" name="__codelineno-37-31"></a><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-37-32" name="__codelineno-37-32"></a><span class="c1">&#39; enfants est un nombre entier</span>
<a id="__codelineno-37-33" name="__codelineno-37-33"></a><span class="n">enfants</span><span class="o">=</span><span class="nb">cint</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-37-34" name="__codelineno-37-34"></a><span class="c1">&#39; salaire est un entier long</span>
<a id="__codelineno-37-35" name="__codelineno-37-35"></a><span class="n">salaire</span><span class="o">=</span><span class="nb">clng</span><span class="p">(</span><span class="n">wscript</span><span class="p">.</span><span class="n">arguments</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-37-36" name="__codelineno-37-36"></a>
<a id="__codelineno-37-37" name="__codelineno-37-37"></a><span class="c1">&#39; on définit les données nécessaire au calcul de l&#39;impôt dans 3 tableaux</span>
<a id="__codelineno-37-38" name="__codelineno-37-38"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">limites</span><span class="p">,</span><span class="w"> </span><span class="nv">coeffn</span><span class="p">,</span><span class="w"> </span><span class="nv">coeffr</span>
<a id="__codelineno-37-39" name="__codelineno-37-39"></a><span class="n">limites</span><span class="o">=</span><span class="nb">array</span><span class="p">(</span><span class="mi">12620</span><span class="p">,</span><span class="mi">13190</span><span class="p">,</span><span class="mi">15640</span><span class="p">,</span><span class="mi">24740</span><span class="p">,</span><span class="mi">31810</span><span class="p">,</span><span class="mi">39970</span><span class="p">,</span><span class="mi">48360</span><span class="p">,</span><span class="w"> </span><span class="n">_</span>
<a id="__codelineno-37-40" name="__codelineno-37-40"></a><span class="mi">55790</span><span class="p">,</span><span class="mi">92970</span><span class="p">,</span><span class="mi">127860</span><span class="p">,</span><span class="mi">151250</span><span class="p">,</span><span class="mi">172040</span><span class="p">,</span><span class="mi">195000</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-37-41" name="__codelineno-37-41"></a><span class="n">coeffr</span><span class="o">=</span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="w"> </span><span class="n">_</span>
<a id="__codelineno-37-42" name="__codelineno-37-42"></a><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.65</span><span class="p">)</span>
<a id="__codelineno-37-43" name="__codelineno-37-43"></a><span class="n">coeffn</span><span class="o">=</span><span class="nb">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">631</span><span class="p">,</span><span class="mf">1290.5</span><span class="p">,</span><span class="mf">2072.5</span><span class="p">,</span><span class="mf">3309.5</span><span class="p">,</span><span class="mi">4900</span><span class="p">,</span><span class="mf">6898.5</span><span class="p">,</span><span class="mf">9316.5</span><span class="p">,</span><span class="w"> </span><span class="n">_</span>
<a id="__codelineno-37-44" name="__codelineno-37-44"></a><span class="mi">12106</span><span class="p">,</span><span class="mf">16754.5</span><span class="p">,</span><span class="mf">23147.5</span><span class="p">,</span><span class="mi">30710</span><span class="p">,</span><span class="mi">39312</span><span class="p">,</span><span class="mi">49062</span><span class="p">)</span>
<a id="__codelineno-37-45" name="__codelineno-37-45"></a>
<a id="__codelineno-37-46" name="__codelineno-37-46"></a><span class="c1">&#39; on calcule le nombre de parts</span>
<a id="__codelineno-37-47" name="__codelineno-37-47"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">nbParts</span>
<a id="__codelineno-37-48" name="__codelineno-37-48"></a><span class="k">If</span><span class="w"> </span><span class="n">marie</span><span class="o">=</span><span class="no">true</span><span class="w"> </span><span class="k">Then</span>
<a id="__codelineno-37-49" name="__codelineno-37-49"></a><span class="n">nbParts</span><span class="o">=</span><span class="p">(</span><span class="n">enfants</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span>
<a id="__codelineno-37-50" name="__codelineno-37-50"></a><span class="k">Else</span>
<a id="__codelineno-37-51" name="__codelineno-37-51"></a><span class="n">nbParts</span><span class="o">=</span><span class="p">(</span><span class="n">enfants</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-37-52" name="__codelineno-37-52"></a><span class="k">End</span><span class="w"> </span><span class="k">If</span>
<a id="__codelineno-37-53" name="__codelineno-37-53"></a><span class="k">If</span><span class="w"> </span><span class="n">enfants</span><span class="o">&gt;=</span><span class="mi">3</span><span class="w"> </span><span class="k">Then</span><span class="w"> </span><span class="n">nbParts</span><span class="o">=</span><span class="n">nbParts</span><span class="o">+</span><span class="mf">0.5</span>
<a id="__codelineno-37-54" name="__codelineno-37-54"></a>
<a id="__codelineno-37-55" name="__codelineno-37-55"></a><span class="c1">&#39; on calcule le quotient familial et le revenu imposable</span>
<a id="__codelineno-37-56" name="__codelineno-37-56"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">revenu</span><span class="p">,</span><span class="w"> </span><span class="nv">qf</span>
<a id="__codelineno-37-57" name="__codelineno-37-57"></a><span class="n">revenu</span><span class="o">=</span><span class="mf">0.72</span><span class="o">*</span><span class="n">salaire</span>
<a id="__codelineno-37-58" name="__codelineno-37-58"></a><span class="n">qf</span><span class="o">=</span><span class="n">revenu</span><span class="o">/</span><span class="n">nbParts</span>
<a id="__codelineno-37-59" name="__codelineno-37-59"></a>
<a id="__codelineno-37-60" name="__codelineno-37-60"></a><span class="c1">&#39; on calcule l&#39;impôt</span>
<a id="__codelineno-37-61" name="__codelineno-37-61"></a><span class="kd">Dim</span><span class="w"> </span><span class="nv">i</span><span class="p">,</span><span class="w"> </span><span class="nv">impot</span>
<a id="__codelineno-37-62" name="__codelineno-37-62"></a><span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<a id="__codelineno-37-63" name="__codelineno-37-63"></a><span class="k">Do</span><span class="w"> </span><span class="k">While</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="nb">ubound</span><span class="p">(</span><span class="n">limites</span><span class="p">)</span><span class="w"> </span><span class="ow">And</span><span class="w"> </span><span class="n">qf</span><span class="o">&gt;</span><span class="n">limites</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-37-64" name="__codelineno-37-64"></a><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
<a id="__codelineno-37-65" name="__codelineno-37-65"></a><span class="k">Loop</span>
<a id="__codelineno-37-66" name="__codelineno-37-66"></a><span class="n">impot</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">revenu</span><span class="o">*</span><span class="n">coeffr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">nbParts</span><span class="o">*</span><span class="n">coeffn</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a id="__codelineno-37-67" name="__codelineno-37-67"></a>
<a id="__codelineno-37-68" name="__codelineno-37-68"></a><span class="c1">&#39; on affiche le résultat</span>
<a id="__codelineno-37-69" name="__codelineno-37-69"></a><span class="n">wscript</span><span class="p">.</span><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;impôt=&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">impot</span>
<a id="__codelineno-37-70" name="__codelineno-37-70"></a>
<a id="__codelineno-37-71" name="__codelineno-37-71"></a><span class="c1">&#39; on quitte sans erreur</span>
<a id="__codelineno-37-72" name="__codelineno-37-72"></a><span class="n">wscript</span><span class="p">.</span><span class="n">quit</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div></td></tr></table></div>
</div></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><p style="margin:0;"><b>Résultats</b></p></td></tr><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><div markdown="block">
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-38-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-38-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-38-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-38-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-38-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-38-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-38-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-38-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-38-10">10</a></span>
<span class="normal"><a href="#__codelineno-38-11">11</a></span>
<span class="normal"><a href="#__codelineno-38-12">12</a></span>
<span class="normal"><a href="#__codelineno-38-13">13</a></span>
<span class="normal"><a href="#__codelineno-38-14">14</a></span>
<span class="normal"><a href="#__codelineno-38-15">15</a></span>
<span class="normal"><a href="#__codelineno-38-16">16</a></span>
<span class="normal"><a href="#__codelineno-38-17">17</a></span>
<span class="normal"><a href="#__codelineno-38-18">18</a></span>
<span class="normal"><a href="#__codelineno-38-19">19</a></span>
<span class="normal"><a href="#__codelineno-38-20">20</a></span>
<span class="normal"><a href="#__codelineno-38-21">21</a></span>
<span class="normal"><a href="#__codelineno-38-22">22</a></span>
<span class="normal"><a href="#__codelineno-38-23">23</a></span>
<span class="normal"><a href="#__codelineno-38-24">24</a></span>
<span class="normal"><a href="#__codelineno-38-25">25</a></span>
<span class="normal"><a href="#__codelineno-38-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a>C:\&gt;cscript impots1.vbs o 2 200000
<a id="__codelineno-38-2" name="__codelineno-38-2"></a>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a>impôt=22504
<a id="__codelineno-38-4" name="__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5"></a>C:\&gt;cscript impots1.vbs o 2 20000
<a id="__codelineno-38-6" name="__codelineno-38-6"></a>
<a id="__codelineno-38-7" name="__codelineno-38-7"></a>impôt=0
<a id="__codelineno-38-8" name="__codelineno-38-8"></a>
<a id="__codelineno-38-9" name="__codelineno-38-9"></a>C:\&gt;cscript impots1.vbs o 2 2000000
<a id="__codelineno-38-10" name="__codelineno-38-10"></a>
<a id="__codelineno-38-11" name="__codelineno-38-11"></a>impôt=746064
<a id="__codelineno-38-12" name="__codelineno-38-12"></a>
<a id="__codelineno-38-13" name="__codelineno-38-13"></a>C:\&gt;cscript impots1.vbs n 2 200000
<a id="__codelineno-38-14" name="__codelineno-38-14"></a>
<a id="__codelineno-38-15" name="__codelineno-38-15"></a>impôt=33388
<a id="__codelineno-38-16" name="__codelineno-38-16"></a>
<a id="__codelineno-38-17" name="__codelineno-38-17"></a>C:\&gt;cscript impots1.vbs n 3 200000
<a id="__codelineno-38-18" name="__codelineno-38-18"></a>
<a id="__codelineno-38-19" name="__codelineno-38-19"></a>impôt=22504
<a id="__codelineno-38-20" name="__codelineno-38-20"></a>
<a id="__codelineno-38-21" name="__codelineno-38-21"></a>C:\&gt;cscript impots1.vbs
<a id="__codelineno-38-22" name="__codelineno-38-22"></a>
<a id="__codelineno-38-23" name="__codelineno-38-23"></a>Syntaxe : pg marié enfants salaire
<a id="__codelineno-38-24" name="__codelineno-38-24"></a>marié : caractère O si marié, N si non marié
<a id="__codelineno-38-25" name="__codelineno-38-25"></a>enfants : nombre d&#39;enfants
<a id="__codelineno-38-26" name="__codelineno-38-26"></a>salaire : salaire annuel sans les centimes
</code></pre></div></td></tr></table></div>
</div></td></tr></table>

<p><strong>Commentaires :</strong></p>
<ul>
<li>le programme utilise ce qui a été exposé précédemment (déclaration des variables, arguments, changements de types, tests, boucles, tableau dans un variant)</li>
<li>il ne vérifie pas la validité des données, ce qui serait anormal dans un programme réel</li>
<li>seule la boucle while présente une difficulté. Elle cherche à déterminer l&#x27;indice i du tableau limites pour lequel on a limites(i)&gt;qf et cela pour i&lt;ubound(limites) (c.a.d. ici i&lt;13) car le dernier élément du tableau limites n&#x27;est pas significatif.  Il a été ajouté uniquement pour que le test [Do While i&lt;ubound(limites) And qf&gt;limites(i)] puisse se faire pour i=13. Le test est alors 13&lt;13 and qf&gt;limites(13) et il faut alors (en vbscript) que limites(13) existe. Lorsqu&#x27;on sort de la boucle while, la dernière valeur de i calculée permet de calculer l&#x27;impôt : [impot=int(revenu*coeffr(i)-nbParts*coeffn(i))].</li>
</ul>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner">

      <div>
        <a href="https://tahe.developpez.com" target="_blank">
          https://tahe.developpez.com
        </a>
        <br>
        Ce cours-tutoriel écrit par <strong>Serge Tahé</strong> est mis à disposition du public selon les termes de la
        <em>Licence Creative Commons Attribution – Pas d’Utilisation Commerciale –
        Partage dans les Mêmes Conditions 3.0 non transposé</em>.
      </div>

    </div>
  </div>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["navigation.sections", "navigation.indexes", "toc.integrate", "navigation.top"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="javascripts/focus.js"></script>
      
    
  </body>
</html>